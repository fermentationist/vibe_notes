(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();const wt=()=>new Map,Jn=e=>{const t=wt();return e.forEach((n,s)=>{t.set(s,n)}),t},vt=(e,t,n)=>{let s=e.get(t);return s===void 0&&e.set(t,s=n()),s},zi=(e,t)=>{const n=[];for(const[s,o]of e)n.push(t(o,s));return n},Vi=(e,t)=>{for(const[n,s]of e)if(t(s,n))return!0;return!1},te=()=>new Set,Mn=e=>e[e.length-1],$i=(e,t)=>{for(let n=0;n<t.length;n++)e.push(t[n])},$t=Array.from,qi=Array.isArray;class ys{constructor(){this._observers=wt()}on(t,n){return vt(this._observers,t,te).add(n),n}once(t,n){const s=(...o)=>{this.off(t,s),n(...o)};this.on(t,s)}off(t,n){const s=this._observers.get(t);s!==void 0&&(s.delete(n),s.size===0&&this._observers.delete(t))}emit(t,n){return $t((this._observers.get(t)||wt()).values()).forEach(s=>s(...n))}destroy(){this._observers=wt()}}class ws{constructor(){this._observers=wt()}on(t,n){vt(this._observers,t,te).add(n)}once(t,n){const s=(...o)=>{this.off(t,s),n(...o)};this.on(t,s)}off(t,n){const s=this._observers.get(t);s!==void 0&&(s.delete(n),s.size===0&&this._observers.delete(t))}emit(t,n){return $t((this._observers.get(t)||wt()).values()).forEach(s=>s(...n))}destroy(){this._observers=wt()}}const Mt=Math.floor,an=Math.abs,Wi=Math.log10,cr=(e,t)=>e<t?e:t,fe=(e,t)=>e>t?e:t,bs=e=>e!==0?e<0:1/e<0,Nr=1,Ur=2,Nn=4,Un=8,$e=32,zt=64,_t=128,kn=31,Kn=63,oe=127,Hi=2147483647,_s=Number.MAX_SAFE_INTEGER,Yi=Number.isInteger||(e=>typeof e=="number"&&isFinite(e)&&Mt(e)===e),Gi=String.fromCharCode,Ji=e=>e.toLowerCase(),Ki=/^\s*/g,Xi=e=>e.replace(Ki,""),Zi=/([A-Z])/g,Fr=(e,t)=>Xi(e.replace(Zi,n=>`${t}${Ji(n)}`)),Qi=e=>{const t=unescape(encodeURIComponent(e)),n=t.length,s=new Uint8Array(n);for(let o=0;o<n;o++)s[o]=t.codePointAt(o);return s},qe=typeof TextEncoder<"u"?new TextEncoder:null,to=e=>qe.encode(e),Xn=qe?to:Qi;let Pe=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});Pe&&Pe.decode(new Uint8Array).length===1&&(Pe=null);class Xe{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const ht=()=>new Xe,eo=e=>{let t=e.cpos;for(let n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t},nt=e=>{const t=new Uint8Array(eo(e));let n=0;for(let s=0;s<e.bufs.length;s++){const o=e.bufs[s];t.set(o,n),n+=o.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),n),t},no=(e,t)=>{const n=e.cbuf.length;n-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(fe(n,t)*2),e.cpos=0)},at=(e,t)=>{const n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(n*2),e.cpos=0),e.cbuf[e.cpos++]=t},We=at,V=(e,t)=>{for(;t>oe;)at(e,_t|oe&t),t=Mt(t/128);at(e,oe&t)},ar=(e,t)=>{const n=bs(t);for(n&&(t=-t),at(e,(t>Kn?_t:0)|(n?zt:0)|Kn&t),t=Mt(t/64);t>0;)at(e,(t>oe?_t:0)|oe&t),t=Mt(t/128)},Zn=new Uint8Array(3e4),ro=Zn.length/3,so=(e,t)=>{if(t.length<ro){const n=qe.encodeInto(t,Zn).written||0;V(e,n);for(let s=0;s<n;s++)at(e,Zn[s])}else st(e,Xn(t))},io=(e,t)=>{const n=unescape(encodeURIComponent(t)),s=n.length;V(e,s);for(let o=0;o<s;o++)at(e,n.codePointAt(o))},It=qe&&qe.encodeInto?so:io,Rn=(e,t)=>{const n=e.cbuf.length,s=e.cpos,o=cr(n-s,t.length),i=t.length-o;e.cbuf.set(t.subarray(0,o),s),e.cpos+=o,i>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(fe(n*2,i)),e.cbuf.set(t.subarray(o)),e.cpos=i)},st=(e,t)=>{V(e,t.byteLength),Rn(e,t)},ur=(e,t)=>{no(e,t);const n=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,n},oo=(e,t)=>ur(e,4).setFloat32(0,t,!1),lo=(e,t)=>ur(e,8).setFloat64(0,t,!1),co=(e,t)=>ur(e,8).setBigInt64(0,t,!1),Br=new DataView(new ArrayBuffer(4)),ao=e=>(Br.setFloat32(0,e),Br.getFloat32(0)===e),Ee=(e,t)=>{switch(typeof t){case"string":at(e,119),It(e,t);break;case"number":Yi(t)&&an(t)<=Hi?(at(e,125),ar(e,t)):ao(t)?(at(e,124),oo(e,t)):(at(e,123),lo(e,t));break;case"bigint":at(e,122),co(e,t);break;case"object":if(t===null)at(e,126);else if(qi(t)){at(e,117),V(e,t.length);for(let n=0;n<t.length;n++)Ee(e,t[n])}else if(t instanceof Uint8Array)at(e,116),st(e,t);else{at(e,118);const n=Object.keys(t);V(e,n.length);for(let s=0;s<n.length;s++){const o=n[s];It(e,o),Ee(e,t[o])}}break;case"boolean":at(e,t?120:121);break;default:at(e,127)}};class jr extends Xe{constructor(t){super(),this.w=t,this.s=null,this.count=0}write(t){this.s===t?this.count++:(this.count>0&&V(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}}const Pr=e=>{e.count>0&&(ar(e.encoder,e.count===1?e.s:-e.s),e.count>1&&V(e.encoder,e.count-2))};class un{constructor(){this.encoder=new Xe,this.s=0,this.count=0}write(t){this.s===t?this.count++:(Pr(this),this.count=1,this.s=t)}toUint8Array(){return Pr(this),nt(this.encoder)}}const zr=e=>{if(e.count>0){const t=e.diff*2+(e.count===1?0:1);ar(e.encoder,t),e.count>1&&V(e.encoder,e.count-2)}};class Fn{constructor(){this.encoder=new Xe,this.s=0,this.count=0,this.diff=0}write(t){this.diff===t-this.s?(this.s=t,this.count++):(zr(this),this.count=1,this.diff=t-this.s,this.s=t)}toUint8Array(){return zr(this),nt(this.encoder)}}class uo{constructor(){this.sarr=[],this.s="",this.lensE=new un}write(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}toUint8Array(){const t=new Xe;return this.sarr.push(this.s),this.s="",It(t,this.sarr.join("")),Rn(t,this.lensE.toUint8Array()),nt(t)}}const Nt=e=>new Error(e),Ot=()=>{throw Nt("Method unimplemented")},Ut=()=>{throw Nt("Unexpected case")},vs=Nt("Unexpected end of array"),Ss=Nt("Integer out of Range");class Tn{constructor(t){this.arr=t,this.pos=0}}const jt=e=>new Tn(e),ho=e=>e.pos!==e.arr.length,fo=(e,t)=>{const n=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n},ut=e=>fo(e,H(e)),ce=e=>e.arr[e.pos++],H=e=>{let t=0,n=1;const s=e.arr.length;for(;e.pos<s;){const o=e.arr[e.pos++];if(t=t+(o&oe)*n,n*=128,o<_t)return t;if(t>_s)throw Ss}throw vs},hr=e=>{let t=e.arr[e.pos++],n=t&Kn,s=64;const o=(t&zt)>0?-1:1;if(!(t&_t))return o*n;const i=e.arr.length;for(;e.pos<i;){if(t=e.arr[e.pos++],n=n+(t&oe)*s,s*=128,t<_t)return o*n;if(n>_s)throw Ss}throw vs},go=e=>{let t=H(e);if(t===0)return"";{let n=String.fromCodePoint(ce(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(ce(e));else for(;t>0;){const s=t<1e4?t:1e4,o=e.arr.subarray(e.pos,e.pos+s);e.pos+=s,n+=String.fromCodePoint.apply(null,o),t-=s}return decodeURIComponent(escape(n))}},po=e=>Pe.decode(ut(e)),Vt=Pe?po:go,dr=(e,t)=>{const n=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,n},mo=e=>dr(e,4).getFloat32(0,!1),yo=e=>dr(e,8).getFloat64(0,!1),wo=e=>dr(e,8).getBigInt64(0,!1),bo=[e=>{},e=>null,hr,mo,yo,wo,e=>!1,e=>!0,Vt,e=>{const t=H(e),n={};for(let s=0;s<t;s++){const o=Vt(e);n[o]=ke(e)}return n},e=>{const t=H(e),n=[];for(let s=0;s<t;s++)n.push(ke(e));return n},ut],ke=e=>bo[127-ce(e)](e);class Vr extends Tn{constructor(t,n){super(t),this.reader=n,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),ho(this)?this.count=H(this)+1:this.count=-1),this.count--,this.s}}class hn extends Tn{constructor(t){super(t),this.s=0,this.count=0}read(){if(this.count===0){this.s=hr(this);const t=bs(this.s);this.count=1,t&&(this.s=-this.s,this.count=H(this)+2)}return this.count--,this.s}}class Bn extends Tn{constructor(t){super(t),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const t=hr(this),n=t&1;this.diff=Mt(t/2),this.count=1,n&&(this.count=H(this)+2)}return this.s+=this.diff,this.count--,this.s}}class _o{constructor(t){this.decoder=new hn(t),this.str=Vt(this.decoder),this.spos=0}read(){const t=this.spos+this.decoder.read(),n=this.str.slice(this.spos,t);return this.spos=t,n}}const vo=crypto.getRandomValues.bind(crypto),So=Math.random,Cs=()=>vo(new Uint32Array(1))[0],Co=[1e7]+-1e3+-4e3+-8e3+-1e11,Es=()=>Co.replace(/[018]/g,e=>(e^Cs()&15>>e/4).toString(16)),qt=Date.now,$r=e=>new Promise(e);Promise.all.bind(Promise);const Eo=e=>Promise.reject(e),fr=e=>Promise.resolve(e),qr=e=>e===void 0?null:e;class ko{constructor(){this.map=new Map}setItem(t,n){this.map.set(t,n)}getItem(t){return this.map.get(t)}}let ks=new ko,gr=!0;try{typeof localStorage<"u"&&localStorage&&(ks=localStorage,gr=!1)}catch{}const Rs=ks,Ro=e=>gr||addEventListener("storage",e),To=e=>gr||removeEventListener("storage",e),Ao=Object.assign,Ts=Object.keys,Do=(e,t)=>{for(const n in e)t(e[n],n)},Wr=e=>Ts(e).length,Hr=e=>Ts(e).length,xo=e=>{for(const t in e)return!1;return!0},Lo=(e,t)=>{for(const n in e)if(!t(e[n],n))return!1;return!0},As=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),Io=(e,t)=>e===t||Hr(e)===Hr(t)&&Lo(e,(n,s)=>(n!==void 0||As(t,s))&&t[s]===n),Oo=Object.freeze,Ds=e=>{for(const t in e){const n=e[t];(typeof n=="object"||typeof n=="function")&&Ds(e[t])}return Oo(e)},Yr=Symbol("Equality"),pr=(e,t,n=0)=>{try{for(;n<e.length;n++)e[n](...t)}finally{n<e.length&&pr(e,t,n+1)}},Mo=()=>{},No=e=>e,ze=(e,t)=>{if(e===t)return!0;if(e==null||t==null||e.constructor!==t.constructor)return!1;if(e[Yr]!=null)return e[Yr](t);switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:{if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;break}case Set:{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;break}case Map:{if(e.size!==t.size)return!1;for(const n of e.keys())if(!t.has(n)||!ze(e.get(n),t.get(n)))return!1;break}case Object:if(Wr(e)!==Wr(t))return!1;for(const n in e)if(!As(e,n)||!ze(e[n],t[n]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!ze(e[n],t[n]))return!1;break;default:return!1}return!0},Uo=(e,t)=>t.includes(e),Re=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",xs=typeof window<"u"&&typeof document<"u"&&!Re;let Dt;const Fo=()=>{if(Dt===void 0)if(Re){Dt=wt();const e=process.argv;let t=null;for(let n=0;n<e.length;n++){const s=e[n];s[0]==="-"?(t!==null&&Dt.set(t,""),t=s):t!==null&&(Dt.set(t,s),t=null)}t!==null&&Dt.set(t,"")}else typeof location=="object"?(Dt=wt(),(location.search||"?").slice(1).split("&").forEach(e=>{if(e.length!==0){const[t,n]=e.split("=");Dt.set(`--${Fr(t,"-")}`,n),Dt.set(`-${Fr(t,"-")}`,n)}})):Dt=wt();return Dt},Qn=e=>Fo().has(e),He=e=>qr(Re?process.env[e.toUpperCase().replaceAll("-","_")]:Rs.getItem(e)),Ls=e=>Qn("--"+e)||He(e)!==null;Ls("production");const Bo=Re&&Uo({}.FORCE_COLOR,["true","1","2"]),jo=Bo||!Qn("--no-colors")&&!Ls("no-color")&&(!Re||process.stdout.isTTY)&&(!Re||Qn("--color")||He("COLORTERM")!==null||(He("TERM")||"").includes("color")),Is=e=>new Uint8Array(e),Po=(e,t,n)=>new Uint8Array(e,t,n),zo=e=>new Uint8Array(e),Vo=e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=Gi(e[n]);return btoa(t)},$o=e=>Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"),qo=e=>{const t=atob(e),n=Is(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return n},Wo=e=>{const t=Buffer.from(e,"base64");return Po(t.buffer,t.byteOffset,t.byteLength)},Os=xs?Vo:$o,Ms=xs?qo:Wo,Ho=e=>{const t=Is(e.byteLength);return t.set(e),t};class Yo{constructor(t,n){this.left=t,this.right=n}}const Pt=(e,t)=>new Yo(e,t);typeof DOMParser<"u"&&new DOMParser;const Go=e=>zi(e,(t,n)=>`${n}:${t};`).join(""),Jo=JSON.stringify,Wt=Symbol,Et=Wt(),ae=Wt(),Ns=Wt(),mr=Wt(),Us=Wt(),Fs=Wt(),Bs=Wt(),An=Wt(),Dn=Wt(),Ko=e=>{var o;e.length===1&&((o=e[0])==null?void 0:o.constructor)===Function&&(e=e[0]());const t=[],n=[];let s=0;for(;s<e.length;s++){const i=e[s];if(i===void 0)break;if(i.constructor===String||i.constructor===Number)t.push(i);else if(i.constructor===Object)break}for(s>0&&n.push(t.join(""));s<e.length;s++){const i=e[s];i instanceof Symbol||n.push(i)}return n},Gr=[Us,Bs,An,Ns];let jn=0,Jr=qt();const Xo=(e,t)=>{const n=Gr[jn],s=He("log"),o=s!==null&&(s==="*"||s==="true"||new RegExp(s,"gi").test(t));return jn=(jn+1)%Gr.length,t+=": ",o?(...i)=>{var c;i.length===1&&((c=i[0])==null?void 0:c.constructor)===Function&&(i=i[0]());const u=qt(),a=u-Jr;Jr=u,e(n,t,Dn,...i.map(p=>{switch(p!=null&&p.constructor===Uint8Array&&(p=Array.from(p)),typeof p){case"string":case"symbol":return p;default:return Jo(p)}}),n," +"+a+"ms")}:Mo},Zo={[Et]:Pt("font-weight","bold"),[ae]:Pt("font-weight","normal"),[Ns]:Pt("color","blue"),[Us]:Pt("color","green"),[mr]:Pt("color","grey"),[Fs]:Pt("color","red"),[Bs]:Pt("color","purple"),[An]:Pt("color","orange"),[Dn]:Pt("color","black")},Qo=e=>{var u;e.length===1&&((u=e[0])==null?void 0:u.constructor)===Function&&(e=e[0]());const t=[],n=[],s=wt();let o=[],i=0;for(;i<e.length;i++){const a=e[i],c=Zo[a];if(c!==void 0)s.set(c.left,c.right);else{if(a===void 0)break;if(a.constructor===String||a.constructor===Number){const p=Go(s);i>0||p.length>0?(t.push("%c"+a),n.push(p)):t.push(a)}else break}}for(i>0&&(o=n,o.unshift(t.join("")));i<e.length;i++){const a=e[i];a instanceof Symbol||o.push(a)}return o},js=jo?Qo:Ko,Ps=(...e)=>{console.log(...js(e)),zs.forEach(t=>t.print(e))},tl=(...e)=>{console.warn(...js(e)),e.unshift(An),zs.forEach(t=>t.print(e))},zs=te(),el=e=>Xo(Ps,e),Vs=e=>({[Symbol.iterator](){return this},next:e}),nl=(e,t)=>Vs(()=>{let n;do n=e.next();while(!n.done&&!t(n.value));return n}),Pn=(e,t)=>Vs(()=>{const{done:n,value:s}=e.next();return{done:n,value:n?void 0:t(s)}});class yr{constructor(t,n){this.clock=t,this.len=n}}class Ze{constructor(){this.clients=new Map}}const $s=(e,t,n)=>t.clients.forEach((s,o)=>{const i=e.doc.store.clients.get(o);if(i!=null){const u=i[i.length-1],a=u.id.clock+u.length;for(let c=0,p=s[c];c<s.length&&p.clock<a;p=s[++c])ni(e,i,p.clock,p.len,n)}}),rl=(e,t)=>{let n=0,s=e.length-1;for(;n<=s;){const o=Mt((n+s)/2),i=e[o],u=i.clock;if(u<=t){if(t<u+i.len)return o;n=o+1}else s=o-1}return null},qs=(e,t)=>{const n=e.clients.get(t.client);return n!==void 0&&rl(n,t.clock)!==null},wr=e=>{e.clients.forEach(t=>{t.sort((o,i)=>o.clock-i.clock);let n,s;for(n=1,s=1;n<t.length;n++){const o=t[s-1],i=t[n];o.clock+o.len>=i.clock?o.len=fe(o.len,i.clock+i.len-o.clock):(s<n&&(t[s]=i),s++)}t.length=s})},sl=e=>{const t=new Ze;for(let n=0;n<e.length;n++)e[n].clients.forEach((s,o)=>{if(!t.clients.has(o)){const i=s.slice();for(let u=n+1;u<e.length;u++)$i(i,e[u].clients.get(o)||[]);t.clients.set(o,i)}});return wr(t),t},fn=(e,t,n,s)=>{vt(e.clients,t,()=>[]).push(new yr(n,s))},il=()=>new Ze,ol=e=>{const t=il();return e.clients.forEach((n,s)=>{const o=[];for(let i=0;i<n.length;i++){const u=n[i];if(u.deleted){const a=u.id.clock;let c=u.length;if(i+1<n.length)for(let p=n[i+1];i+1<n.length&&p.deleted;p=n[++i+1])c+=p.length;o.push(new yr(a,c))}}o.length>0&&t.clients.set(s,o)}),t},Le=(e,t)=>{V(e.restEncoder,t.clients.size),$t(t.clients.entries()).sort((n,s)=>s[0]-n[0]).forEach(([n,s])=>{e.resetDsCurVal(),V(e.restEncoder,n);const o=s.length;V(e.restEncoder,o);for(let i=0;i<o;i++){const u=s[i];e.writeDsClock(u.clock),e.writeDsLen(u.len)}})},br=e=>{const t=new Ze,n=H(e.restDecoder);for(let s=0;s<n;s++){e.resetDsCurVal();const o=H(e.restDecoder),i=H(e.restDecoder);if(i>0){const u=vt(t.clients,o,()=>[]);for(let a=0;a<i;a++)u.push(new yr(e.readDsClock(),e.readDsLen()))}}return t},Kr=(e,t,n)=>{const s=new Ze,o=H(e.restDecoder);for(let i=0;i<o;i++){e.resetDsCurVal();const u=H(e.restDecoder),a=H(e.restDecoder),c=n.clients.get(u)||[],p=dt(n,u);for(let b=0;b<a;b++){const h=e.readDsClock(),f=h+e.readDsLen();if(h<p){p<f&&fn(s,u,p,f-p);let m=Ft(c,h),g=c[m];for(!g.deleted&&g.id.clock<h&&(c.splice(m+1,0,_n(t,g,h-g.id.clock)),m++);m<c.length&&(g=c[m++],g.id.clock<f);)g.deleted||(f<g.id.clock+g.length&&c.splice(m,0,_n(t,g,f-g.id.clock)),g.delete(t))}else fn(s,u,h,f-h)}}if(s.clients.size>0){const i=new ue;return V(i.restEncoder,0),Le(i,s),i.toUint8Array()}return null},Ws=Cs;class Ie extends ys{constructor({guid:t=Es(),collectionid:n=null,gc:s=!0,gcFilter:o=()=>!0,meta:i=null,autoLoad:u=!1,shouldLoad:a=!0}={}){super(),this.gc=s,this.gcFilter=o,this.clientID=Ws(),this.guid=t,this.collectionid=n,this.share=new Map,this.store=new ti,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=a,this.autoLoad=u,this.meta=i,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=$r(p=>{this.on("load",()=>{this.isLoaded=!0,p(this)})});const c=()=>$r(p=>{const b=h=>{(h===void 0||h===!0)&&(this.off("sync",b),p())};this.on("sync",b)});this.on("sync",p=>{p===!1&&this.isSynced&&(this.whenSynced=c()),this.isSynced=p===void 0||p===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=c()}load(){const t=this._item;t!==null&&!this.shouldLoad&&tt(t.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set($t(this.subdocs).map(t=>t.guid))}transact(t,n=null){return tt(this,t,n)}get(t,n=pt){const s=vt(this.share,t,()=>{const i=new n;return i._integrate(this,null),i}),o=s.constructor;if(n!==pt&&o!==n)if(o===pt){const i=new n;i._map=s._map,s._map.forEach(u=>{for(;u!==null;u=u.left)u.parent=i}),i._start=s._start;for(let u=i._start;u!==null;u=u.right)u.parent=i;return i._length=s._length,this.share.set(t,i),i._integrate(this,null),i}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return s}getArray(t=""){return this.get(t,ve)}getText(t=""){return this.get(t,De)}getMap(t=""){return this.get(t,Ae)}getXmlElement(t=""){return this.get(t,xe)}getXmlFragment(t=""){return this.get(t,he)}toJSON(){const t={};return this.share.forEach((n,s)=>{t[s]=n.toJSON()}),t}destroy(){this.isDestroyed=!0,$t(this.subdocs).forEach(n=>n.destroy());const t=this._item;if(t!==null){this._item=null;const n=t.content;n.doc=new Ie({guid:this.guid,...n.opts,shouldLoad:!1}),n.doc._item=t,tt(t.parent.doc,s=>{const o=n.doc;t.deleted||s.subdocsAdded.add(o),s.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class Hs{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return H(this.restDecoder)}readDsLen(){return H(this.restDecoder)}}class Ys extends Hs{readLeftID(){return X(H(this.restDecoder),H(this.restDecoder))}readRightID(){return X(H(this.restDecoder),H(this.restDecoder))}readClient(){return H(this.restDecoder)}readInfo(){return ce(this.restDecoder)}readString(){return Vt(this.restDecoder)}readParentInfo(){return H(this.restDecoder)===1}readTypeRef(){return H(this.restDecoder)}readLen(){return H(this.restDecoder)}readAny(){return ke(this.restDecoder)}readBuf(){return Ho(ut(this.restDecoder))}readJSON(){return JSON.parse(Vt(this.restDecoder))}readKey(){return Vt(this.restDecoder)}}class ll{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=H(this.restDecoder),this.dsCurrVal}readDsLen(){const t=H(this.restDecoder)+1;return this.dsCurrVal+=t,t}}class Te extends ll{constructor(t){super(t),this.keys=[],H(t),this.keyClockDecoder=new Bn(ut(t)),this.clientDecoder=new hn(ut(t)),this.leftClockDecoder=new Bn(ut(t)),this.rightClockDecoder=new Bn(ut(t)),this.infoDecoder=new Vr(ut(t),ce),this.stringDecoder=new _o(ut(t)),this.parentInfoDecoder=new Vr(ut(t),ce),this.typeRefDecoder=new hn(ut(t)),this.lenDecoder=new hn(ut(t))}readLeftID(){return new _e(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new _e(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return ke(this.restDecoder)}readBuf(){return ut(this.restDecoder)}readJSON(){return ke(this.restDecoder)}readKey(){const t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{const n=this.stringDecoder.read();return this.keys.push(n),n}}}class Gs{constructor(){this.restEncoder=ht()}toUint8Array(){return nt(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){V(this.restEncoder,t)}writeDsLen(t){V(this.restEncoder,t)}}class Qe extends Gs{writeLeftID(t){V(this.restEncoder,t.client),V(this.restEncoder,t.clock)}writeRightID(t){V(this.restEncoder,t.client),V(this.restEncoder,t.clock)}writeClient(t){V(this.restEncoder,t)}writeInfo(t){We(this.restEncoder,t)}writeString(t){It(this.restEncoder,t)}writeParentInfo(t){V(this.restEncoder,t?1:0)}writeTypeRef(t){V(this.restEncoder,t)}writeLen(t){V(this.restEncoder,t)}writeAny(t){Ee(this.restEncoder,t)}writeBuf(t){st(this.restEncoder,t)}writeJSON(t){It(this.restEncoder,JSON.stringify(t))}writeKey(t){It(this.restEncoder,t)}}class Js{constructor(){this.restEncoder=ht(),this.dsCurrVal=0}toUint8Array(){return nt(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){const n=t-this.dsCurrVal;this.dsCurrVal=t,V(this.restEncoder,n)}writeDsLen(t){t===0&&Ut(),V(this.restEncoder,t-1),this.dsCurrVal+=t}}class ue extends Js{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Fn,this.clientEncoder=new un,this.leftClockEncoder=new Fn,this.rightClockEncoder=new Fn,this.infoEncoder=new jr(We),this.stringEncoder=new uo,this.parentInfoEncoder=new jr(We),this.typeRefEncoder=new un,this.lenEncoder=new un}toUint8Array(){const t=ht();return V(t,0),st(t,this.keyClockEncoder.toUint8Array()),st(t,this.clientEncoder.toUint8Array()),st(t,this.leftClockEncoder.toUint8Array()),st(t,this.rightClockEncoder.toUint8Array()),st(t,nt(this.infoEncoder)),st(t,this.stringEncoder.toUint8Array()),st(t,nt(this.parentInfoEncoder)),st(t,this.typeRefEncoder.toUint8Array()),st(t,this.lenEncoder.toUint8Array()),Rn(t,nt(this.restEncoder)),nt(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){Ee(this.restEncoder,t)}writeBuf(t){st(this.restEncoder,t)}writeJSON(t){Ee(this.restEncoder,t)}writeKey(t){const n=this.keyMap.get(t);n===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(n)}}const cl=(e,t,n,s)=>{s=fe(s,t[0].id.clock);const o=Ft(t,s);V(e.restEncoder,t.length-o),e.writeClient(n),V(e.restEncoder,s);const i=t[o];i.write(e,s-i.id.clock);for(let u=o+1;u<t.length;u++)t[u].write(e,0)},_r=(e,t,n)=>{const s=new Map;n.forEach((o,i)=>{dt(t,i)>o&&s.set(i,o)}),xn(t).forEach((o,i)=>{n.has(i)||s.set(i,0)}),V(e.restEncoder,s.size),$t(s.entries()).sort((o,i)=>i[0]-o[0]).forEach(([o,i])=>{cl(e,t.clients.get(o),o,i)})},al=(e,t)=>{const n=wt(),s=H(e.restDecoder);for(let o=0;o<s;o++){const i=H(e.restDecoder),u=new Array(i),a=e.readClient();let c=H(e.restDecoder);n.set(a,{i:0,refs:u});for(let p=0;p<i;p++){const b=e.readInfo();switch(kn&b){case 0:{const h=e.readLen();u[p]=new St(X(a,c),h),c+=h;break}case 10:{const h=H(e.restDecoder);u[p]=new Ct(X(a,c),h),c+=h;break}default:{const h=(b&(zt|_t))===0,f=new lt(X(a,c),null,(b&_t)===_t?e.readLeftID():null,null,(b&zt)===zt?e.readRightID():null,h?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,h&&(b&$e)===$e?e.readString():null,vi(e,b));u[p]=f,c+=f.length}}}}return n},ul=(e,t,n)=>{const s=[];let o=$t(n.keys()).sort((m,g)=>m-g);if(o.length===0)return null;const i=()=>{if(o.length===0)return null;let m=n.get(o[o.length-1]);for(;m.refs.length===m.i;)if(o.pop(),o.length>0)m=n.get(o[o.length-1]);else return null;return m};let u=i();if(u===null)return null;const a=new ti,c=new Map,p=(m,g)=>{const S=c.get(m);(S==null||S>g)&&c.set(m,g)};let b=u.refs[u.i++];const h=new Map,f=()=>{for(const m of s){const g=m.id.client,S=n.get(g);S?(S.i--,a.clients.set(g,S.refs.slice(S.i)),n.delete(g),S.i=0,S.refs=[]):a.clients.set(g,[m]),o=o.filter(M=>M!==g)}s.length=0};for(;;){if(b.constructor!==Ct){const g=vt(h,b.id.client,()=>dt(t,b.id.client))-b.id.clock;if(g<0)s.push(b),p(b.id.client,b.id.clock-1),f();else{const S=b.getMissing(e,t);if(S!==null){s.push(b);const M=n.get(S)||{refs:[],i:0};if(M.refs.length===M.i)p(S,dt(t,S)),f();else{b=M.refs[M.i++];continue}}else(g===0||g<b.length)&&(b.integrate(e,g),h.set(b.id.client,b.id.clock+b.length))}}if(s.length>0)b=s.pop();else if(u!==null&&u.i<u.refs.length)b=u.refs[u.i++];else{if(u=i(),u===null)break;b=u.refs[u.i++]}}if(a.clients.size>0){const m=new ue;return _r(m,a,new Map),V(m.restEncoder,0),{missing:c,update:m.toUint8Array()}}return null},hl=(e,t)=>_r(e,t.doc.store,t.beforeState),dl=(e,t,n,s=new Te(e))=>tt(t,o=>{o.local=!1;let i=!1;const u=o.doc,a=u.store,c=al(s,u),p=ul(o,a,c),b=a.pendingStructs;if(b){for(const[f,m]of b.missing)if(m<dt(a,f)){i=!0;break}if(p){for(const[f,m]of p.missing){const g=b.missing.get(f);(g==null||g>m)&&b.missing.set(f,m)}b.update=gn([b.update,p.update])}}else a.pendingStructs=p;const h=Kr(s,o,a);if(a.pendingDs){const f=new Te(jt(a.pendingDs));H(f.restDecoder);const m=Kr(f,o,a);h&&m?a.pendingDs=gn([h,m]):a.pendingDs=h||m}else a.pendingDs=h;if(i){const f=a.pendingStructs.update;a.pendingStructs=null,Ks(o.doc,f)}},n,!1),Ks=(e,t,n,s=Te)=>{const o=jt(t);dl(o,e,n,new s(o))},fl=(e,t,n)=>Ks(e,t,n,Ys),gl=(e,t,n=new Map)=>{_r(e,t.store,n),Le(e,ol(t.store))},pl=(e,t=new Uint8Array([0]),n=new ue)=>{const s=Xs(t);gl(n,e,s);const o=[n.toUint8Array()];if(e.store.pendingDs&&o.push(e.store.pendingDs),e.store.pendingStructs&&o.push(Ll(e.store.pendingStructs.update,t)),o.length>1){if(n.constructor===Qe)return Dl(o.map((i,u)=>u===0?i:Ol(i)));if(n.constructor===ue)return gn(o)}return o[0]},ml=(e,t)=>pl(e,t,new Qe),yl=e=>{const t=new Map,n=H(e.restDecoder);for(let s=0;s<n;s++){const o=H(e.restDecoder),i=H(e.restDecoder);t.set(o,i)}return t},Xs=e=>yl(new Hs(jt(e))),Zs=(e,t)=>(V(e.restEncoder,t.size),$t(t.entries()).sort((n,s)=>s[0]-n[0]).forEach(([n,s])=>{V(e.restEncoder,n),V(e.restEncoder,s)}),e),wl=(e,t)=>Zs(e,xn(t.store)),bl=(e,t=new Js)=>(e instanceof Map?Zs(t,e):wl(t,e),t.toUint8Array()),_l=e=>bl(e,new Gs);class vl{constructor(){this.l=[]}}const Xr=()=>new vl,Zr=(e,t)=>e.l.push(t),Qr=(e,t)=>{const n=e.l,s=n.length;e.l=n.filter(o=>t!==o),s===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},Qs=(e,t,n)=>pr(e.l,[t,n]);class _e{constructor(t,n){this.client=t,this.clock=n}}const rn=(e,t)=>e===t||e!==null&&t!==null&&e.client===t.client&&e.clock===t.clock,X=(e,t)=>new _e(e,t),Sl=e=>{for(const[t,n]of e.doc.share.entries())if(n===e)return t;throw Ut()},be=(e,t)=>t===void 0?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!qs(t.ds,e.id),tr=(e,t)=>{const n=vt(e.meta,tr,te),s=e.doc.store;n.has(t)||(t.sv.forEach((o,i)=>{o<dt(s,i)&&ee(e,X(i,o))}),$s(e,t.ds,o=>{}),n.add(t))};class ti{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const xn=e=>{const t=new Map;return e.clients.forEach((n,s)=>{const o=n[n.length-1];t.set(s,o.id.clock+o.length)}),t},dt=(e,t)=>{const n=e.clients.get(t);if(n===void 0)return 0;const s=n[n.length-1];return s.id.clock+s.length},ei=(e,t)=>{let n=e.clients.get(t.id.client);if(n===void 0)n=[],e.clients.set(t.id.client,n);else{const s=n[n.length-1];if(s.id.clock+s.length!==t.id.clock)throw Ut()}n.push(t)},Ft=(e,t)=>{let n=0,s=e.length-1,o=e[s],i=o.id.clock;if(i===t)return s;let u=Mt(t/(i+o.length-1)*s);for(;n<=s;){if(o=e[u],i=o.id.clock,i<=t){if(t<i+o.length)return u;n=u+1}else s=u-1;u=Mt((n+s)/2)}throw Ut()},Cl=(e,t)=>{const n=e.clients.get(t.client);return n[Ft(n,t.clock)]},zn=Cl,er=(e,t,n)=>{const s=Ft(t,n),o=t[s];return o.id.clock<n&&o instanceof lt?(t.splice(s+1,0,_n(e,o,n-o.id.clock)),s+1):s},ee=(e,t)=>{const n=e.doc.store.clients.get(t.client);return n[er(e,n,t.clock)]},ts=(e,t,n)=>{const s=t.clients.get(n.client),o=Ft(s,n.clock),i=s[o];return n.clock!==i.id.clock+i.length-1&&i.constructor!==St&&s.splice(o+1,0,_n(e,i,n.clock-i.id.clock+1)),i},El=(e,t,n)=>{const s=e.clients.get(t.id.client);s[Ft(s,t.id.clock)]=n},ni=(e,t,n,s,o)=>{if(s===0)return;const i=n+s;let u=er(e,t,n),a;do a=t[u++],i<a.id.clock+a.length&&er(e,t,i),o(a);while(u<t.length&&t[u].id.clock<i)};class kl{constructor(t,n,s){this.doc=t,this.deleteSet=new Ze,this.beforeState=xn(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=s,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const es=(e,t)=>t.deleteSet.clients.size===0&&!Vi(t.afterState,(n,s)=>t.beforeState.get(s)!==n)?!1:(wr(t.deleteSet),hl(e,t),Le(e,t.deleteSet),!0),ns=(e,t,n)=>{const s=t._item;(s===null||s.id.clock<(e.beforeState.get(s.id.client)||0)&&!s.deleted)&&vt(e.changed,t,te).add(n)},dn=(e,t)=>{let n=e[t],s=e[t-1],o=t;for(;o>0;n=s,s=e[--o-1]){if(s.deleted===n.deleted&&s.constructor===n.constructor&&s.mergeWith(n)){n instanceof lt&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,s);continue}break}const i=t-o;return i&&e.splice(t+1-i,i),i},Rl=(e,t,n)=>{for(const[s,o]of e.clients.entries()){const i=t.clients.get(s);for(let u=o.length-1;u>=0;u--){const a=o[u],c=a.clock+a.len;for(let p=Ft(i,a.clock),b=i[p];p<i.length&&b.id.clock<c;b=i[++p]){const h=i[p];if(a.clock+a.len<=h.id.clock)break;h instanceof lt&&h.deleted&&!h.keep&&n(h)&&h.gc(t,!1)}}}},Tl=(e,t)=>{e.clients.forEach((n,s)=>{const o=t.clients.get(s);for(let i=n.length-1;i>=0;i--){const u=n[i],a=cr(o.length-1,1+Ft(o,u.clock+u.len-1));for(let c=a,p=o[c];c>0&&p.id.clock>=u.clock;p=o[c])c-=1+dn(o,c)}})},ri=(e,t)=>{if(t<e.length){const n=e[t],s=n.doc,o=s.store,i=n.deleteSet,u=n._mergeStructs;try{wr(i),n.afterState=xn(n.doc.store),s.emit("beforeObserverCalls",[n,s]);const a=[];n.changed.forEach((c,p)=>a.push(()=>{(p._item===null||!p._item.deleted)&&p._callObserver(n,c)})),a.push(()=>{n.changedParentTypes.forEach((c,p)=>{p._dEH.l.length>0&&(p._item===null||!p._item.deleted)&&(c=c.filter(b=>b.target._item===null||!b.target._item.deleted),c.forEach(b=>{b.currentTarget=p,b._path=null}),c.sort((b,h)=>b.path.length-h.path.length),Qs(p._dEH,c,n))})}),a.push(()=>s.emit("afterTransaction",[n,s])),pr(a,[]),n._needFormattingCleanup&&Yl(n)}finally{s.gc&&Rl(i,o,s.gcFilter),Tl(i,o),n.afterState.forEach((b,h)=>{const f=n.beforeState.get(h)||0;if(f!==b){const m=o.clients.get(h),g=fe(Ft(m,f),1);for(let S=m.length-1;S>=g;)S-=1+dn(m,S)}});for(let b=u.length-1;b>=0;b--){const{client:h,clock:f}=u[b].id,m=o.clients.get(h),g=Ft(m,f);g+1<m.length&&dn(m,g+1)>1||g>0&&dn(m,g)}if(!n.local&&n.afterState.get(s.clientID)!==n.beforeState.get(s.clientID)&&(Ps(An,Et,"[yjs] ",ae,Fs,"Changed the client-id because another client seems to be using it."),s.clientID=Ws()),s.emit("afterTransactionCleanup",[n,s]),s._observers.has("update")){const b=new Qe;es(b,n)&&s.emit("update",[b.toUint8Array(),n.origin,s,n])}if(s._observers.has("updateV2")){const b=new ue;es(b,n)&&s.emit("updateV2",[b.toUint8Array(),n.origin,s,n])}const{subdocsAdded:a,subdocsLoaded:c,subdocsRemoved:p}=n;(a.size>0||p.size>0||c.size>0)&&(a.forEach(b=>{b.clientID=s.clientID,b.collectionid==null&&(b.collectionid=s.collectionid),s.subdocs.add(b)}),p.forEach(b=>s.subdocs.delete(b)),s.emit("subdocs",[{loaded:c,added:a,removed:p},s,n]),p.forEach(b=>b.destroy())),e.length<=t+1?(s._transactionCleanups=[],s.emit("afterAllTransactions",[s,e])):ri(e,t+1)}}},tt=(e,t,n=null,s=!0)=>{const o=e._transactionCleanups;let i=!1,u=null;e._transaction===null&&(i=!0,e._transaction=new kl(e,n,s),o.push(e._transaction),o.length===1&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{u=t(e._transaction)}finally{if(i){const a=e._transaction===o[0];e._transaction=null,a&&ri(o,0)}}return u};function*Al(e){const t=H(e.restDecoder);for(let n=0;n<t;n++){const s=H(e.restDecoder),o=e.readClient();let i=H(e.restDecoder);for(let u=0;u<s;u++){const a=e.readInfo();if(a===10){const c=H(e.restDecoder);yield new Ct(X(o,i),c),i+=c}else if(kn&a){const c=(a&(zt|_t))===0,p=new lt(X(o,i),null,(a&_t)===_t?e.readLeftID():null,null,(a&zt)===zt?e.readRightID():null,c?e.readParentInfo()?e.readString():e.readLeftID():null,c&&(a&$e)===$e?e.readString():null,vi(e,a));yield p,i+=p.length}else{const c=e.readLen();yield new St(X(o,i),c),i+=c}}}}class vr{constructor(t,n){this.gen=Al(t),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Ct);return this.curr}}class Sr{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}}const Dl=e=>gn(e,Ys,Qe),xl=(e,t)=>{if(e.constructor===St){const{client:n,clock:s}=e.id;return new St(X(n,s+t),e.length-t)}else if(e.constructor===Ct){const{client:n,clock:s}=e.id;return new Ct(X(n,s+t),e.length-t)}else{const n=e,{client:s,clock:o}=n.id;return new lt(X(s,o+t),null,X(s,o+t-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(t))}},gn=(e,t=Te,n=ue)=>{if(e.length===1)return e[0];const s=e.map(b=>new t(jt(b)));let o=s.map(b=>new vr(b,!0)),i=null;const u=new n,a=new Sr(u);for(;o=o.filter(f=>f.curr!==null),o.sort((f,m)=>{if(f.curr.id.client===m.curr.id.client){const g=f.curr.id.clock-m.curr.id.clock;return g===0?f.curr.constructor===m.curr.constructor?0:f.curr.constructor===Ct?1:-1:g}else return m.curr.id.client-f.curr.id.client}),o.length!==0;){const b=o[0],h=b.curr.id.client;if(i!==null){let f=b.curr,m=!1;for(;f!==null&&f.id.clock+f.length<=i.struct.id.clock+i.struct.length&&f.id.client>=i.struct.id.client;)f=b.next(),m=!0;if(f===null||f.id.client!==h||m&&f.id.clock>i.struct.id.clock+i.struct.length)continue;if(h!==i.struct.id.client)Zt(a,i.struct,i.offset),i={struct:f,offset:0},b.next();else if(i.struct.id.clock+i.struct.length<f.id.clock)if(i.struct.constructor===Ct)i.struct.length=f.id.clock+f.length-i.struct.id.clock;else{Zt(a,i.struct,i.offset);const g=f.id.clock-i.struct.id.clock-i.struct.length;i={struct:new Ct(X(h,i.struct.id.clock+i.struct.length),g),offset:0}}else{const g=i.struct.id.clock+i.struct.length-f.id.clock;g>0&&(i.struct.constructor===Ct?i.struct.length-=g:f=xl(f,g)),i.struct.mergeWith(f)||(Zt(a,i.struct,i.offset),i={struct:f,offset:0},b.next())}}else i={struct:b.curr,offset:0},b.next();for(let f=b.curr;f!==null&&f.id.client===h&&f.id.clock===i.struct.id.clock+i.struct.length&&f.constructor!==Ct;f=b.next())Zt(a,i.struct,i.offset),i={struct:f,offset:0}}i!==null&&(Zt(a,i.struct,i.offset),i=null),Cr(a);const c=s.map(b=>br(b)),p=sl(c);return Le(u,p),u.toUint8Array()},Ll=(e,t,n=Te,s=ue)=>{const o=Xs(t),i=new s,u=new Sr(i),a=new n(jt(e)),c=new vr(a,!1);for(;c.curr;){const b=c.curr,h=b.id.client,f=o.get(h)||0;if(c.curr.constructor===Ct){c.next();continue}if(b.id.clock+b.length>f)for(Zt(u,b,fe(f-b.id.clock,0)),c.next();c.curr&&c.curr.id.client===h;)Zt(u,c.curr,0),c.next();else for(;c.curr&&c.curr.id.client===h&&c.curr.id.clock+c.curr.length<=f;)c.next()}Cr(u);const p=br(a);return Le(i,p),i.toUint8Array()},si=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:nt(e.encoder.restEncoder)}),e.encoder.restEncoder=ht(),e.written=0)},Zt=(e,t,n)=>{e.written>0&&e.currClient!==t.id.client&&si(e),e.written===0&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),V(e.encoder.restEncoder,t.id.clock+n)),t.write(e.encoder,n),e.written++},Cr=e=>{si(e);const t=e.encoder.restEncoder;V(t,e.clientStructs.length);for(let n=0;n<e.clientStructs.length;n++){const s=e.clientStructs[n];V(t,s.written),Rn(t,s.restEncoder)}},Il=(e,t,n,s)=>{const o=new n(jt(e)),i=new vr(o,!1),u=new s,a=new Sr(u);for(let p=i.curr;p!==null;p=i.next())Zt(a,t(p),0);Cr(a);const c=br(o);return Le(u,c),u.toUint8Array()},Ol=e=>Il(e,No,Te,Qe),rs="You must not compute changes after the event-handler fired.";class Ln{constructor(t,n){this.target=t,this.currentTarget=t,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=Ml(this.currentTarget,this.target))}deletes(t){return qs(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw Nt(rs);const t=new Map,n=this.target;this.transaction.changed.get(n).forEach(o=>{if(o!==null){const i=n._map.get(o);let u,a;if(this.adds(i)){let c=i.left;for(;c!==null&&this.adds(c);)c=c.left;if(this.deletes(i))if(c!==null&&this.deletes(c))u="delete",a=Mn(c.content.getContent());else return;else c!==null&&this.deletes(c)?(u="update",a=Mn(c.content.getContent())):(u="add",a=void 0)}else if(this.deletes(i))u="delete",a=Mn(i.content.getContent());else return;t.set(o,{action:u,oldValue:a})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){if(this.transaction.doc._transactionCleanups.length===0)throw Nt(rs);const n=this.target,s=te(),o=te(),i=[];if(t={added:s,deleted:o,delta:i,keys:this.keys},this.transaction.changed.get(n).has(null)){let a=null;const c=()=>{a&&i.push(a)};for(let p=n._start;p!==null;p=p.right)p.deleted?this.deletes(p)&&!this.adds(p)&&((a===null||a.delete===void 0)&&(c(),a={delete:0}),a.delete+=p.length,o.add(p)):this.adds(p)?((a===null||a.insert===void 0)&&(c(),a={insert:[]}),a.insert=a.insert.concat(p.content.getContent()),s.add(p)):((a===null||a.retain===void 0)&&(c(),a={retain:0}),a.retain+=p.length);a!==null&&a.retain===void 0&&c()}this._changes=t}return t}}const Ml=(e,t)=>{const n=[];for(;t._item!==null&&t!==e;){if(t._item.parentSub!==null)n.unshift(t._item.parentSub);else{let s=0,o=t._item.parent._start;for(;o!==t._item&&o!==null;)!o.deleted&&o.countable&&(s+=o.length),o=o.right;n.unshift(s)}t=t._item.parent}return n},mt=()=>{tl("Invalid access: Add Yjs type to a document before reading data.")},ii=80;let Er=0;class Nl{constructor(t,n){t.marker=!0,this.p=t,this.index=n,this.timestamp=Er++}}const Ul=e=>{e.timestamp=Er++},oi=(e,t,n)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=n,e.timestamp=Er++},Fl=(e,t,n)=>{if(e.length>=ii){const s=e.reduce((o,i)=>o.timestamp<i.timestamp?o:i);return oi(s,t,n),s}else{const s=new Nl(t,n);return e.push(s),s}},In=(e,t)=>{if(e._start===null||t===0||e._searchMarker===null)return null;const n=e._searchMarker.length===0?null:e._searchMarker.reduce((i,u)=>an(t-i.index)<an(t-u.index)?i:u);let s=e._start,o=0;for(n!==null&&(s=n.p,o=n.index,Ul(n));s.right!==null&&o<t;){if(!s.deleted&&s.countable){if(t<o+s.length)break;o+=s.length}s=s.right}for(;s.left!==null&&o>t;)s=s.left,!s.deleted&&s.countable&&(o-=s.length);for(;s.left!==null&&s.left.id.client===s.id.client&&s.left.id.clock+s.left.length===s.id.clock;)s=s.left,!s.deleted&&s.countable&&(o-=s.length);return n!==null&&an(n.index-o)<s.parent.length/ii?(oi(n,s,o),n):Fl(e._searchMarker,s,o)},Ye=(e,t,n)=>{for(let s=e.length-1;s>=0;s--){const o=e[s];if(n>0){let i=o.p;for(i.marker=!1;i&&(i.deleted||!i.countable);)i=i.left,i&&!i.deleted&&i.countable&&(o.index-=i.length);if(i===null||i.marker===!0){e.splice(s,1);continue}o.p=i,i.marker=!0}(t<o.index||n>0&&t===o.index)&&(o.index=fe(t,o.index+n))}},On=(e,t,n)=>{const s=e,o=t.changedParentTypes;for(;vt(o,e,()=>[]).push(n),e._item!==null;)e=e._item.parent;Qs(s._eH,n,t)};class pt{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Xr(),this._dEH=Xr(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,n){this.doc=t,this._item=n}_copy(){throw Ot()}clone(){throw Ot()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,n){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){Zr(this._eH,t)}observeDeep(t){Zr(this._dEH,t)}unobserve(t){Qr(this._eH,t)}unobserveDeep(t){Qr(this._dEH,t)}toJSON(){}}const li=(e,t,n)=>{e.doc??mt(),t<0&&(t=e._length+t),n<0&&(n=e._length+n);let s=n-t;const o=[];let i=e._start;for(;i!==null&&s>0;){if(i.countable&&!i.deleted){const u=i.content.getContent();if(u.length<=t)t-=u.length;else{for(let a=t;a<u.length&&s>0;a++)o.push(u[a]),s--;t=0}}i=i.right}return o},ci=e=>{e.doc??mt();const t=[];let n=e._start;for(;n!==null;){if(n.countable&&!n.deleted){const s=n.content.getContent();for(let o=0;o<s.length;o++)t.push(s[o])}n=n.right}return t},Ge=(e,t)=>{let n=0,s=e._start;for(e.doc??mt();s!==null;){if(s.countable&&!s.deleted){const o=s.content.getContent();for(let i=0;i<o.length;i++)t(o[i],n++,e)}s=s.right}},ai=(e,t)=>{const n=[];return Ge(e,(s,o)=>{n.push(t(s,o,e))}),n},Bl=e=>{let t=e._start,n=null,s=0;return{[Symbol.iterator](){return this},next:()=>{if(n===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};n=t.content.getContent(),s=0,t=t.right}const o=n[s++];return n.length<=s&&(n=null),{done:!1,value:o}}}},ui=(e,t)=>{e.doc??mt();const n=In(e,t);let s=e._start;for(n!==null&&(s=n.p,t-=n.index);s!==null;s=s.right)if(!s.deleted&&s.countable){if(t<s.length)return s.content.getContent()[t];t-=s.length}},pn=(e,t,n,s)=>{let o=n;const i=e.doc,u=i.clientID,a=i.store,c=n===null?t._start:n.right;let p=[];const b=()=>{p.length>0&&(o=new lt(X(u,dt(a,u)),o,o&&o.lastId,c,c&&c.id,t,null,new de(p)),o.integrate(e,0),p=[])};s.forEach(h=>{if(h===null)p.push(h);else switch(h.constructor){case Number:case Object:case Boolean:case Array:case String:p.push(h);break;default:switch(b(),h.constructor){case Uint8Array:case ArrayBuffer:o=new lt(X(u,dt(a,u)),o,o&&o.lastId,c,c&&c.id,t,null,new tn(new Uint8Array(h))),o.integrate(e,0);break;case Ie:o=new lt(X(u,dt(a,u)),o,o&&o.lastId,c,c&&c.id,t,null,new en(h)),o.integrate(e,0);break;default:if(h instanceof pt)o=new lt(X(u,dt(a,u)),o,o&&o.lastId,c,c&&c.id,t,null,new Ht(h)),o.integrate(e,0);else throw new Error("Unexpected content type in insert operation")}}}),b()},hi=()=>Nt("Length exceeded!"),di=(e,t,n,s)=>{if(n>t._length)throw hi();if(n===0)return t._searchMarker&&Ye(t._searchMarker,n,s.length),pn(e,t,null,s);const o=n,i=In(t,n);let u=t._start;for(i!==null&&(u=i.p,n-=i.index,n===0&&(u=u.prev,n+=u&&u.countable&&!u.deleted?u.length:0));u!==null;u=u.right)if(!u.deleted&&u.countable){if(n<=u.length){n<u.length&&ee(e,X(u.id.client,u.id.clock+n));break}n-=u.length}return t._searchMarker&&Ye(t._searchMarker,o,s.length),pn(e,t,u,s)},jl=(e,t,n)=>{let o=(t._searchMarker||[]).reduce((i,u)=>u.index>i.index?u:i,{index:0,p:t._start}).p;if(o)for(;o.right;)o=o.right;return pn(e,t,o,n)},fi=(e,t,n,s)=>{if(s===0)return;const o=n,i=s,u=In(t,n);let a=t._start;for(u!==null&&(a=u.p,n-=u.index);a!==null&&n>0;a=a.right)!a.deleted&&a.countable&&(n<a.length&&ee(e,X(a.id.client,a.id.clock+n)),n-=a.length);for(;s>0&&a!==null;)a.deleted||(s<a.length&&ee(e,X(a.id.client,a.id.clock+s)),a.delete(e),s-=a.length),a=a.right;if(s>0)throw hi();t._searchMarker&&Ye(t._searchMarker,o,-i+s)},mn=(e,t,n)=>{const s=t._map.get(n);s!==void 0&&s.delete(e)},kr=(e,t,n,s)=>{const o=t._map.get(n)||null,i=e.doc,u=i.clientID;let a;if(s==null)a=new de([s]);else switch(s.constructor){case Number:case Object:case Boolean:case Array:case String:case Date:case BigInt:a=new de([s]);break;case Uint8Array:a=new tn(s);break;case Ie:a=new en(s);break;default:if(s instanceof pt)a=new Ht(s);else throw new Error("Unexpected content type")}new lt(X(u,dt(i.store,u)),o,o&&o.lastId,null,null,t,n,a).integrate(e,0)},Rr=(e,t)=>{e.doc??mt();const n=e._map.get(t);return n!==void 0&&!n.deleted?n.content.getContent()[n.length-1]:void 0},gi=e=>{const t={};return e.doc??mt(),e._map.forEach((n,s)=>{n.deleted||(t[s]=n.content.getContent()[n.length-1])}),t},pi=(e,t)=>{e.doc??mt();const n=e._map.get(t);return n!==void 0&&!n.deleted},Pl=(e,t)=>{const n={};return e._map.forEach((s,o)=>{let i=s;for(;i!==null&&(!t.sv.has(i.id.client)||i.id.clock>=(t.sv.get(i.id.client)||0));)i=i.left;i!==null&&be(i,t)&&(n[o]=i.content.getContent()[i.length-1])}),n},sn=e=>(e.doc??mt(),nl(e._map.entries(),t=>!t[1].deleted));class zl extends Ln{}class ve extends pt{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){const n=new ve;return n.push(t),n}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new ve}clone(){const t=new ve;return t.insert(0,this.toArray().map(n=>n instanceof pt?n.clone():n)),t}get length(){return this.doc??mt(),this._length}_callObserver(t,n){super._callObserver(t,n),On(this,t,new zl(this,t))}insert(t,n){this.doc!==null?tt(this.doc,s=>{di(s,this,t,n)}):this._prelimContent.splice(t,0,...n)}push(t){this.doc!==null?tt(this.doc,n=>{jl(n,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,n=1){this.doc!==null?tt(this.doc,s=>{fi(s,this,t,n)}):this._prelimContent.splice(t,n)}get(t){return ui(this,t)}toArray(){return ci(this)}slice(t=0,n=this.length){return li(this,t,n)}toJSON(){return this.map(t=>t instanceof pt?t.toJSON():t)}map(t){return ai(this,t)}forEach(t){Ge(this,t)}[Symbol.iterator](){return Bl(this)}_write(t){t.writeTypeRef(dc)}}const Vl=e=>new ve;class $l extends Ln{constructor(t,n,s){super(t,n),this.keysChanged=s}}class Ae extends pt{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,n){super._integrate(t,n),this._prelimContent.forEach((s,o)=>{this.set(o,s)}),this._prelimContent=null}_copy(){return new Ae}clone(){const t=new Ae;return this.forEach((n,s)=>{t.set(s,n instanceof pt?n.clone():n)}),t}_callObserver(t,n){On(this,t,new $l(this,t,n))}toJSON(){this.doc??mt();const t={};return this._map.forEach((n,s)=>{if(!n.deleted){const o=n.content.getContent()[n.length-1];t[s]=o instanceof pt?o.toJSON():o}}),t}get size(){return[...sn(this)].length}keys(){return Pn(sn(this),t=>t[0])}values(){return Pn(sn(this),t=>t[1].content.getContent()[t[1].length-1])}entries(){return Pn(sn(this),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this.doc??mt(),this._map.forEach((n,s)=>{n.deleted||t(n.content.getContent()[n.length-1],s,this)})}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?tt(this.doc,n=>{mn(n,this,t)}):this._prelimContent.delete(t)}set(t,n){return this.doc!==null?tt(this.doc,s=>{kr(s,this,t,n)}):this._prelimContent.set(t,n),n}get(t){return Rr(this,t)}has(t){return pi(this,t)}clear(){this.doc!==null?tt(this.doc,t=>{this.forEach(function(n,s,o){mn(t,o,s)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef(fc)}}const ql=e=>new Ae,Qt=(e,t)=>e===t||typeof e=="object"&&typeof t=="object"&&e&&t&&Io(e,t);class nr{constructor(t,n,s,o){this.left=t,this.right=n,this.index=s,this.currentAttributes=o}forward(){switch(this.right===null&&Ut(),this.right.content.constructor){case ct:this.right.deleted||Oe(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const ss=(e,t,n)=>{for(;t.right!==null&&n>0;){switch(t.right.content.constructor){case ct:t.right.deleted||Oe(t.currentAttributes,t.right.content);break;default:t.right.deleted||(n<t.right.length&&ee(e,X(t.right.id.client,t.right.id.clock+n)),t.index+=t.right.length,n-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},on=(e,t,n,s)=>{const o=new Map,i=s?In(t,n):null;if(i){const u=new nr(i.p.left,i.p,i.index,o);return ss(e,u,n-i.index)}else{const u=new nr(null,t._start,0,o);return ss(e,u,n)}},mi=(e,t,n,s)=>{for(;n.right!==null&&(n.right.deleted===!0||n.right.content.constructor===ct&&Qt(s.get(n.right.content.key),n.right.content.value));)n.right.deleted||s.delete(n.right.content.key),n.forward();const o=e.doc,i=o.clientID;s.forEach((u,a)=>{const c=n.left,p=n.right,b=new lt(X(i,dt(o.store,i)),c,c&&c.lastId,p,p&&p.id,t,null,new ct(a,u));b.integrate(e,0),n.right=b,n.forward()})},Oe=(e,t)=>{const{key:n,value:s}=t;s===null?e.delete(n):e.set(n,s)},yi=(e,t)=>{for(;e.right!==null;){if(!(e.right.deleted||e.right.content.constructor===ct&&Qt(t[e.right.content.key]??null,e.right.content.value)))break;e.forward()}},wi=(e,t,n,s)=>{const o=e.doc,i=o.clientID,u=new Map;for(const a in s){const c=s[a],p=n.currentAttributes.get(a)??null;if(!Qt(p,c)){u.set(a,p);const{left:b,right:h}=n;n.right=new lt(X(i,dt(o.store,i)),b,b&&b.lastId,h,h&&h.id,t,null,new ct(a,c)),n.right.integrate(e,0),n.forward()}}return u},Vn=(e,t,n,s,o)=>{n.currentAttributes.forEach((f,m)=>{o[m]===void 0&&(o[m]=null)});const i=e.doc,u=i.clientID;yi(n,o);const a=wi(e,t,n,o),c=s.constructor===String?new Bt(s):s instanceof pt?new Ht(s):new ge(s);let{left:p,right:b,index:h}=n;t._searchMarker&&Ye(t._searchMarker,n.index,c.getLength()),b=new lt(X(u,dt(i.store,u)),p,p&&p.lastId,b,b&&b.id,t,null,c),b.integrate(e,0),n.right=b,n.index=h,n.forward(),mi(e,t,n,a)},is=(e,t,n,s,o)=>{const i=e.doc,u=i.clientID;yi(n,o);const a=wi(e,t,n,o);t:for(;n.right!==null&&(s>0||a.size>0&&(n.right.deleted||n.right.content.constructor===ct));){if(!n.right.deleted)switch(n.right.content.constructor){case ct:{const{key:c,value:p}=n.right.content,b=o[c];if(b!==void 0){if(Qt(b,p))a.delete(c);else{if(s===0)break t;a.set(c,p)}n.right.delete(e)}else n.currentAttributes.set(c,p);break}default:s<n.right.length&&ee(e,X(n.right.id.client,n.right.id.clock+s)),s-=n.right.length;break}n.forward()}if(s>0){let c="";for(;s>0;s--)c+=`
`;n.right=new lt(X(u,dt(i.store,u)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,t,null,new Bt(c)),n.right.integrate(e,0),n.forward()}mi(e,t,n,a)},bi=(e,t,n,s,o)=>{let i=t;const u=wt();for(;i&&(!i.countable||i.deleted);){if(!i.deleted&&i.content.constructor===ct){const p=i.content;u.set(p.key,p)}i=i.right}let a=0,c=!1;for(;t!==i;){if(n===t&&(c=!0),!t.deleted){const p=t.content;switch(p.constructor){case ct:{const{key:b,value:h}=p,f=s.get(b)??null;(u.get(b)!==p||f===h)&&(t.delete(e),a++,!c&&(o.get(b)??null)===h&&f!==h&&(f===null?o.delete(b):o.set(b,f))),!c&&!t.deleted&&Oe(o,p);break}}}t=t.right}return a},Wl=(e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const n=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===ct){const s=t.content.key;n.has(s)?t.delete(e):n.add(s)}t=t.left}},Hl=e=>{let t=0;return tt(e.doc,n=>{let s=e._start,o=e._start,i=wt();const u=Jn(i);for(;o;){if(o.deleted===!1)switch(o.content.constructor){case ct:Oe(u,o.content);break;default:t+=bi(n,s,o,i,u),i=Jn(u),s=o;break}o=o.right}}),t},Yl=e=>{const t=new Set,n=e.doc;for(const[s,o]of e.afterState.entries()){const i=e.beforeState.get(s)||0;o!==i&&ni(e,n.store.clients.get(s),i,o,u=>{!u.deleted&&u.content.constructor===ct&&u.constructor!==St&&t.add(u.parent)})}tt(n,s=>{$s(e,e.deleteSet,o=>{if(o instanceof St||!o.parent._hasFormatting||t.has(o.parent))return;const i=o.parent;o.content.constructor===ct?t.add(i):Wl(s,o)});for(const o of t)Hl(o)})},os=(e,t,n)=>{const s=n,o=Jn(t.currentAttributes),i=t.right;for(;n>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case Ht:case ge:case Bt:n<t.right.length&&ee(e,X(t.right.id.client,t.right.id.clock+n)),n-=t.right.length,t.right.delete(e);break}t.forward()}i&&bi(e,i,t.right,o,t.currentAttributes);const u=(t.left||t.right).parent;return u._searchMarker&&Ye(u._searchMarker,t.index,-s+n),t};class Gl extends Ln{constructor(t,n,s){super(t,n),this.childListChanged=!1,this.keysChanged=new Set,s.forEach(o=>{o===null?this.childListChanged=!0:this.keysChanged.add(o)})}get changes(){if(this._changes===null){const t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){const t=this.target.doc,n=[];tt(t,s=>{const o=new Map,i=new Map;let u=this.target._start,a=null;const c={};let p="",b=0,h=0;const f=()=>{if(a!==null){let m=null;switch(a){case"delete":h>0&&(m={delete:h}),h=0;break;case"insert":(typeof p=="object"||p.length>0)&&(m={insert:p},o.size>0&&(m.attributes={},o.forEach((g,S)=>{g!==null&&(m.attributes[S]=g)}))),p="";break;case"retain":b>0&&(m={retain:b},xo(c)||(m.attributes=Ao({},c))),b=0;break}m&&n.push(m),a=null}};for(;u!==null;){switch(u.content.constructor){case Ht:case ge:this.adds(u)?this.deletes(u)||(f(),a="insert",p=u.content.getContent()[0],f()):this.deletes(u)?(a!=="delete"&&(f(),a="delete"),h+=1):u.deleted||(a!=="retain"&&(f(),a="retain"),b+=1);break;case Bt:this.adds(u)?this.deletes(u)||(a!=="insert"&&(f(),a="insert"),p+=u.content.str):this.deletes(u)?(a!=="delete"&&(f(),a="delete"),h+=u.length):u.deleted||(a!=="retain"&&(f(),a="retain"),b+=u.length);break;case ct:{const{key:m,value:g}=u.content;if(this.adds(u)){if(!this.deletes(u)){const S=o.get(m)??null;Qt(S,g)?g!==null&&u.delete(s):(a==="retain"&&f(),Qt(g,i.get(m)??null)?delete c[m]:c[m]=g)}}else if(this.deletes(u)){i.set(m,g);const S=o.get(m)??null;Qt(S,g)||(a==="retain"&&f(),c[m]=S)}else if(!u.deleted){i.set(m,g);const S=c[m];S!==void 0&&(Qt(S,g)?S!==null&&u.delete(s):(a==="retain"&&f(),g===null?delete c[m]:c[m]=g))}u.deleted||(a==="insert"&&f(),Oe(o,u.content));break}}u=u.right}for(f();n.length>0;){const m=n[n.length-1];if(m.retain!==void 0&&m.attributes===void 0)n.pop();else break}}),this._delta=n}return this._delta}}class De extends pt{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??mt(),this._length}_integrate(t,n){super._integrate(t,n);try{this._pending.forEach(s=>s())}catch(s){console.error(s)}this._pending=null}_copy(){return new De}clone(){const t=new De;return t.applyDelta(this.toDelta()),t}_callObserver(t,n){super._callObserver(t,n);const s=new Gl(this,t,n);On(this,t,s),!t.local&&this._hasFormatting&&(t._needFormattingCleanup=!0)}toString(){this.doc??mt();let t="",n=this._start;for(;n!==null;)!n.deleted&&n.countable&&n.content.constructor===Bt&&(t+=n.content.str),n=n.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:n=!0}={}){this.doc!==null?tt(this.doc,s=>{const o=new nr(null,this._start,0,new Map);for(let i=0;i<t.length;i++){const u=t[i];if(u.insert!==void 0){const a=!n&&typeof u.insert=="string"&&i===t.length-1&&o.right===null&&u.insert.slice(-1)===`
`?u.insert.slice(0,-1):u.insert;(typeof a!="string"||a.length>0)&&Vn(s,this,o,a,u.attributes||{})}else u.retain!==void 0?is(s,this,o,u.retain,u.attributes||{}):u.delete!==void 0&&os(s,o,u.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,n,s){this.doc??mt();const o=[],i=new Map,u=this.doc;let a="",c=this._start;function p(){if(a.length>0){const h={};let f=!1;i.forEach((g,S)=>{f=!0,h[S]=g});const m={insert:a};f&&(m.attributes=h),o.push(m),a=""}}const b=()=>{for(;c!==null;){if(be(c,t)||n!==void 0&&be(c,n))switch(c.content.constructor){case Bt:{const h=i.get("ychange");t!==void 0&&!be(c,t)?(h===void 0||h.user!==c.id.client||h.type!=="removed")&&(p(),i.set("ychange",s?s("removed",c.id):{type:"removed"})):n!==void 0&&!be(c,n)?(h===void 0||h.user!==c.id.client||h.type!=="added")&&(p(),i.set("ychange",s?s("added",c.id):{type:"added"})):h!==void 0&&(p(),i.delete("ychange")),a+=c.content.str;break}case Ht:case ge:{p();const h={insert:c.content.getContent()[0]};if(i.size>0){const f={};h.attributes=f,i.forEach((m,g)=>{f[g]=m})}o.push(h);break}case ct:be(c,t)&&(p(),Oe(i,c.content));break}c=c.right}p()};return t||n?tt(u,h=>{t&&tr(h,t),n&&tr(h,n),b()},"cleanup"):b(),o}insert(t,n,s){if(n.length<=0)return;const o=this.doc;o!==null?tt(o,i=>{const u=on(i,this,t,!s);s||(s={},u.currentAttributes.forEach((a,c)=>{s[c]=a})),Vn(i,this,u,n,s)}):this._pending.push(()=>this.insert(t,n,s))}insertEmbed(t,n,s){const o=this.doc;o!==null?tt(o,i=>{const u=on(i,this,t,!s);Vn(i,this,u,n,s||{})}):this._pending.push(()=>this.insertEmbed(t,n,s||{}))}delete(t,n){if(n===0)return;const s=this.doc;s!==null?tt(s,o=>{os(o,on(o,this,t,!0),n)}):this._pending.push(()=>this.delete(t,n))}format(t,n,s){if(n===0)return;const o=this.doc;o!==null?tt(o,i=>{const u=on(i,this,t,!1);u.right!==null&&is(i,this,u,n,s)}):this._pending.push(()=>this.format(t,n,s))}removeAttribute(t){this.doc!==null?tt(this.doc,n=>{mn(n,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,n){this.doc!==null?tt(this.doc,s=>{kr(s,this,t,n)}):this._pending.push(()=>this.setAttribute(t,n))}getAttribute(t){return Rr(this,t)}getAttributes(){return gi(this)}_write(t){t.writeTypeRef(gc)}}const Jl=e=>new De;class $n{constructor(t,n=()=>!0){this._filter=n,this._root=t,this._currentNode=t._start,this._firstCall=!0,t.doc??mt()}[Symbol.iterator](){return this}next(){let t=this._currentNode,n=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(n)))do if(n=t.content.type,!t.deleted&&(n.constructor===xe||n.constructor===he)&&n._start!==null)t=n._start;else for(;t!==null;){const s=t.next;if(s!==null){t=s;break}else t.parent===this._root?t=null:t=t.parent._item}while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class he extends pt{constructor(){super(),this._prelimContent=[]}get firstChild(){const t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,n){super._integrate(t,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new he}clone(){const t=new he;return t.insert(0,this.toArray().map(n=>n instanceof pt?n.clone():n)),t}get length(){return this.doc??mt(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new $n(this,t)}querySelector(t){t=t.toUpperCase();const s=new $n(this,o=>o.nodeName&&o.nodeName.toUpperCase()===t).next();return s.done?null:s.value}querySelectorAll(t){return t=t.toUpperCase(),$t(new $n(this,n=>n.nodeName&&n.nodeName.toUpperCase()===t))}_callObserver(t,n){On(this,t,new Zl(this,n,t))}toString(){return ai(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,n={},s){const o=t.createDocumentFragment();return s!==void 0&&s._createAssociation(o,this),Ge(this,i=>{o.insertBefore(i.toDOM(t,n,s),null)}),o}insert(t,n){this.doc!==null?tt(this.doc,s=>{di(s,this,t,n)}):this._prelimContent.splice(t,0,...n)}insertAfter(t,n){if(this.doc!==null)tt(this.doc,s=>{const o=t&&t instanceof pt?t._item:t;pn(s,this,o,n)});else{const s=this._prelimContent,o=t===null?0:s.findIndex(i=>i===t)+1;if(o===0&&t!==null)throw Nt("Reference item not found");s.splice(o,0,...n)}}delete(t,n=1){this.doc!==null?tt(this.doc,s=>{fi(s,this,t,n)}):this._prelimContent.splice(t,n)}toArray(){return ci(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return ui(this,t)}slice(t=0,n=this.length){return li(this,t,n)}forEach(t){Ge(this,t)}_write(t){t.writeTypeRef(mc)}}const Kl=e=>new he;class xe extends he{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,n){super._integrate(t,n),this._prelimAttrs.forEach((s,o)=>{this.setAttribute(o,s)}),this._prelimAttrs=null}_copy(){return new xe(this.nodeName)}clone(){const t=new xe(this.nodeName),n=this.getAttributes();return Do(n,(s,o)=>{typeof s=="string"&&t.setAttribute(o,s)}),t.insert(0,this.toArray().map(s=>s instanceof pt?s.clone():s)),t}toString(){const t=this.getAttributes(),n=[],s=[];for(const a in t)s.push(a);s.sort();const o=s.length;for(let a=0;a<o;a++){const c=s[a];n.push(c+'="'+t[c]+'"')}const i=this.nodeName.toLocaleLowerCase(),u=n.length>0?" "+n.join(" "):"";return`<${i}${u}>${super.toString()}</${i}>`}removeAttribute(t){this.doc!==null?tt(this.doc,n=>{mn(n,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,n){this.doc!==null?tt(this.doc,s=>{kr(s,this,t,n)}):this._prelimAttrs.set(t,n)}getAttribute(t){return Rr(this,t)}hasAttribute(t){return pi(this,t)}getAttributes(t){return t?Pl(this,t):gi(this)}toDOM(t=document,n={},s){const o=t.createElement(this.nodeName),i=this.getAttributes();for(const u in i){const a=i[u];typeof a=="string"&&o.setAttribute(u,a)}return Ge(this,u=>{o.appendChild(u.toDOM(t,n,s))}),s!==void 0&&s._createAssociation(o,this),o}_write(t){t.writeTypeRef(pc),t.writeKey(this.nodeName)}}const Xl=e=>new xe(e.readKey());class Zl extends Ln{constructor(t,n,s){super(t,s),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(o=>{o===null?this.childListChanged=!0:this.attributesChanged.add(o)})}}class yn extends Ae{constructor(t){super(),this.hookName=t}_copy(){return new yn(this.hookName)}clone(){const t=new yn(this.hookName);return this.forEach((n,s)=>{t.set(s,n)}),t}toDOM(t=document,n={},s){const o=n[this.hookName];let i;return o!==void 0?i=o.createDom(this):i=document.createElement(this.hookName),i.setAttribute("data-yjs-hook",this.hookName),s!==void 0&&s._createAssociation(i,this),i}_write(t){t.writeTypeRef(yc),t.writeKey(this.hookName)}}const Ql=e=>new yn(e.readKey());class wn extends De{get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new wn}clone(){const t=new wn;return t.applyDelta(this.toDelta()),t}toDOM(t=document,n,s){const o=t.createTextNode(this.toString());return s!==void 0&&s._createAssociation(o,this),o}toString(){return this.toDelta().map(t=>{const n=[];for(const o in t.attributes){const i=[];for(const u in t.attributes[o])i.push({key:u,value:t.attributes[o][u]});i.sort((u,a)=>u.key<a.key?-1:1),n.push({nodeName:o,attrs:i})}n.sort((o,i)=>o.nodeName<i.nodeName?-1:1);let s="";for(let o=0;o<n.length;o++){const i=n[o];s+=`<${i.nodeName}`;for(let u=0;u<i.attrs.length;u++){const a=i.attrs[u];s+=` ${a.key}="${a.value}"`}s+=">"}s+=t.insert;for(let o=n.length-1;o>=0;o--)s+=`</${n[o].nodeName}>`;return s}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(wc)}}const tc=e=>new wn;class Tr{constructor(t,n){this.id=t,this.length=n}get deleted(){throw Ot()}mergeWith(t){return!1}write(t,n,s){throw Ot()}integrate(t,n){throw Ot()}}const ec=0;class St extends Tr{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){n>0&&(this.id.clock+=n,this.length-=n),ei(t.doc.store,this)}write(t,n){t.writeInfo(ec),t.writeLen(this.length-n)}getMissing(t,n){return null}}class tn{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new tn(this.content)}splice(t){throw Ot()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeBuf(this.content)}getRef(){return 3}}const nc=e=>new tn(e.readBuf());class Je{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Je(this.len)}splice(t){const n=new Je(this.len-t);return this.len=t,n}mergeWith(t){return this.len+=t.len,!0}integrate(t,n){fn(t.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(t){}gc(t){}write(t,n){t.writeLen(this.len-n)}getRef(){return 1}}const rc=e=>new Je(e.readLen()),_i=(e,t)=>new Ie({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class en{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;const n={};this.opts=n,t.gc||(n.gc=!1),t.autoLoad&&(n.autoLoad=!0),t.meta!==null&&(n.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new en(_i(this.doc.guid,this.opts))}splice(t){throw Ot()}mergeWith(t){return!1}integrate(t,n){this.doc._item=n,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,n){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}}const sc=e=>new en(_i(e.readString(),e.readAny()));class ge{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new ge(this.embed)}splice(t){throw Ot()}mergeWith(t){return!1}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeJSON(this.embed)}getRef(){return 5}}const ic=e=>new ge(e.readJSON());class ct{constructor(t,n){this.key=t,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new ct(this.key,this.value)}splice(t){throw Ot()}mergeWith(t){return!1}integrate(t,n){const s=n.parent;s._searchMarker=null,s._hasFormatting=!0}delete(t){}gc(t){}write(t,n){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}}const oc=e=>new ct(e.readKey(),e.readJSON());class bn{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new bn(this.arr)}splice(t){const n=new bn(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){const s=this.arr.length;t.writeLen(s-n);for(let o=n;o<s;o++){const i=this.arr[o];t.writeString(i===void 0?"undefined":JSON.stringify(i))}}getRef(){return 2}}const lc=e=>{const t=e.readLen(),n=[];for(let s=0;s<t;s++){const o=e.readString();o==="undefined"?n.push(void 0):n.push(JSON.parse(o))}return new bn(n)},cc=He("node_env")==="development";class de{constructor(t){this.arr=t,cc&&Ds(t)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new de(this.arr)}splice(t){const n=new de(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){const s=this.arr.length;t.writeLen(s-n);for(let o=n;o<s;o++){const i=this.arr[o];t.writeAny(i)}}getRef(){return 8}}const ac=e=>{const t=e.readLen(),n=[];for(let s=0;s<t;s++)n.push(e.readAny());return new de(n)};class Bt{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new Bt(this.str)}splice(t){const n=new Bt(this.str.slice(t));this.str=this.str.slice(0,t);const s=this.str.charCodeAt(t-1);return s>=55296&&s<=56319&&(this.str=this.str.slice(0,t-1)+"",n.str=""+n.str.slice(1)),n}mergeWith(t){return this.str+=t.str,!0}integrate(t,n){}delete(t){}gc(t){}write(t,n){t.writeString(n===0?this.str:this.str.slice(n))}getRef(){return 4}}const uc=e=>new Bt(e.readString()),hc=[Vl,ql,Jl,Xl,Kl,Ql,tc],dc=0,fc=1,gc=2,pc=3,mc=4,yc=5,wc=6;class Ht{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new Ht(this.type._copy())}splice(t){throw Ot()}mergeWith(t){return!1}integrate(t,n){this.type._integrate(t.doc,n)}delete(t){let n=this.type._start;for(;n!==null;)n.deleted?n.id.clock<(t.beforeState.get(n.id.client)||0)&&t._mergeStructs.push(n):n.delete(t),n=n.right;this.type._map.forEach(s=>{s.deleted?s.id.clock<(t.beforeState.get(s.id.client)||0)&&t._mergeStructs.push(s):s.delete(t)}),t.changed.delete(this.type)}gc(t){let n=this.type._start;for(;n!==null;)n.gc(t,!0),n=n.right;this.type._start=null,this.type._map.forEach(s=>{for(;s!==null;)s.gc(t,!0),s=s.left}),this.type._map=new Map}write(t,n){this.type._write(t)}getRef(){return 7}}const bc=e=>new Ht(hc[e.readTypeRef()](e)),_n=(e,t,n)=>{const{client:s,clock:o}=t.id,i=new lt(X(s,o+n),t,X(s,o+n-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(n));return t.deleted&&i.markDeleted(),t.keep&&(i.keep=!0),t.redone!==null&&(i.redone=X(t.redone.client,t.redone.clock+n)),t.right=i,i.right!==null&&(i.right.left=i),e._mergeStructs.push(i),i.parentSub!==null&&i.right===null&&i.parent._map.set(i.parentSub,i),t.length=n,i};class lt extends Tr{constructor(t,n,s,o,i,u,a,c){super(t,c.getLength()),this.origin=s,this.left=n,this.right=o,this.rightOrigin=i,this.parent=u,this.parentSub=a,this.redone=null,this.content=c,this.info=this.content.isCountable()?Ur:0}set marker(t){(this.info&Un)>0!==t&&(this.info^=Un)}get marker(){return(this.info&Un)>0}get keep(){return(this.info&Nr)>0}set keep(t){this.keep!==t&&(this.info^=Nr)}get countable(){return(this.info&Ur)>0}get deleted(){return(this.info&Nn)>0}set deleted(t){this.deleted!==t&&(this.info^=Nn)}markDeleted(){this.info|=Nn}getMissing(t,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=dt(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=dt(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===_e&&this.id.client!==this.parent.client&&this.parent.clock>=dt(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=ts(t,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=ee(t,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===St||this.right&&this.right.constructor===St)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===lt?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===lt&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===_e){const s=zn(n,this.parent);s.constructor===St?this.parent=null:this.parent=s.content.type}return null}integrate(t,n){if(n>0&&(this.id.clock+=n,this.left=ts(t,t.doc.store,X(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let s=this.left,o;if(s!==null)o=s.right;else if(this.parentSub!==null)for(o=this.parent._map.get(this.parentSub)||null;o!==null&&o.left!==null;)o=o.left;else o=this.parent._start;const i=new Set,u=new Set;for(;o!==null&&o!==this.right;){if(u.add(o),i.add(o),rn(this.origin,o.origin)){if(o.id.client<this.id.client)s=o,i.clear();else if(rn(this.rightOrigin,o.rightOrigin))break}else if(o.origin!==null&&u.has(zn(t.doc.store,o.origin)))i.has(zn(t.doc.store,o.origin))||(s=o,i.clear());else break;o=o.right}this.left=s}if(this.left!==null){const s=this.left.right;this.right=s,this.left.right=this}else{let s;if(this.parentSub!==null)for(s=this.parent._map.get(this.parentSub)||null;s!==null&&s.left!==null;)s=s.left;else s=this.parent._start,this.parent._start=this;this.right=s}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),ei(t.doc.store,this),this.content.integrate(t,this),ns(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new St(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:X(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&rn(t.origin,this.lastId)&&this.right===t&&rn(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){const n=this.parent._searchMarker;return n&&n.forEach(s=>{s.p===t&&(s.p=this,!this.deleted&&this.countable&&(s.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){const n=this.parent;this.countable&&this.parentSub===null&&(n._length-=this.length),this.markDeleted(),fn(t.deleteSet,this.id.client,this.id.clock,this.length),ns(t,n,this.parentSub),this.content.delete(t)}}gc(t,n){if(!this.deleted)throw Ut();this.content.gc(t),n?El(t,this,new St(this.id,this.length)):this.content=new Je(this.length)}write(t,n){const s=n>0?X(this.id.client,this.id.clock+n-1):this.origin,o=this.rightOrigin,i=this.parentSub,u=this.content.getRef()&kn|(s===null?0:_t)|(o===null?0:zt)|(i===null?0:$e);if(t.writeInfo(u),s!==null&&t.writeLeftID(s),o!==null&&t.writeRightID(o),s===null&&o===null){const a=this.parent;if(a._item!==void 0){const c=a._item;if(c===null){const p=Sl(a);t.writeParentInfo(!0),t.writeString(p)}else t.writeParentInfo(!1),t.writeLeftID(c.id)}else a.constructor===String?(t.writeParentInfo(!0),t.writeString(a)):a.constructor===_e?(t.writeParentInfo(!1),t.writeLeftID(a)):Ut();i!==null&&t.writeString(i)}this.content.write(t,n)}}const vi=(e,t)=>_c[t&kn](e),_c=[()=>{Ut()},rc,lc,nc,uc,ic,oc,bc,ac,sc,()=>{Ut()}],vc=10;class Ct extends Tr{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,n){Ut()}write(t,n){t.writeInfo(vc),V(t.restEncoder,this.length-n)}getMissing(t,n){return null}}const Si=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},Ci="__ $YJS$ __";Si[Ci]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");Si[Ci]=!0;const Sc=1200,Cc=2500,vn=3e4,rr=e=>{if(e.shouldConnect&&e.ws===null){const t=new WebSocket(e.url),n=e.binaryType;let s=null;n&&(t.binaryType=n),e.ws=t,e.connecting=!0,e.connected=!1,t.onmessage=u=>{e.lastMessageReceived=qt();const a=u.data,c=typeof a=="string"?JSON.parse(a):a;c&&c.type==="pong"&&(clearTimeout(s),s=setTimeout(i,vn/2)),e.emit("message",[c,e])};const o=u=>{e.ws!==null&&(e.ws=null,e.connecting=!1,e.connected?(e.connected=!1,e.emit("disconnect",[{type:"disconnect",error:u},e])):e.unsuccessfulReconnects++,setTimeout(rr,cr(Wi(e.unsuccessfulReconnects+1)*Sc,Cc),e)),clearTimeout(s)},i=()=>{e.ws===t&&e.send({type:"ping"})};t.onclose=()=>o(null),t.onerror=u=>o(u),t.onopen=()=>{e.lastMessageReceived=qt(),e.connecting=!1,e.connected=!0,e.unsuccessfulReconnects=0,e.emit("connect",[{type:"connect"},e]),s=setTimeout(i,vn/2)}}};class Ec extends ws{constructor(t,{binaryType:n}={}){super(),this.url=t,this.ws=null,this.binaryType=n||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&vn<qt()-this.lastMessageReceived&&this.ws.close()},vn/2),rr(this)}send(t){this.ws&&this.ws.send(JSON.stringify(t))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&rr(this)}}const Ei=new Map;class kc{constructor(t){this.room=t,this.onmessage=null,this._onChange=n=>n.key===t&&this.onmessage!==null&&this.onmessage({data:Ms(n.newValue||"")}),Ro(this._onChange)}postMessage(t){Rs.setItem(this.room,Os(zo(t)))}close(){To(this._onChange)}}const Rc=typeof BroadcastChannel>"u"?kc:BroadcastChannel,Ar=e=>vt(Ei,e,()=>{const t=te(),n=new Rc(e);return n.onmessage=s=>t.forEach(o=>o(s.data,"broadcastchannel")),{bc:n,subs:t}}),Tc=(e,t)=>(Ar(e).subs.add(t),t),Ac=(e,t)=>{const n=Ar(e),s=n.subs.delete(t);return s&&n.subs.size===0&&(n.bc.close(),Ei.delete(e)),s},Dc=(e,t,n=null)=>{const s=Ar(e);s.bc.postMessage(t),s.subs.forEach(o=>o(t,n))},xc=()=>{let e=!0;return(t,n)=>{if(e){e=!1;try{t()}finally{e=!0}}else n!==void 0&&n()}};var xt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Lc(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ln(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ki={exports:{}};(function(e,t){(function(n){e.exports=n()})(function(){var n=Math.floor,s=Math.abs,o=Math.pow;return function(){function i(u,a,c){function p(f,m){if(!a[f]){if(!u[f]){var g=typeof ln=="function"&&ln;if(!m&&g)return g(f,!0);if(b)return b(f,!0);var S=new Error("Cannot find module '"+f+"'");throw S.code="MODULE_NOT_FOUND",S}var M=a[f]={exports:{}};u[f][0].call(M.exports,function(L){var N=u[f][1][L];return p(N||L)},M,M.exports,i,u,a,c)}return a[f].exports}for(var b=typeof ln=="function"&&ln,h=0;h<c.length;h++)p(c[h]);return p}return i}()({1:[function(i,u,a){function c(_){var v=_.length;if(0<v%4)throw new Error("Invalid string. Length must be a multiple of 4");var T=_.indexOf("=");T===-1&&(T=v);var E=T===v?0:4-T%4;return[T,E]}function p(_,v,T){return 3*(v+T)/4-T}function b(_){var v,T,E=c(_),x=E[0],U=E[1],k=new M(p(_,x,U)),A=0,F=0<U?x-4:x;for(T=0;T<F;T+=4)v=S[_.charCodeAt(T)]<<18|S[_.charCodeAt(T+1)]<<12|S[_.charCodeAt(T+2)]<<6|S[_.charCodeAt(T+3)],k[A++]=255&v>>16,k[A++]=255&v>>8,k[A++]=255&v;return U===2&&(v=S[_.charCodeAt(T)]<<2|S[_.charCodeAt(T+1)]>>4,k[A++]=255&v),U===1&&(v=S[_.charCodeAt(T)]<<10|S[_.charCodeAt(T+1)]<<4|S[_.charCodeAt(T+2)]>>2,k[A++]=255&v>>8,k[A++]=255&v),k}function h(_){return g[63&_>>18]+g[63&_>>12]+g[63&_>>6]+g[63&_]}function f(_,v,T){for(var E,x=[],U=v;U<T;U+=3)E=(16711680&_[U]<<16)+(65280&_[U+1]<<8)+(255&_[U+2]),x.push(h(E));return x.join("")}function m(_){for(var v,T=_.length,E=T%3,x=[],U=16383,k=0,A=T-E;k<A;k+=U)x.push(f(_,k,k+U>A?A:k+U));return E===1?(v=_[T-1],x.push(g[v>>2]+g[63&v<<4]+"==")):E===2&&(v=(_[T-2]<<8)+_[T-1],x.push(g[v>>10]+g[63&v>>4]+g[63&v<<2]+"=")),x.join("")}a.byteLength=function(_){var v=c(_),T=v[0],E=v[1];return 3*(T+E)/4-E},a.toByteArray=b,a.fromByteArray=m;for(var g=[],S=[],M=typeof Uint8Array>"u"?Array:Uint8Array,L="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",N=0,y=L.length;N<y;++N)g[N]=L[N],S[L.charCodeAt(N)]=N;S[45]=62,S[95]=63},{}],2:[function(){},{}],3:[function(i,u,a){(function(){(function(){var c=String.fromCharCode,p=Math.min;function b(r){if(2147483647<r)throw new RangeError('The value "'+r+'" is invalid for option "size"');var l=new Uint8Array(r);return l.__proto__=h.prototype,l}function h(r,l,d){if(typeof r=="number"){if(typeof l=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return S(r)}return f(r,l,d)}function f(r,l,d){if(typeof r=="string")return M(r,l);if(ArrayBuffer.isView(r))return L(r);if(r==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(D(r,ArrayBuffer)||r&&D(r.buffer,ArrayBuffer))return N(r,l,d);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var C=r.valueOf&&r.valueOf();if(C!=null&&C!==r)return h.from(C,l,d);var R=y(r);if(R)return R;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return h.from(r[Symbol.toPrimitive]("string"),l,d);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}function m(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(0>r)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function g(r,l,d){return m(r),0>=r||l===void 0?b(r):typeof d=="string"?b(r).fill(l,d):b(r).fill(l)}function S(r){return m(r),b(0>r?0:0|_(r))}function M(r,l){if((typeof l!="string"||l==="")&&(l="utf8"),!h.isEncoding(l))throw new TypeError("Unknown encoding: "+l);var d=0|v(r,l),C=b(d),R=C.write(r,l);return R!==d&&(C=C.slice(0,R)),C}function L(r){for(var l=0>r.length?0:0|_(r.length),d=b(l),C=0;C<l;C+=1)d[C]=255&r[C];return d}function N(r,l,d){if(0>l||r.byteLength<l)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<l+(d||0))throw new RangeError('"length" is outside of buffer bounds');var C;return C=l===void 0&&d===void 0?new Uint8Array(r):d===void 0?new Uint8Array(r,l):new Uint8Array(r,l,d),C.__proto__=h.prototype,C}function y(r){if(h.isBuffer(r)){var l=0|_(r.length),d=b(l);return d.length===0||r.copy(d,0,0,l),d}return r.length===void 0?r.type==="Buffer"&&Array.isArray(r.data)?L(r.data):void 0:typeof r.length!="number"||I(r.length)?b(0):L(r)}function _(r){if(r>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|r}function v(r,l){if(h.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||D(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);var d=r.length,C=2<arguments.length&&arguments[2]===!0;if(!C&&d===0)return 0;for(var R=!1;;)switch(l){case"ascii":case"latin1":case"binary":return d;case"utf8":case"utf-8":return re(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*d;case"hex":return d>>>1;case"base64":return Tt(r).length;default:if(R)return C?-1:re(r).length;l=(""+l).toLowerCase(),R=!0}}function T(r,l,d){var C=!1;if((l===void 0||0>l)&&(l=0),l>this.length||((d===void 0||d>this.length)&&(d=this.length),0>=d)||(d>>>=0,l>>>=0,d<=l))return"";for(r||(r="utf8");;)switch(r){case"hex":return kt(this,l,d);case"utf8":case"utf-8":return ot(this,l,d);case"ascii":return q(this,l,d);case"latin1":case"binary":return pe(this,l,d);case"base64":return Z(this,l,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Yt(this,l,d);default:if(C)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),C=!0}}function E(r,l,d){var C=r[l];r[l]=r[d],r[d]=C}function x(r,l,d,C,R){if(r.length===0)return-1;if(typeof d=="string"?(C=d,d=0):2147483647<d?d=2147483647:-2147483648>d&&(d=-2147483648),d=+d,I(d)&&(d=R?0:r.length-1),0>d&&(d=r.length+d),d>=r.length){if(R)return-1;d=r.length-1}else if(0>d)if(R)d=0;else return-1;if(typeof l=="string"&&(l=h.from(l,C)),h.isBuffer(l))return l.length===0?-1:U(r,l,d,C,R);if(typeof l=="number")return l&=255,typeof Uint8Array.prototype.indexOf=="function"?R?Uint8Array.prototype.indexOf.call(r,l,d):Uint8Array.prototype.lastIndexOf.call(r,l,d):U(r,[l],d,C,R);throw new TypeError("val must be string, number or Buffer")}function U(r,l,d,C,R){function O(me,Ue){return P===1?me[Ue]:me.readUInt16BE(Ue*P)}var P=1,J=r.length,et=l.length;if(C!==void 0&&(C=(C+"").toLowerCase(),C==="ucs2"||C==="ucs-2"||C==="utf16le"||C==="utf-16le")){if(2>r.length||2>l.length)return-1;P=2,J/=2,et/=2,d/=2}var K;if(R){var G=-1;for(K=d;K<J;K++)if(O(r,K)!==O(l,G===-1?0:K-G))G!==-1&&(K-=K-G),G=-1;else if(G===-1&&(G=K),K-G+1===et)return G*P}else for(d+et>J&&(d=J-et),K=d;0<=K;K--){for(var ft=!0,se=0;se<et;se++)if(O(r,K+se)!==O(l,se)){ft=!1;break}if(ft)return K}return-1}function k(r,l,d,C){d=+d||0;var R=r.length-d;C?(C=+C,C>R&&(C=R)):C=R;var O=l.length;C>O/2&&(C=O/2);for(var P,J=0;J<C;++J){if(P=parseInt(l.substr(2*J,2),16),I(P))return J;r[d+J]=P}return J}function A(r,l,d,C){return At(re(l,r.length-d),r,d,C)}function F(r,l,d,C){return At(Ne(l),r,d,C)}function j(r,l,d,C){return F(r,l,d,C)}function W(r,l,d,C){return At(Tt(l),r,d,C)}function Y(r,l,d,C){return At(Kt(l,r.length-d),r,d,C)}function Z(r,l,d){return l===0&&d===r.length?B.fromByteArray(r):B.fromByteArray(r.slice(l,d))}function ot(r,l,d){d=p(r.length,d);for(var C=[],R=l;R<d;){var O=r[R],P=null,J=239<O?4:223<O?3:191<O?2:1;if(R+J<=d){var et,K,G,ft;J===1?128>O&&(P=O):J===2?(et=r[R+1],(192&et)==128&&(ft=(31&O)<<6|63&et,127<ft&&(P=ft))):J===3?(et=r[R+1],K=r[R+2],(192&et)==128&&(192&K)==128&&(ft=(15&O)<<12|(63&et)<<6|63&K,2047<ft&&(55296>ft||57343<ft)&&(P=ft))):J===4&&(et=r[R+1],K=r[R+2],G=r[R+3],(192&et)==128&&(192&K)==128&&(192&G)==128&&(ft=(15&O)<<18|(63&et)<<12|(63&K)<<6|63&G,65535<ft&&1114112>ft&&(P=ft)))}P===null?(P=65533,J=1):65535<P&&(P-=65536,C.push(55296|1023&P>>>10),P=56320|1023&P),C.push(P),R+=J}return yt(C)}function yt(r){var l=r.length;if(l<=4096)return c.apply(String,r);for(var d="",C=0;C<l;)d+=c.apply(String,r.slice(C,C+=4096));return d}function q(r,l,d){var C="";d=p(r.length,d);for(var R=l;R<d;++R)C+=c(127&r[R]);return C}function pe(r,l,d){var C="";d=p(r.length,d);for(var R=l;R<d;++R)C+=c(r[R]);return C}function kt(r,l,d){var C=r.length;(!l||0>l)&&(l=0),(!d||0>d||d>C)&&(d=C);for(var R="",O=l;O<d;++O)R+=ne(r[O]);return R}function Yt(r,l,d){for(var C=r.slice(l,d),R="",O=0;O<C.length;O+=2)R+=c(C[O]+256*C[O+1]);return R}function rt(r,l,d){if(r%1!=0||0>r)throw new RangeError("offset is not uint");if(r+l>d)throw new RangeError("Trying to access beyond buffer length")}function Q(r,l,d,C,R,O){if(!h.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(l>R||l<O)throw new RangeError('"value" argument is out of bounds');if(d+C>r.length)throw new RangeError("Index out of range")}function Rt(r,l,d,C){if(d+C>r.length)throw new RangeError("Index out of range");if(0>d)throw new RangeError("Index out of range")}function Gt(r,l,d,C,R){return l=+l,d>>>=0,R||Rt(r,l,d,4),z.write(r,l,d,C,23,4),d+4}function Jt(r,l,d,C,R){return l=+l,d>>>=0,R||Rt(r,l,d,8),z.write(r,l,d,C,52,8),d+8}function Me(r){if(r=r.split("=")[0],r=r.trim().replace(w,""),2>r.length)return"";for(;r.length%4!=0;)r+="=";return r}function ne(r){return 16>r?"0"+r.toString(16):r.toString(16)}function re(r,l){l=l||1/0;for(var d,C=r.length,R=null,O=[],P=0;P<C;++P){if(d=r.charCodeAt(P),55295<d&&57344>d){if(!R){if(56319<d){-1<(l-=3)&&O.push(239,191,189);continue}else if(P+1===C){-1<(l-=3)&&O.push(239,191,189);continue}R=d;continue}if(56320>d){-1<(l-=3)&&O.push(239,191,189),R=d;continue}d=(R-55296<<10|d-56320)+65536}else R&&-1<(l-=3)&&O.push(239,191,189);if(R=null,128>d){if(0>(l-=1))break;O.push(d)}else if(2048>d){if(0>(l-=2))break;O.push(192|d>>6,128|63&d)}else if(65536>d){if(0>(l-=3))break;O.push(224|d>>12,128|63&d>>6,128|63&d)}else if(1114112>d){if(0>(l-=4))break;O.push(240|d>>18,128|63&d>>12,128|63&d>>6,128|63&d)}else throw new Error("Invalid code point")}return O}function Ne(r){for(var l=[],d=0;d<r.length;++d)l.push(255&r.charCodeAt(d));return l}function Kt(r,l){for(var d,C,R,O=[],P=0;P<r.length&&!(0>(l-=2));++P)d=r.charCodeAt(P),C=d>>8,R=d%256,O.push(R),O.push(C);return O}function Tt(r){return B.toByteArray(Me(r))}function At(r,l,d,C){for(var R=0;R<C&&!(R+d>=l.length||R>=r.length);++R)l[R+d]=r[R];return R}function D(r,l){return r instanceof l||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===l.name}function I(r){return r!==r}var B=i("base64-js"),z=i("ieee754");a.Buffer=h,a.SlowBuffer=function(r){return+r!=r&&(r=0),h.alloc(+r)},a.INSPECT_MAX_BYTES=50,a.kMaxLength=2147483647,h.TYPED_ARRAY_SUPPORT=function(){try{var r=new Uint8Array(1);return r.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},r.foo()===42}catch{return!1}}(),h.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){return h.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){return h.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol<"u"&&Symbol.species!=null&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),h.poolSize=8192,h.from=function(r,l,d){return f(r,l,d)},h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,h.alloc=function(r,l,d){return g(r,l,d)},h.allocUnsafe=function(r){return S(r)},h.allocUnsafeSlow=function(r){return S(r)},h.isBuffer=function(r){return r!=null&&r._isBuffer===!0&&r!==h.prototype},h.compare=function(r,l){if(D(r,Uint8Array)&&(r=h.from(r,r.offset,r.byteLength)),D(l,Uint8Array)&&(l=h.from(l,l.offset,l.byteLength)),!h.isBuffer(r)||!h.isBuffer(l))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(r===l)return 0;for(var d=r.length,C=l.length,R=0,O=p(d,C);R<O;++R)if(r[R]!==l[R]){d=r[R],C=l[R];break}return d<C?-1:C<d?1:0},h.isEncoding=function(r){switch((r+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(r,l){if(!Array.isArray(r))throw new TypeError('"list" argument must be an Array of Buffers');if(r.length===0)return h.alloc(0);var d;if(l===void 0)for(l=0,d=0;d<r.length;++d)l+=r[d].length;var C=h.allocUnsafe(l),R=0;for(d=0;d<r.length;++d){var O=r[d];if(D(O,Uint8Array)&&(O=h.from(O)),!h.isBuffer(O))throw new TypeError('"list" argument must be an Array of Buffers');O.copy(C,R),R+=O.length}return C},h.byteLength=v,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var r=this.length;if(r%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var l=0;l<r;l+=2)E(this,l,l+1);return this},h.prototype.swap32=function(){var r=this.length;if(r%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var l=0;l<r;l+=4)E(this,l,l+3),E(this,l+1,l+2);return this},h.prototype.swap64=function(){var r=this.length;if(r%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var l=0;l<r;l+=8)E(this,l,l+7),E(this,l+1,l+6),E(this,l+2,l+5),E(this,l+3,l+4);return this},h.prototype.toString=function(){var r=this.length;return r===0?"":arguments.length===0?ot(this,0,r):T.apply(this,arguments)},h.prototype.toLocaleString=h.prototype.toString,h.prototype.equals=function(r){if(!h.isBuffer(r))throw new TypeError("Argument must be a Buffer");return this===r||h.compare(this,r)===0},h.prototype.inspect=function(){var r="",l=a.INSPECT_MAX_BYTES;return r=this.toString("hex",0,l).replace(/(.{2})/g,"$1 ").trim(),this.length>l&&(r+=" ... "),"<Buffer "+r+">"},h.prototype.compare=function(r,l,d,C,R){if(D(r,Uint8Array)&&(r=h.from(r,r.offset,r.byteLength)),!h.isBuffer(r))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof r);if(l===void 0&&(l=0),d===void 0&&(d=r?r.length:0),C===void 0&&(C=0),R===void 0&&(R=this.length),0>l||d>r.length||0>C||R>this.length)throw new RangeError("out of range index");if(C>=R&&l>=d)return 0;if(C>=R)return-1;if(l>=d)return 1;if(l>>>=0,d>>>=0,C>>>=0,R>>>=0,this===r)return 0;for(var O=R-C,P=d-l,J=p(O,P),et=this.slice(C,R),K=r.slice(l,d),G=0;G<J;++G)if(et[G]!==K[G]){O=et[G],P=K[G];break}return O<P?-1:P<O?1:0},h.prototype.includes=function(r,l,d){return this.indexOf(r,l,d)!==-1},h.prototype.indexOf=function(r,l,d){return x(this,r,l,d,!0)},h.prototype.lastIndexOf=function(r,l,d){return x(this,r,l,d,!1)},h.prototype.write=function(r,l,d,C){if(l===void 0)C="utf8",d=this.length,l=0;else if(d===void 0&&typeof l=="string")C=l,d=this.length,l=0;else if(isFinite(l))l>>>=0,isFinite(d)?(d>>>=0,C===void 0&&(C="utf8")):(C=d,d=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var R=this.length-l;if((d===void 0||d>R)&&(d=R),0<r.length&&(0>d||0>l)||l>this.length)throw new RangeError("Attempt to write outside buffer bounds");C||(C="utf8");for(var O=!1;;)switch(C){case"hex":return k(this,r,l,d);case"utf8":case"utf-8":return A(this,r,l,d);case"ascii":return F(this,r,l,d);case"latin1":case"binary":return j(this,r,l,d);case"base64":return W(this,r,l,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,r,l,d);default:if(O)throw new TypeError("Unknown encoding: "+C);C=(""+C).toLowerCase(),O=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},h.prototype.slice=function(r,l){var d=this.length;r=~~r,l=l===void 0?d:~~l,0>r?(r+=d,0>r&&(r=0)):r>d&&(r=d),0>l?(l+=d,0>l&&(l=0)):l>d&&(l=d),l<r&&(l=r);var C=this.subarray(r,l);return C.__proto__=h.prototype,C},h.prototype.readUIntLE=function(r,l,d){r>>>=0,l>>>=0,d||rt(r,l,this.length);for(var C=this[r],R=1,O=0;++O<l&&(R*=256);)C+=this[r+O]*R;return C},h.prototype.readUIntBE=function(r,l,d){r>>>=0,l>>>=0,d||rt(r,l,this.length);for(var C=this[r+--l],R=1;0<l&&(R*=256);)C+=this[r+--l]*R;return C},h.prototype.readUInt8=function(r,l){return r>>>=0,l||rt(r,1,this.length),this[r]},h.prototype.readUInt16LE=function(r,l){return r>>>=0,l||rt(r,2,this.length),this[r]|this[r+1]<<8},h.prototype.readUInt16BE=function(r,l){return r>>>=0,l||rt(r,2,this.length),this[r]<<8|this[r+1]},h.prototype.readUInt32LE=function(r,l){return r>>>=0,l||rt(r,4,this.length),(this[r]|this[r+1]<<8|this[r+2]<<16)+16777216*this[r+3]},h.prototype.readUInt32BE=function(r,l){return r>>>=0,l||rt(r,4,this.length),16777216*this[r]+(this[r+1]<<16|this[r+2]<<8|this[r+3])},h.prototype.readIntLE=function(r,l,d){r>>>=0,l>>>=0,d||rt(r,l,this.length);for(var C=this[r],R=1,O=0;++O<l&&(R*=256);)C+=this[r+O]*R;return R*=128,C>=R&&(C-=o(2,8*l)),C},h.prototype.readIntBE=function(r,l,d){r>>>=0,l>>>=0,d||rt(r,l,this.length);for(var C=l,R=1,O=this[r+--C];0<C&&(R*=256);)O+=this[r+--C]*R;return R*=128,O>=R&&(O-=o(2,8*l)),O},h.prototype.readInt8=function(r,l){return r>>>=0,l||rt(r,1,this.length),128&this[r]?-1*(255-this[r]+1):this[r]},h.prototype.readInt16LE=function(r,l){r>>>=0,l||rt(r,2,this.length);var d=this[r]|this[r+1]<<8;return 32768&d?4294901760|d:d},h.prototype.readInt16BE=function(r,l){r>>>=0,l||rt(r,2,this.length);var d=this[r+1]|this[r]<<8;return 32768&d?4294901760|d:d},h.prototype.readInt32LE=function(r,l){return r>>>=0,l||rt(r,4,this.length),this[r]|this[r+1]<<8|this[r+2]<<16|this[r+3]<<24},h.prototype.readInt32BE=function(r,l){return r>>>=0,l||rt(r,4,this.length),this[r]<<24|this[r+1]<<16|this[r+2]<<8|this[r+3]},h.prototype.readFloatLE=function(r,l){return r>>>=0,l||rt(r,4,this.length),z.read(this,r,!0,23,4)},h.prototype.readFloatBE=function(r,l){return r>>>=0,l||rt(r,4,this.length),z.read(this,r,!1,23,4)},h.prototype.readDoubleLE=function(r,l){return r>>>=0,l||rt(r,8,this.length),z.read(this,r,!0,52,8)},h.prototype.readDoubleBE=function(r,l){return r>>>=0,l||rt(r,8,this.length),z.read(this,r,!1,52,8)},h.prototype.writeUIntLE=function(r,l,d,C){if(r=+r,l>>>=0,d>>>=0,!C){var R=o(2,8*d)-1;Q(this,r,l,d,R,0)}var O=1,P=0;for(this[l]=255&r;++P<d&&(O*=256);)this[l+P]=255&r/O;return l+d},h.prototype.writeUIntBE=function(r,l,d,C){if(r=+r,l>>>=0,d>>>=0,!C){var R=o(2,8*d)-1;Q(this,r,l,d,R,0)}var O=d-1,P=1;for(this[l+O]=255&r;0<=--O&&(P*=256);)this[l+O]=255&r/P;return l+d},h.prototype.writeUInt8=function(r,l,d){return r=+r,l>>>=0,d||Q(this,r,l,1,255,0),this[l]=255&r,l+1},h.prototype.writeUInt16LE=function(r,l,d){return r=+r,l>>>=0,d||Q(this,r,l,2,65535,0),this[l]=255&r,this[l+1]=r>>>8,l+2},h.prototype.writeUInt16BE=function(r,l,d){return r=+r,l>>>=0,d||Q(this,r,l,2,65535,0),this[l]=r>>>8,this[l+1]=255&r,l+2},h.prototype.writeUInt32LE=function(r,l,d){return r=+r,l>>>=0,d||Q(this,r,l,4,4294967295,0),this[l+3]=r>>>24,this[l+2]=r>>>16,this[l+1]=r>>>8,this[l]=255&r,l+4},h.prototype.writeUInt32BE=function(r,l,d){return r=+r,l>>>=0,d||Q(this,r,l,4,4294967295,0),this[l]=r>>>24,this[l+1]=r>>>16,this[l+2]=r>>>8,this[l+3]=255&r,l+4},h.prototype.writeIntLE=function(r,l,d,C){if(r=+r,l>>>=0,!C){var R=o(2,8*d-1);Q(this,r,l,d,R-1,-R)}var O=0,P=1,J=0;for(this[l]=255&r;++O<d&&(P*=256);)0>r&&J===0&&this[l+O-1]!==0&&(J=1),this[l+O]=255&(r/P>>0)-J;return l+d},h.prototype.writeIntBE=function(r,l,d,C){if(r=+r,l>>>=0,!C){var R=o(2,8*d-1);Q(this,r,l,d,R-1,-R)}var O=d-1,P=1,J=0;for(this[l+O]=255&r;0<=--O&&(P*=256);)0>r&&J===0&&this[l+O+1]!==0&&(J=1),this[l+O]=255&(r/P>>0)-J;return l+d},h.prototype.writeInt8=function(r,l,d){return r=+r,l>>>=0,d||Q(this,r,l,1,127,-128),0>r&&(r=255+r+1),this[l]=255&r,l+1},h.prototype.writeInt16LE=function(r,l,d){return r=+r,l>>>=0,d||Q(this,r,l,2,32767,-32768),this[l]=255&r,this[l+1]=r>>>8,l+2},h.prototype.writeInt16BE=function(r,l,d){return r=+r,l>>>=0,d||Q(this,r,l,2,32767,-32768),this[l]=r>>>8,this[l+1]=255&r,l+2},h.prototype.writeInt32LE=function(r,l,d){return r=+r,l>>>=0,d||Q(this,r,l,4,2147483647,-2147483648),this[l]=255&r,this[l+1]=r>>>8,this[l+2]=r>>>16,this[l+3]=r>>>24,l+4},h.prototype.writeInt32BE=function(r,l,d){return r=+r,l>>>=0,d||Q(this,r,l,4,2147483647,-2147483648),0>r&&(r=4294967295+r+1),this[l]=r>>>24,this[l+1]=r>>>16,this[l+2]=r>>>8,this[l+3]=255&r,l+4},h.prototype.writeFloatLE=function(r,l,d){return Gt(this,r,l,!0,d)},h.prototype.writeFloatBE=function(r,l,d){return Gt(this,r,l,!1,d)},h.prototype.writeDoubleLE=function(r,l,d){return Jt(this,r,l,!0,d)},h.prototype.writeDoubleBE=function(r,l,d){return Jt(this,r,l,!1,d)},h.prototype.copy=function(r,l,d,C){if(!h.isBuffer(r))throw new TypeError("argument should be a Buffer");if(d||(d=0),C||C===0||(C=this.length),l>=r.length&&(l=r.length),l||(l=0),0<C&&C<d&&(C=d),C===d||r.length===0||this.length===0)return 0;if(0>l)throw new RangeError("targetStart out of bounds");if(0>d||d>=this.length)throw new RangeError("Index out of range");if(0>C)throw new RangeError("sourceEnd out of bounds");C>this.length&&(C=this.length),r.length-l<C-d&&(C=r.length-l+d);var R=C-d;if(this===r&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(l,d,C);else if(this===r&&d<l&&l<C)for(var O=R-1;0<=O;--O)r[O+l]=this[O+d];else Uint8Array.prototype.set.call(r,this.subarray(d,C),l);return R},h.prototype.fill=function(r,l,d,C){if(typeof r=="string"){if(typeof l=="string"?(C=l,l=0,d=this.length):typeof d=="string"&&(C=d,d=this.length),C!==void 0&&typeof C!="string")throw new TypeError("encoding must be a string");if(typeof C=="string"&&!h.isEncoding(C))throw new TypeError("Unknown encoding: "+C);if(r.length===1){var R=r.charCodeAt(0);(C==="utf8"&&128>R||C==="latin1")&&(r=R)}}else typeof r=="number"&&(r&=255);if(0>l||this.length<l||this.length<d)throw new RangeError("Out of range index");if(d<=l)return this;l>>>=0,d=d===void 0?this.length:d>>>0,r||(r=0);var O;if(typeof r=="number")for(O=l;O<d;++O)this[O]=r;else{var P=h.isBuffer(r)?r:h.from(r,C),J=P.length;if(J===0)throw new TypeError('The value "'+r+'" is invalid for argument "value"');for(O=0;O<d-l;++O)this[O+l]=P[O%J]}return this};var w=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,i("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(i,u,a){(function(c){(function(){function p(){let h;try{h=a.storage.getItem("debug")}catch{}return!h&&typeof c<"u"&&"env"in c&&(h=c.env.DEBUG),h}a.formatArgs=function(h){if(h[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+h[0]+(this.useColors?"%c ":" ")+"+"+u.exports.humanize(this.diff),!this.useColors)return;const f="color: "+this.color;h.splice(1,0,f,"color: inherit");let m=0,g=0;h[0].replace(/%[a-zA-Z%]/g,S=>{S==="%%"||(m++,S==="%c"&&(g=m))}),h.splice(g,0,f)},a.save=function(h){try{h?a.storage.setItem("debug",h):a.storage.removeItem("debug")}catch{}},a.load=p,a.useColors=function(){return!!(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},a.storage=function(){try{return localStorage}catch{}}(),a.destroy=(()=>{let h=!1;return()=>{h||(h=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),a.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],a.log=console.debug||console.log||(()=>{}),u.exports=i("./common")(a);const{formatters:b}=u.exports;b.j=function(h){try{return JSON.stringify(h)}catch(f){return"[UnexpectedJSONParseError]: "+f.message}}}).call(this)}).call(this,i("_process"))},{"./common":5,_process:12}],5:[function(i,u){u.exports=function(a){function c(h){function f(...S){if(!f.enabled)return;const M=f,L=+new Date,N=L-(m||L);M.diff=N,M.prev=m,M.curr=L,m=L,S[0]=c.coerce(S[0]),typeof S[0]!="string"&&S.unshift("%O");let y=0;S[0]=S[0].replace(/%([a-zA-Z%])/g,(v,T)=>{if(v==="%%")return"%";y++;const E=c.formatters[T];if(typeof E=="function"){const x=S[y];v=E.call(M,x),S.splice(y,1),y--}return v}),c.formatArgs.call(M,S),(M.log||c.log).apply(M,S)}let m,g=null;return f.namespace=h,f.useColors=c.useColors(),f.color=c.selectColor(h),f.extend=p,f.destroy=c.destroy,Object.defineProperty(f,"enabled",{enumerable:!0,configurable:!1,get:()=>g===null?c.enabled(h):g,set:S=>{g=S}}),typeof c.init=="function"&&c.init(f),f}function p(h,f){const m=c(this.namespace+(typeof f>"u"?":":f)+h);return m.log=this.log,m}function b(h){return h.toString().substring(2,h.toString().length-2).replace(/\.\*\?$/,"*")}return c.debug=c,c.default=c,c.coerce=function(h){return h instanceof Error?h.stack||h.message:h},c.disable=function(){const h=[...c.names.map(b),...c.skips.map(b).map(f=>"-"+f)].join(",");return c.enable(""),h},c.enable=function(h){c.save(h),c.names=[],c.skips=[];let f;const m=(typeof h=="string"?h:"").split(/[\s,]+/),g=m.length;for(f=0;f<g;f++)m[f]&&(h=m[f].replace(/\*/g,".*?"),h[0]==="-"?c.skips.push(new RegExp("^"+h.substr(1)+"$")):c.names.push(new RegExp("^"+h+"$")))},c.enabled=function(h){if(h[h.length-1]==="*")return!0;let f,m;for(f=0,m=c.skips.length;f<m;f++)if(c.skips[f].test(h))return!1;for(f=0,m=c.names.length;f<m;f++)if(c.names[f].test(h))return!0;return!1},c.humanize=i("ms"),c.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(a).forEach(h=>{c[h]=a[h]}),c.names=[],c.skips=[],c.formatters={},c.selectColor=function(h){let f=0;for(let m=0;m<h.length;m++)f=(f<<5)-f+h.charCodeAt(m),f|=0;return c.colors[s(f)%c.colors.length]},c.enable(c.load()),c}},{ms:11}],6:[function(i,u){function a(c,p){for(const b in p)Object.defineProperty(c,b,{value:p[b],enumerable:!0,configurable:!0});return c}u.exports=function(c,p,b){if(!c||typeof c=="string")throw new TypeError("Please pass an Error to err-code");b||(b={}),typeof p=="object"&&(b=p,p=""),p&&(b.code=p);try{return a(c,b)}catch{b.message=c.message,b.stack=c.stack;const f=function(){};return f.prototype=Object.create(Object.getPrototypeOf(c)),a(new f,b)}}},{}],7:[function(i,u){function a(k){console&&console.warn&&console.warn(k)}function c(){c.init.call(this)}function p(k){if(typeof k!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof k)}function b(k){return k._maxListeners===void 0?c.defaultMaxListeners:k._maxListeners}function h(k,A,F,j){var W,Y,Z;if(p(F),Y=k._events,Y===void 0?(Y=k._events=Object.create(null),k._eventsCount=0):(Y.newListener!==void 0&&(k.emit("newListener",A,F.listener?F.listener:F),Y=k._events),Z=Y[A]),Z===void 0)Z=Y[A]=F,++k._eventsCount;else if(typeof Z=="function"?Z=Y[A]=j?[F,Z]:[Z,F]:j?Z.unshift(F):Z.push(F),W=b(k),0<W&&Z.length>W&&!Z.warned){Z.warned=!0;var ot=new Error("Possible EventEmitter memory leak detected. "+Z.length+" "+(A+" listeners added. Use emitter.setMaxListeners() to increase limit"));ot.name="MaxListenersExceededWarning",ot.emitter=k,ot.type=A,ot.count=Z.length,a(ot)}return k}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function m(k,A,F){var j={fired:!1,wrapFn:void 0,target:k,type:A,listener:F},W=f.bind(j);return W.listener=F,j.wrapFn=W,W}function g(k,A,F){var j=k._events;if(j===void 0)return[];var W=j[A];return W===void 0?[]:typeof W=="function"?F?[W.listener||W]:[W]:F?N(W):M(W,W.length)}function S(k){var A=this._events;if(A!==void 0){var F=A[k];if(typeof F=="function")return 1;if(F!==void 0)return F.length}return 0}function M(k,A){for(var F=Array(A),j=0;j<A;++j)F[j]=k[j];return F}function L(k,A){for(;A+1<k.length;A++)k[A]=k[A+1];k.pop()}function N(k){for(var A=Array(k.length),F=0;F<A.length;++F)A[F]=k[F].listener||k[F];return A}function y(k,A,F){typeof k.on=="function"&&_(k,"error",A,F)}function _(k,A,F,j){if(typeof k.on=="function")j.once?k.once(A,F):k.on(A,F);else if(typeof k.addEventListener=="function")k.addEventListener(A,function W(Y){j.once&&k.removeEventListener(A,W),F(Y)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof k)}var v,T=typeof Reflect=="object"?Reflect:null,E=T&&typeof T.apply=="function"?T.apply:function(k,A,F){return Function.prototype.apply.call(k,A,F)};v=T&&typeof T.ownKeys=="function"?T.ownKeys:Object.getOwnPropertySymbols?function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))}:function(k){return Object.getOwnPropertyNames(k)};var x=Number.isNaN||function(k){return k!==k};u.exports=c,u.exports.once=function(k,A){return new Promise(function(F,j){function W(Z){k.removeListener(A,Y),j(Z)}function Y(){typeof k.removeListener=="function"&&k.removeListener("error",W),F([].slice.call(arguments))}_(k,A,Y,{once:!0}),A!=="error"&&y(k,W,{once:!0})})},c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var U=10;Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return U},set:function(k){if(typeof k!="number"||0>k||x(k))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+k+".");U=k}}),c.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(k){if(typeof k!="number"||0>k||x(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this},c.prototype.getMaxListeners=function(){return b(this)},c.prototype.emit=function(k){for(var A=[],F=1;F<arguments.length;F++)A.push(arguments[F]);var j=k==="error",W=this._events;if(W!==void 0)j=j&&W.error===void 0;else if(!j)return!1;if(j){var Y;if(0<A.length&&(Y=A[0]),Y instanceof Error)throw Y;var Z=new Error("Unhandled error."+(Y?" ("+Y.message+")":""));throw Z.context=Y,Z}var ot=W[k];if(ot===void 0)return!1;if(typeof ot=="function")E(ot,this,A);else for(var yt=ot.length,q=M(ot,yt),F=0;F<yt;++F)E(q[F],this,A);return!0},c.prototype.addListener=function(k,A){return h(this,k,A,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(k,A){return h(this,k,A,!0)},c.prototype.once=function(k,A){return p(A),this.on(k,m(this,k,A)),this},c.prototype.prependOnceListener=function(k,A){return p(A),this.prependListener(k,m(this,k,A)),this},c.prototype.removeListener=function(k,A){var F,j,W,Y,Z;if(p(A),j=this._events,j===void 0)return this;if(F=j[k],F===void 0)return this;if(F===A||F.listener===A)--this._eventsCount==0?this._events=Object.create(null):(delete j[k],j.removeListener&&this.emit("removeListener",k,F.listener||A));else if(typeof F!="function"){for(W=-1,Y=F.length-1;0<=Y;Y--)if(F[Y]===A||F[Y].listener===A){Z=F[Y].listener,W=Y;break}if(0>W)return this;W===0?F.shift():L(F,W),F.length===1&&(j[k]=F[0]),j.removeListener!==void 0&&this.emit("removeListener",k,Z||A)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(k){var A,F,j;if(F=this._events,F===void 0)return this;if(F.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):F[k]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete F[k]),this;if(arguments.length===0){var W,Y=Object.keys(F);for(j=0;j<Y.length;++j)W=Y[j],W!=="removeListener"&&this.removeAllListeners(W);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(A=F[k],typeof A=="function")this.removeListener(k,A);else if(A!==void 0)for(j=A.length-1;0<=j;j--)this.removeListener(k,A[j]);return this},c.prototype.listeners=function(k){return g(this,k,!0)},c.prototype.rawListeners=function(k){return g(this,k,!1)},c.listenerCount=function(k,A){return typeof k.listenerCount=="function"?k.listenerCount(A):S.call(k,A)},c.prototype.listenerCount=S,c.prototype.eventNames=function(){return 0<this._eventsCount?v(this._events):[]}},{}],8:[function(i,u){u.exports=function(){if(typeof globalThis>"u")return null;var a={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return a.RTCPeerConnection?a:null}},{}],9:[function(i,u,a){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */a.read=function(c,p,b,h,f){var m,g,S=8*f-h-1,M=(1<<S)-1,L=M>>1,N=-7,y=b?f-1:0,_=b?-1:1,v=c[p+y];for(y+=_,m=v&(1<<-N)-1,v>>=-N,N+=S;0<N;m=256*m+c[p+y],y+=_,N-=8);for(g=m&(1<<-N)-1,m>>=-N,N+=h;0<N;g=256*g+c[p+y],y+=_,N-=8);if(m===0)m=1-L;else{if(m===M)return g?NaN:(v?-1:1)*(1/0);g+=o(2,h),m-=L}return(v?-1:1)*g*o(2,m-h)},a.write=function(c,p,b,h,f,m){var g,S,M,L=Math.LN2,N=Math.log,y=8*m-f-1,_=(1<<y)-1,v=_>>1,T=f===23?o(2,-24)-o(2,-77):0,E=h?0:m-1,x=h?1:-1,U=0>p||p===0&&0>1/p?1:0;for(p=s(p),isNaN(p)||p===1/0?(S=isNaN(p)?1:0,g=_):(g=n(N(p)/L),1>p*(M=o(2,-g))&&(g--,M*=2),p+=1<=g+v?T/M:T*o(2,1-v),2<=p*M&&(g++,M/=2),g+v>=_?(S=0,g=_):1<=g+v?(S=(p*M-1)*o(2,f),g+=v):(S=p*o(2,v-1)*o(2,f),g=0));8<=f;c[b+E]=255&S,E+=x,S/=256,f-=8);for(g=g<<f|S,y+=f;0<y;c[b+E]=255&g,E+=x,g/=256,y-=8);c[b+E-x]|=128*U}},{}],10:[function(i,u){u.exports=typeof Object.create=="function"?function(a,c){c&&(a.super_=c,a.prototype=Object.create(c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}))}:function(a,c){if(c){a.super_=c;var p=function(){};p.prototype=c.prototype,a.prototype=new p,a.prototype.constructor=a}}},{}],11:[function(i,u){var a=Math.round;function c(f){if(f+="",!(100<f.length)){var m=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(f);if(m){var g=parseFloat(m[1]),S=(m[2]||"ms").toLowerCase();return S==="years"||S==="year"||S==="yrs"||S==="yr"||S==="y"?315576e5*g:S==="weeks"||S==="week"||S==="w"?6048e5*g:S==="days"||S==="day"||S==="d"?864e5*g:S==="hours"||S==="hour"||S==="hrs"||S==="hr"||S==="h"?36e5*g:S==="minutes"||S==="minute"||S==="mins"||S==="min"||S==="m"?6e4*g:S==="seconds"||S==="second"||S==="secs"||S==="sec"||S==="s"?1e3*g:S==="milliseconds"||S==="millisecond"||S==="msecs"||S==="msec"||S==="ms"?g:void 0}}}function p(f){var m=s(f);return 864e5<=m?a(f/864e5)+"d":36e5<=m?a(f/36e5)+"h":6e4<=m?a(f/6e4)+"m":1e3<=m?a(f/1e3)+"s":f+"ms"}function b(f){var m=s(f);return 864e5<=m?h(f,m,864e5,"day"):36e5<=m?h(f,m,36e5,"hour"):6e4<=m?h(f,m,6e4,"minute"):1e3<=m?h(f,m,1e3,"second"):f+" ms"}function h(f,m,g,S){return a(f/g)+" "+S+(m>=1.5*g?"s":"")}u.exports=function(f,m){m=m||{};var g=typeof f;if(g=="string"&&0<f.length)return c(f);if(g==="number"&&isFinite(f))return m.long?b(f):p(f);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(f))}},{}],12:[function(i,u){function a(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function p(T){if(S===setTimeout)return setTimeout(T,0);if((S===a||!S)&&setTimeout)return S=setTimeout,setTimeout(T,0);try{return S(T,0)}catch{try{return S.call(null,T,0)}catch{return S.call(this,T,0)}}}function b(T){if(M===clearTimeout)return clearTimeout(T);if((M===c||!M)&&clearTimeout)return M=clearTimeout,clearTimeout(T);try{return M(T)}catch{try{return M.call(null,T)}catch{return M.call(this,T)}}}function h(){_&&N&&(_=!1,N.length?y=N.concat(y):v=-1,y.length&&f())}function f(){if(!_){var T=p(h);_=!0;for(var E=y.length;E;){for(N=y,y=[];++v<E;)N&&N[v].run();v=-1,E=y.length}N=null,_=!1,b(T)}}function m(T,E){this.fun=T,this.array=E}function g(){}var S,M,L=u.exports={};(function(){try{S=typeof setTimeout=="function"?setTimeout:a}catch{S=a}try{M=typeof clearTimeout=="function"?clearTimeout:c}catch{M=c}})();var N,y=[],_=!1,v=-1;L.nextTick=function(T){var E=Array(arguments.length-1);if(1<arguments.length)for(var x=1;x<arguments.length;x++)E[x-1]=arguments[x];y.push(new m(T,E)),y.length!==1||_||p(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},L.title="browser",L.browser=!0,L.env={},L.argv=[],L.version="",L.versions={},L.on=g,L.addListener=g,L.once=g,L.off=g,L.removeListener=g,L.removeAllListeners=g,L.emit=g,L.prependListener=g,L.prependOnceListener=g,L.listeners=function(){return[]},L.binding=function(){throw new Error("process.binding is not supported")},L.cwd=function(){return"/"},L.chdir=function(){throw new Error("process.chdir is not supported")},L.umask=function(){return 0}},{}],13:[function(i,u){(function(a){(function(){/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let c;u.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window>"u"?a:window):p=>(c||(c=Promise.resolve())).then(p).catch(b=>setTimeout(()=>{throw b},0))}).call(this)}).call(this,typeof xt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:xt)},{}],14:[function(i,u){(function(a,c){(function(){var p=i("safe-buffer").Buffer,b=c.crypto||c.msCrypto;u.exports=b&&b.getRandomValues?function(h,f){if(h>4294967295)throw new RangeError("requested too many random bytes");var m=p.allocUnsafe(h);if(0<h)if(65536<h)for(var g=0;g<h;g+=65536)b.getRandomValues(m.slice(g,g+65536));else b.getRandomValues(m);return typeof f=="function"?a.nextTick(function(){f(null,m)}):m}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,i("_process"),typeof xt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:xt)},{_process:12,"safe-buffer":30}],15:[function(i,u){function a(g,S){g.prototype=Object.create(S.prototype),g.prototype.constructor=g,g.__proto__=S}function c(g,S,M){function L(y,_,v){return typeof S=="string"?S:S(y,_,v)}M||(M=Error);var N=function(y){function _(v,T,E){return y.call(this,L(v,T,E))||this}return a(_,y),_}(M);N.prototype.name=M.name,N.prototype.code=g,m[g]=N}function p(g,S){if(Array.isArray(g)){var M=g.length;return g=g.map(function(L){return L+""}),2<M?"one of ".concat(S," ").concat(g.slice(0,M-1).join(", "),", or ")+g[M-1]:M===2?"one of ".concat(S," ").concat(g[0]," or ").concat(g[1]):"of ".concat(S," ").concat(g[0])}return"of ".concat(S," ").concat(g+"")}function b(g,S,M){return g.substr(!M||0>M?0:+M,S.length)===S}function h(g,S,M){return(M===void 0||M>g.length)&&(M=g.length),g.substring(M-S.length,M)===S}function f(g,S,M){return typeof M!="number"&&(M=0),!(M+S.length>g.length)&&g.indexOf(S,M)!==-1}var m={};c("ERR_INVALID_OPT_VALUE",function(g,S){return'The value "'+S+'" is invalid for option "'+g+'"'},TypeError),c("ERR_INVALID_ARG_TYPE",function(g,S,M){var L;typeof S=="string"&&b(S,"not ")?(L="must not be",S=S.replace(/^not /,"")):L="must be";var N;if(h(g," argument"))N="The ".concat(g," ").concat(L," ").concat(p(S,"type"));else{var y=f(g,".")?"property":"argument";N='The "'.concat(g,'" ').concat(y," ").concat(L," ").concat(p(S,"type"))}return N+=". Received type ".concat(typeof M),N},TypeError),c("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),c("ERR_METHOD_NOT_IMPLEMENTED",function(g){return"The "+g+" method is not implemented"}),c("ERR_STREAM_PREMATURE_CLOSE","Premature close"),c("ERR_STREAM_DESTROYED",function(g){return"Cannot call "+g+" after a stream was destroyed"}),c("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),c("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),c("ERR_STREAM_WRITE_AFTER_END","write after end"),c("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),c("ERR_UNKNOWN_ENCODING",function(g){return"Unknown encoding: "+g},TypeError),c("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),u.exports.codes=m},{}],16:[function(i,u){(function(a){(function(){function c(L){return this instanceof c?(f.call(this,L),m.call(this,L),this.allowHalfOpen=!0,void(L&&(L.readable===!1&&(this.readable=!1),L.writable===!1&&(this.writable=!1),L.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",p))))):new c(L)}function p(){this._writableState.ended||a.nextTick(b,this)}function b(L){L.end()}var h=Object.keys||function(L){var N=[];for(var y in L)N.push(y);return N};u.exports=c;var f=i("./_stream_readable"),m=i("./_stream_writable");i("inherits")(c,f);for(var g,S=h(m.prototype),M=0;M<S.length;M++)g=S[M],c.prototype[g]||(c.prototype[g]=m.prototype[g]);Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(L){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=L,this._writableState.destroyed=L)}})}).call(this)}).call(this,i("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(i,u){function a(p){return this instanceof a?void c.call(this,p):new a(p)}u.exports=a;var c=i("./_stream_transform");i("inherits")(a,c),a.prototype._transform=function(p,b,h){h(null,p)}},{"./_stream_transform":19,inherits:10}],18:[function(i,u){(function(a,c){(function(){function p(w){return Yt.from(w)}function b(w){return Yt.isBuffer(w)||w instanceof rt}function h(w,r,l){return typeof w.prependListener=="function"?w.prependListener(r,l):void(w._events&&w._events[r]?Array.isArray(w._events[r])?w._events[r].unshift(l):w._events[r]=[l,w._events[r]]:w.on(r,l))}function f(w,r,l){yt=yt||i("./_stream_duplex"),w=w||{},typeof l!="boolean"&&(l=r instanceof yt),this.objectMode=!!w.objectMode,l&&(this.objectMode=this.objectMode||!!w.readableObjectMode),this.highWaterMark=Ne(this,w,"readableHighWaterMark",l),this.buffer=new Me,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=w.emitClose!==!1,this.autoDestroy=!!w.autoDestroy,this.destroyed=!1,this.defaultEncoding=w.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,w.encoding&&(!Rt&&(Rt=i("string_decoder/").StringDecoder),this.decoder=new Rt(w.encoding),this.encoding=w.encoding)}function m(w){if(yt=yt||i("./_stream_duplex"),!(this instanceof m))return new m(w);var r=this instanceof yt;this._readableState=new f(w,this,r),this.readable=!0,w&&(typeof w.read=="function"&&(this._read=w.read),typeof w.destroy=="function"&&(this._destroy=w.destroy)),kt.call(this)}function g(w,r,l,d,C){q("readableAddChunk",r);var R=w._readableState;if(r===null)R.reading=!1,y(w,R);else{var O;if(C||(O=M(R,r)),O)B(w,O);else if(!(R.objectMode||r&&0<r.length))d||(R.reading=!1,T(w,R));else if(typeof r=="string"||R.objectMode||Object.getPrototypeOf(r)===Yt.prototype||(r=p(r)),d)R.endEmitted?B(w,new I):S(w,R,r,!0);else if(R.ended)B(w,new At);else{if(R.destroyed)return!1;R.reading=!1,R.decoder&&!l?(r=R.decoder.write(r),R.objectMode||r.length!==0?S(w,R,r,!1):T(w,R)):S(w,R,r,!1)}}return!R.ended&&(R.length<R.highWaterMark||R.length===0)}function S(w,r,l,d){r.flowing&&r.length===0&&!r.sync?(r.awaitDrain=0,w.emit("data",l)):(r.length+=r.objectMode?1:l.length,d?r.buffer.unshift(l):r.buffer.push(l),r.needReadable&&_(w)),T(w,r)}function M(w,r){var l;return b(r)||typeof r=="string"||r===void 0||w.objectMode||(l=new Tt("chunk",["string","Buffer","Uint8Array"],r)),l}function L(w){return 1073741824<=w?w=1073741824:(w--,w|=w>>>1,w|=w>>>2,w|=w>>>4,w|=w>>>8,w|=w>>>16,w++),w}function N(w,r){return 0>=w||r.length===0&&r.ended?0:r.objectMode?1:w===w?(w>r.highWaterMark&&(r.highWaterMark=L(w)),w<=r.length?w:r.ended?r.length:(r.needReadable=!0,0)):r.flowing&&r.length?r.buffer.head.data.length:r.length}function y(w,r){if(q("onEofChunk"),!r.ended){if(r.decoder){var l=r.decoder.end();l&&l.length&&(r.buffer.push(l),r.length+=r.objectMode?1:l.length)}r.ended=!0,r.sync?_(w):(r.needReadable=!1,!r.emittedReadable&&(r.emittedReadable=!0,v(w)))}}function _(w){var r=w._readableState;q("emitReadable",r.needReadable,r.emittedReadable),r.needReadable=!1,r.emittedReadable||(q("emitReadable",r.flowing),r.emittedReadable=!0,a.nextTick(v,w))}function v(w){var r=w._readableState;q("emitReadable_",r.destroyed,r.length,r.ended),!r.destroyed&&(r.length||r.ended)&&(w.emit("readable"),r.emittedReadable=!1),r.needReadable=!r.flowing&&!r.ended&&r.length<=r.highWaterMark,j(w)}function T(w,r){r.readingMore||(r.readingMore=!0,a.nextTick(E,w,r))}function E(w,r){for(;!r.reading&&!r.ended&&(r.length<r.highWaterMark||r.flowing&&r.length===0);){var l=r.length;if(q("maybeReadMore read 0"),w.read(0),l===r.length)break}r.readingMore=!1}function x(w){return function(){var r=w._readableState;q("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&pe(w,"data")&&(r.flowing=!0,j(w))}}function U(w){var r=w._readableState;r.readableListening=0<w.listenerCount("readable"),r.resumeScheduled&&!r.paused?r.flowing=!0:0<w.listenerCount("data")&&w.resume()}function k(w){q("readable nexttick read 0"),w.read(0)}function A(w,r){r.resumeScheduled||(r.resumeScheduled=!0,a.nextTick(F,w,r))}function F(w,r){q("resume",r.reading),r.reading||w.read(0),r.resumeScheduled=!1,w.emit("resume"),j(w),r.flowing&&!r.reading&&w.read(0)}function j(w){var r=w._readableState;for(q("flow",r.flowing);r.flowing&&w.read()!==null;);}function W(w,r){if(r.length===0)return null;var l;return r.objectMode?l=r.buffer.shift():!w||w>=r.length?(l=r.decoder?r.buffer.join(""):r.buffer.length===1?r.buffer.first():r.buffer.concat(r.length),r.buffer.clear()):l=r.buffer.consume(w,r.decoder),l}function Y(w){var r=w._readableState;q("endReadable",r.endEmitted),r.endEmitted||(r.ended=!0,a.nextTick(Z,r,w))}function Z(w,r){if(q("endReadableNT",w.endEmitted,w.length),!w.endEmitted&&w.length===0&&(w.endEmitted=!0,r.readable=!1,r.emit("end"),w.autoDestroy)){var l=r._writableState;(!l||l.autoDestroy&&l.finished)&&r.destroy()}}function ot(w,r){for(var l=0,d=w.length;l<d;l++)if(w[l]===r)return l;return-1}u.exports=m;var yt;m.ReadableState=f;var q;i("events").EventEmitter;var pe=function(w,r){return w.listeners(r).length},kt=i("./internal/streams/stream"),Yt=i("buffer").Buffer,rt=c.Uint8Array||function(){},Q=i("util");q=Q&&Q.debuglog?Q.debuglog("stream"):function(){};var Rt,Gt,Jt,Me=i("./internal/streams/buffer_list"),ne=i("./internal/streams/destroy"),re=i("./internal/streams/state"),Ne=re.getHighWaterMark,Kt=i("../errors").codes,Tt=Kt.ERR_INVALID_ARG_TYPE,At=Kt.ERR_STREAM_PUSH_AFTER_EOF,D=Kt.ERR_METHOD_NOT_IMPLEMENTED,I=Kt.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;i("inherits")(m,kt);var B=ne.errorOrDestroy,z=["error","close","destroy","pause","resume"];Object.defineProperty(m.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(w){this._readableState&&(this._readableState.destroyed=w)}}),m.prototype.destroy=ne.destroy,m.prototype._undestroy=ne.undestroy,m.prototype._destroy=function(w,r){r(w)},m.prototype.push=function(w,r){var l,d=this._readableState;return d.objectMode?l=!0:typeof w=="string"&&(r=r||d.defaultEncoding,r!==d.encoding&&(w=Yt.from(w,r),r=""),l=!0),g(this,w,r,!1,l)},m.prototype.unshift=function(w){return g(this,w,null,!0,!1)},m.prototype.isPaused=function(){return this._readableState.flowing===!1},m.prototype.setEncoding=function(w){Rt||(Rt=i("string_decoder/").StringDecoder);var r=new Rt(w);this._readableState.decoder=r,this._readableState.encoding=this._readableState.decoder.encoding;for(var l=this._readableState.buffer.head,d="";l!==null;)d+=r.write(l.data),l=l.next;return this._readableState.buffer.clear(),d!==""&&this._readableState.buffer.push(d),this._readableState.length=d.length,this},m.prototype.read=function(w){q("read",w),w=parseInt(w,10);var r=this._readableState,l=w;if(w!==0&&(r.emittedReadable=!1),w===0&&r.needReadable&&((r.highWaterMark===0?0<r.length:r.length>=r.highWaterMark)||r.ended))return q("read: emitReadable",r.length,r.ended),r.length===0&&r.ended?Y(this):_(this),null;if(w=N(w,r),w===0&&r.ended)return r.length===0&&Y(this),null;var d=r.needReadable;q("need readable",d),(r.length===0||r.length-w<r.highWaterMark)&&(d=!0,q("length less than watermark",d)),r.ended||r.reading?(d=!1,q("reading or ended",d)):d&&(q("do read"),r.reading=!0,r.sync=!0,r.length===0&&(r.needReadable=!0),this._read(r.highWaterMark),r.sync=!1,!r.reading&&(w=N(l,r)));var C;return C=0<w?W(w,r):null,C===null?(r.needReadable=r.length<=r.highWaterMark,w=0):(r.length-=w,r.awaitDrain=0),r.length===0&&(!r.ended&&(r.needReadable=!0),l!==w&&r.ended&&Y(this)),C!==null&&this.emit("data",C),C},m.prototype._read=function(){B(this,new D("_read()"))},m.prototype.pipe=function(w,r){function l(ye,we){q("onunpipe"),ye===K&&we&&we.hasUnpiped===!1&&(we.hasUnpiped=!0,C())}function d(){q("onend"),w.end()}function C(){q("cleanup"),w.removeListener("close",P),w.removeListener("finish",J),w.removeListener("drain",me),w.removeListener("error",O),w.removeListener("unpipe",l),K.removeListener("end",d),K.removeListener("end",et),K.removeListener("data",R),Ue=!0,G.awaitDrain&&(!w._writableState||w._writableState.needDrain)&&me()}function R(ye){q("ondata");var we=w.write(ye);q("dest.write",we),we===!1&&((G.pipesCount===1&&G.pipes===w||1<G.pipesCount&&ot(G.pipes,w)!==-1)&&!Ue&&(q("false write response, pause",G.awaitDrain),G.awaitDrain++),K.pause())}function O(ye){q("onerror",ye),et(),w.removeListener("error",O),pe(w,"error")===0&&B(w,ye)}function P(){w.removeListener("finish",J),et()}function J(){q("onfinish"),w.removeListener("close",P),et()}function et(){q("unpipe"),K.unpipe(w)}var K=this,G=this._readableState;switch(G.pipesCount){case 0:G.pipes=w;break;case 1:G.pipes=[G.pipes,w];break;default:G.pipes.push(w)}G.pipesCount+=1,q("pipe count=%d opts=%j",G.pipesCount,r);var ft=(!r||r.end!==!1)&&w!==a.stdout&&w!==a.stderr,se=ft?d:et;G.endEmitted?a.nextTick(se):K.once("end",se),w.on("unpipe",l);var me=x(K);w.on("drain",me);var Ue=!1;return K.on("data",R),h(w,"error",O),w.once("close",P),w.once("finish",J),w.emit("pipe",K),G.flowing||(q("pipe resume"),K.resume()),w},m.prototype.unpipe=function(w){var r=this._readableState,l={hasUnpiped:!1};if(r.pipesCount===0)return this;if(r.pipesCount===1)return w&&w!==r.pipes?this:(w||(w=r.pipes),r.pipes=null,r.pipesCount=0,r.flowing=!1,w&&w.emit("unpipe",this,l),this);if(!w){var d=r.pipes,C=r.pipesCount;r.pipes=null,r.pipesCount=0,r.flowing=!1;for(var R=0;R<C;R++)d[R].emit("unpipe",this,{hasUnpiped:!1});return this}var O=ot(r.pipes,w);return O===-1?this:(r.pipes.splice(O,1),r.pipesCount-=1,r.pipesCount===1&&(r.pipes=r.pipes[0]),w.emit("unpipe",this,l),this)},m.prototype.on=function(w,r){var l=kt.prototype.on.call(this,w,r),d=this._readableState;return w==="data"?(d.readableListening=0<this.listenerCount("readable"),d.flowing!==!1&&this.resume()):w=="readable"&&!d.endEmitted&&!d.readableListening&&(d.readableListening=d.needReadable=!0,d.flowing=!1,d.emittedReadable=!1,q("on readable",d.length,d.reading),d.length?_(this):!d.reading&&a.nextTick(k,this)),l},m.prototype.addListener=m.prototype.on,m.prototype.removeListener=function(w,r){var l=kt.prototype.removeListener.call(this,w,r);return w==="readable"&&a.nextTick(U,this),l},m.prototype.removeAllListeners=function(w){var r=kt.prototype.removeAllListeners.apply(this,arguments);return(w==="readable"||w===void 0)&&a.nextTick(U,this),r},m.prototype.resume=function(){var w=this._readableState;return w.flowing||(q("resume"),w.flowing=!w.readableListening,A(this,w)),w.paused=!1,this},m.prototype.pause=function(){return q("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(q("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},m.prototype.wrap=function(w){var r=this,l=this._readableState,d=!1;for(var C in w.on("end",function(){if(q("wrapped end"),l.decoder&&!l.ended){var O=l.decoder.end();O&&O.length&&r.push(O)}r.push(null)}),w.on("data",function(O){if(q("wrapped data"),l.decoder&&(O=l.decoder.write(O)),!(l.objectMode&&O==null)&&(l.objectMode||O&&O.length)){var P=r.push(O);P||(d=!0,w.pause())}}),w)this[C]===void 0&&typeof w[C]=="function"&&(this[C]=function(O){return function(){return w[O].apply(w,arguments)}}(C));for(var R=0;R<z.length;R++)w.on(z[R],this.emit.bind(this,z[R]));return this._read=function(O){q("wrapped _read",O),d&&(d=!1,w.resume())},this},typeof Symbol=="function"&&(m.prototype[Symbol.asyncIterator]=function(){return Gt===void 0&&(Gt=i("./internal/streams/async_iterator")),Gt(this)}),Object.defineProperty(m.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(m.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(m.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(w){this._readableState&&(this._readableState.flowing=w)}}),m._fromList=W,Object.defineProperty(m.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(m.from=function(w,r){return Jt===void 0&&(Jt=i("./internal/streams/from")),Jt(m,w,r)})}).call(this)}).call(this,i("_process"),typeof xt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:xt)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(i,u){function a(L,N){var y=this._transformState;y.transforming=!1;var _=y.writecb;if(_===null)return this.emit("error",new m);y.writechunk=null,y.writecb=null,N!=null&&this.push(N),_(L);var v=this._readableState;v.reading=!1,(v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}function c(L){return this instanceof c?(M.call(this,L),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,L&&(typeof L.transform=="function"&&(this._transform=L.transform),typeof L.flush=="function"&&(this._flush=L.flush)),void this.on("prefinish",p)):new c(L)}function p(){var L=this;typeof this._flush!="function"||this._readableState.destroyed?b(this,null,null):this._flush(function(N,y){b(L,N,y)})}function b(L,N,y){if(N)return L.emit("error",N);if(y!=null&&L.push(y),L._writableState.length)throw new S;if(L._transformState.transforming)throw new g;return L.push(null)}u.exports=c;var h=i("../errors").codes,f=h.ERR_METHOD_NOT_IMPLEMENTED,m=h.ERR_MULTIPLE_CALLBACK,g=h.ERR_TRANSFORM_ALREADY_TRANSFORMING,S=h.ERR_TRANSFORM_WITH_LENGTH_0,M=i("./_stream_duplex");i("inherits")(c,M),c.prototype.push=function(L,N){return this._transformState.needTransform=!1,M.prototype.push.call(this,L,N)},c.prototype._transform=function(L,N,y){y(new f("_transform()"))},c.prototype._write=function(L,N,y){var _=this._transformState;if(_.writecb=y,_.writechunk=L,_.writeencoding=N,!_.transforming){var v=this._readableState;(_.needTransform||v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}},c.prototype._read=function(){var L=this._transformState;L.writechunk===null||L.transforming?L.needTransform=!0:(L.transforming=!0,this._transform(L.writechunk,L.writeencoding,L.afterTransform))},c.prototype._destroy=function(L,N){M.prototype._destroy.call(this,L,function(y){N(y)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(i,u){(function(a,c){(function(){function p(D){var I=this;this.next=null,this.entry=null,this.finish=function(){Y(I,D)}}function b(D){return q.from(D)}function h(D){return q.isBuffer(D)||D instanceof pe}function f(){}function m(D,I,B){Z=Z||i("./_stream_duplex"),D=D||{},typeof B!="boolean"&&(B=I instanceof Z),this.objectMode=!!D.objectMode,B&&(this.objectMode=this.objectMode||!!D.writableObjectMode),this.highWaterMark=rt(this,D,"writableHighWaterMark",B),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var z=D.decodeStrings===!1;this.decodeStrings=!z,this.defaultEncoding=D.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(w){T(I,w)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=D.emitClose!==!1,this.autoDestroy=!!D.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new p(this)}function g(D){Z=Z||i("./_stream_duplex");var I=this instanceof Z;return I||At.call(g,this)?(this._writableState=new m(D,this,I),this.writable=!0,D&&(typeof D.write=="function"&&(this._write=D.write),typeof D.writev=="function"&&(this._writev=D.writev),typeof D.destroy=="function"&&(this._destroy=D.destroy),typeof D.final=="function"&&(this._final=D.final)),void yt.call(this)):new g(D)}function S(D,I){var B=new Ne;Tt(D,B),a.nextTick(I,B)}function M(D,I,B,z){var w;return B===null?w=new re:typeof B!="string"&&!I.objectMode&&(w=new Rt("chunk",["string","Buffer"],B)),!w||(Tt(D,w),a.nextTick(z,w),!1)}function L(D,I,B){return D.objectMode||D.decodeStrings===!1||typeof I!="string"||(I=q.from(I,B)),I}function N(D,I,B,z,w,r){if(!B){var l=L(I,z,w);z!==l&&(B=!0,w="buffer",z=l)}var d=I.objectMode?1:z.length;I.length+=d;var C=I.length<I.highWaterMark;if(C||(I.needDrain=!0),I.writing||I.corked){var R=I.lastBufferedRequest;I.lastBufferedRequest={chunk:z,encoding:w,isBuf:B,callback:r,next:null},R?R.next=I.lastBufferedRequest:I.bufferedRequest=I.lastBufferedRequest,I.bufferedRequestCount+=1}else y(D,I,!1,d,z,w,r);return C}function y(D,I,B,z,w,r,l){I.writelen=z,I.writecb=l,I.writing=!0,I.sync=!0,I.destroyed?I.onwrite(new ne("write")):B?D._writev(w,I.onwrite):D._write(w,r,I.onwrite),I.sync=!1}function _(D,I,B,z,w){--I.pendingcb,B?(a.nextTick(w,z),a.nextTick(j,D,I),D._writableState.errorEmitted=!0,Tt(D,z)):(w(z),D._writableState.errorEmitted=!0,Tt(D,z),j(D,I))}function v(D){D.writing=!1,D.writecb=null,D.length-=D.writelen,D.writelen=0}function T(D,I){var B=D._writableState,z=B.sync,w=B.writecb;if(typeof w!="function")throw new Jt;if(v(B),I)_(D,B,z,I,w);else{var r=k(B)||D.destroyed;r||B.corked||B.bufferProcessing||!B.bufferedRequest||U(D,B),z?a.nextTick(E,D,B,r,w):E(D,B,r,w)}}function E(D,I,B,z){B||x(D,I),I.pendingcb--,z(),j(D,I)}function x(D,I){I.length===0&&I.needDrain&&(I.needDrain=!1,D.emit("drain"))}function U(D,I){I.bufferProcessing=!0;var B=I.bufferedRequest;if(D._writev&&B&&B.next){var z=I.bufferedRequestCount,w=Array(z),r=I.corkedRequestsFree;r.entry=B;for(var l=0,d=!0;B;)w[l]=B,B.isBuf||(d=!1),B=B.next,l+=1;w.allBuffers=d,y(D,I,!0,I.length,w,"",r.finish),I.pendingcb++,I.lastBufferedRequest=null,r.next?(I.corkedRequestsFree=r.next,r.next=null):I.corkedRequestsFree=new p(I),I.bufferedRequestCount=0}else{for(;B;){var C=B.chunk,R=B.encoding,O=B.callback,P=I.objectMode?1:C.length;if(y(D,I,!1,P,C,R,O),B=B.next,I.bufferedRequestCount--,I.writing)break}B===null&&(I.lastBufferedRequest=null)}I.bufferedRequest=B,I.bufferProcessing=!1}function k(D){return D.ending&&D.length===0&&D.bufferedRequest===null&&!D.finished&&!D.writing}function A(D,I){D._final(function(B){I.pendingcb--,B&&Tt(D,B),I.prefinished=!0,D.emit("prefinish"),j(D,I)})}function F(D,I){I.prefinished||I.finalCalled||(typeof D._final!="function"||I.destroyed?(I.prefinished=!0,D.emit("prefinish")):(I.pendingcb++,I.finalCalled=!0,a.nextTick(A,D,I)))}function j(D,I){var B=k(I);if(B&&(F(D,I),I.pendingcb===0&&(I.finished=!0,D.emit("finish"),I.autoDestroy))){var z=D._readableState;(!z||z.autoDestroy&&z.endEmitted)&&D.destroy()}return B}function W(D,I,B){I.ending=!0,j(D,I),B&&(I.finished?a.nextTick(B):D.once("finish",B)),I.ended=!0,D.writable=!1}function Y(D,I,B){var z=D.entry;for(D.entry=null;z;){var w=z.callback;I.pendingcb--,w(B),z=z.next}I.corkedRequestsFree.next=D}u.exports=g;var Z;g.WritableState=m;var ot={deprecate:i("util-deprecate")},yt=i("./internal/streams/stream"),q=i("buffer").Buffer,pe=c.Uint8Array||function(){},kt=i("./internal/streams/destroy"),Yt=i("./internal/streams/state"),rt=Yt.getHighWaterMark,Q=i("../errors").codes,Rt=Q.ERR_INVALID_ARG_TYPE,Gt=Q.ERR_METHOD_NOT_IMPLEMENTED,Jt=Q.ERR_MULTIPLE_CALLBACK,Me=Q.ERR_STREAM_CANNOT_PIPE,ne=Q.ERR_STREAM_DESTROYED,re=Q.ERR_STREAM_NULL_VALUES,Ne=Q.ERR_STREAM_WRITE_AFTER_END,Kt=Q.ERR_UNKNOWN_ENCODING,Tt=kt.errorOrDestroy;i("inherits")(g,yt),m.prototype.getBuffer=function(){for(var D=this.bufferedRequest,I=[];D;)I.push(D),D=D.next;return I},function(){try{Object.defineProperty(m.prototype,"buffer",{get:ot.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var At;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(At=Function.prototype[Symbol.hasInstance],Object.defineProperty(g,Symbol.hasInstance,{value:function(D){return!!At.call(this,D)||this===g&&D&&D._writableState instanceof m}})):At=function(D){return D instanceof this},g.prototype.pipe=function(){Tt(this,new Me)},g.prototype.write=function(D,I,B){var z=this._writableState,w=!1,r=!z.objectMode&&h(D);return r&&!q.isBuffer(D)&&(D=b(D)),typeof I=="function"&&(B=I,I=null),r?I="buffer":!I&&(I=z.defaultEncoding),typeof B!="function"&&(B=f),z.ending?S(this,B):(r||M(this,z,D,B))&&(z.pendingcb++,w=N(this,z,r,D,I,B)),w},g.prototype.cork=function(){this._writableState.corked++},g.prototype.uncork=function(){var D=this._writableState;D.corked&&(D.corked--,!D.writing&&!D.corked&&!D.bufferProcessing&&D.bufferedRequest&&U(this,D))},g.prototype.setDefaultEncoding=function(D){if(typeof D=="string"&&(D=D.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((D+"").toLowerCase())))throw new Kt(D);return this._writableState.defaultEncoding=D,this},Object.defineProperty(g.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),g.prototype._write=function(D,I,B){B(new Gt("_write()"))},g.prototype._writev=null,g.prototype.end=function(D,I,B){var z=this._writableState;return typeof D=="function"?(B=D,D=null,I=null):typeof I=="function"&&(B=I,I=null),D!=null&&this.write(D,I),z.corked&&(z.corked=1,this.uncork()),z.ending||W(this,z,B),this},Object.defineProperty(g.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(g.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(D){this._writableState&&(this._writableState.destroyed=D)}}),g.prototype.destroy=kt.destroy,g.prototype._undestroy=kt.undestroy,g.prototype._destroy=function(D,I){I(D)}}).call(this)}).call(this,i("_process"),typeof xt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:xt)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(i,u){(function(a){(function(){function c(x,U,k){return U in x?Object.defineProperty(x,U,{value:k,enumerable:!0,configurable:!0,writable:!0}):x[U]=k,x}function p(x,U){return{value:x,done:U}}function b(x){var U=x[S];if(U!==null){var k=x[v].read();k!==null&&(x[y]=null,x[S]=null,x[M]=null,U(p(k,!1)))}}function h(x){a.nextTick(b,x)}function f(x,U){return function(k,A){x.then(function(){return U[N]?void k(p(void 0,!0)):void U[_](k,A)},A)}}var m,g=i("./end-of-stream"),S=Symbol("lastResolve"),M=Symbol("lastReject"),L=Symbol("error"),N=Symbol("ended"),y=Symbol("lastPromise"),_=Symbol("handlePromise"),v=Symbol("stream"),T=Object.getPrototypeOf(function(){}),E=Object.setPrototypeOf((m={get stream(){return this[v]},next:function(){var x=this,U=this[L];if(U!==null)return Promise.reject(U);if(this[N])return Promise.resolve(p(void 0,!0));if(this[v].destroyed)return new Promise(function(j,W){a.nextTick(function(){x[L]?W(x[L]):j(p(void 0,!0))})});var k,A=this[y];if(A)k=new Promise(f(A,this));else{var F=this[v].read();if(F!==null)return Promise.resolve(p(F,!1));k=new Promise(this[_])}return this[y]=k,k}},c(m,Symbol.asyncIterator,function(){return this}),c(m,"return",function(){var x=this;return new Promise(function(U,k){x[v].destroy(null,function(A){return A?void k(A):void U(p(void 0,!0))})})}),m),T);u.exports=function(x){var U,k=Object.create(E,(U={},c(U,v,{value:x,writable:!0}),c(U,S,{value:null,writable:!0}),c(U,M,{value:null,writable:!0}),c(U,L,{value:null,writable:!0}),c(U,N,{value:x._readableState.endEmitted,writable:!0}),c(U,_,{value:function(A,F){var j=k[v].read();j?(k[y]=null,k[S]=null,k[M]=null,A(p(j,!1))):(k[S]=A,k[M]=F)},writable:!0}),U));return k[y]=null,g(x,function(A){if(A&&A.code!=="ERR_STREAM_PREMATURE_CLOSE"){var F=k[M];return F!==null&&(k[y]=null,k[S]=null,k[M]=null,F(A)),void(k[L]=A)}var j=k[S];j!==null&&(k[y]=null,k[S]=null,k[M]=null,j(p(void 0,!0))),k[N]=!0}),x.on("readable",h.bind(null,k)),k}}).call(this)}).call(this,i("_process"))},{"./end-of-stream":24,_process:12}],22:[function(i,u){function a(y,_){var v=Object.keys(y);if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(y);_&&(T=T.filter(function(E){return Object.getOwnPropertyDescriptor(y,E).enumerable})),v.push.apply(v,T)}return v}function c(y){for(var _,v=1;v<arguments.length;v++)_=arguments[v]==null?{}:arguments[v],v%2?a(Object(_),!0).forEach(function(T){p(y,T,_[T])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(_)):a(Object(_)).forEach(function(T){Object.defineProperty(y,T,Object.getOwnPropertyDescriptor(_,T))});return y}function p(y,_,v){return _ in y?Object.defineProperty(y,_,{value:v,enumerable:!0,configurable:!0,writable:!0}):y[_]=v,y}function b(y,_){if(!(y instanceof _))throw new TypeError("Cannot call a class as a function")}function h(y,_){for(var v,T=0;T<_.length;T++)v=_[T],v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(y,v.key,v)}function f(y,_,v){return _&&h(y.prototype,_),v&&h(y,v),y}function m(y,_,v){S.prototype.copy.call(y,_,v)}var g=i("buffer"),S=g.Buffer,M=i("util"),L=M.inspect,N=L&&L.custom||"inspect";u.exports=function(){function y(){b(this,y),this.head=null,this.tail=null,this.length=0}return f(y,[{key:"push",value:function(_){var v={data:_,next:null};0<this.length?this.tail.next=v:this.head=v,this.tail=v,++this.length}},{key:"unshift",value:function(_){var v={data:_,next:this.head};this.length===0&&(this.tail=v),this.head=v,++this.length}},{key:"shift",value:function(){if(this.length!==0){var _=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,_}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(_){if(this.length===0)return"";for(var v=this.head,T=""+v.data;v=v.next;)T+=_+v.data;return T}},{key:"concat",value:function(_){if(this.length===0)return S.alloc(0);for(var v=S.allocUnsafe(_>>>0),T=this.head,E=0;T;)m(T.data,v,E),E+=T.data.length,T=T.next;return v}},{key:"consume",value:function(_,v){var T;return _<this.head.data.length?(T=this.head.data.slice(0,_),this.head.data=this.head.data.slice(_)):_===this.head.data.length?T=this.shift():T=v?this._getString(_):this._getBuffer(_),T}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(_){var v=this.head,T=1,E=v.data;for(_-=E.length;v=v.next;){var x=v.data,U=_>x.length?x.length:_;if(E+=U===x.length?x:x.slice(0,_),_-=U,_===0){U===x.length?(++T,this.head=v.next?v.next:this.tail=null):(this.head=v,v.data=x.slice(U));break}++T}return this.length-=T,E}},{key:"_getBuffer",value:function(_){var v=S.allocUnsafe(_),T=this.head,E=1;for(T.data.copy(v),_-=T.data.length;T=T.next;){var x=T.data,U=_>x.length?x.length:_;if(x.copy(v,v.length-_,0,U),_-=U,_===0){U===x.length?(++E,this.head=T.next?T.next:this.tail=null):(this.head=T,T.data=x.slice(U));break}++E}return this.length-=E,v}},{key:N,value:function(_,v){return L(this,c({},v,{depth:0,customInspect:!1}))}}]),y}()},{buffer:3,util:2}],23:[function(i,u){(function(a){(function(){function c(h,f){b(h,f),p(h)}function p(h){h._writableState&&!h._writableState.emitClose||h._readableState&&!h._readableState.emitClose||h.emit("close")}function b(h,f){h.emit("error",f)}u.exports={destroy:function(h,f){var m=this,g=this._readableState&&this._readableState.destroyed,S=this._writableState&&this._writableState.destroyed;return g||S?(f?f(h):h&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,a.nextTick(b,this,h)):a.nextTick(b,this,h)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(h||null,function(M){!f&&M?m._writableState?m._writableState.errorEmitted?a.nextTick(p,m):(m._writableState.errorEmitted=!0,a.nextTick(c,m,M)):a.nextTick(c,m,M):f?(a.nextTick(p,m),f(M)):a.nextTick(p,m)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(h,f){var m=h._readableState,g=h._writableState;m&&m.autoDestroy||g&&g.autoDestroy?h.destroy(f):h.emit("error",f)}}}).call(this)}).call(this,i("_process"))},{_process:12}],24:[function(i,u){function a(f){var m=!1;return function(){if(!m){m=!0;for(var g=arguments.length,S=Array(g),M=0;M<g;M++)S[M]=arguments[M];f.apply(this,S)}}}function c(){}function p(f){return f.setHeader&&typeof f.abort=="function"}function b(f,m,g){if(typeof m=="function")return b(f,null,m);m||(m={}),g=a(g||c);var S=m.readable||m.readable!==!1&&f.readable,M=m.writable||m.writable!==!1&&f.writable,L=function(){f.writable||y()},N=f._writableState&&f._writableState.finished,y=function(){M=!1,N=!0,S||g.call(f)},_=f._readableState&&f._readableState.endEmitted,v=function(){S=!1,_=!0,M||g.call(f)},T=function(U){g.call(f,U)},E=function(){var U;return S&&!_?(f._readableState&&f._readableState.ended||(U=new h),g.call(f,U)):M&&!N?(f._writableState&&f._writableState.ended||(U=new h),g.call(f,U)):void 0},x=function(){f.req.on("finish",y)};return p(f)?(f.on("complete",y),f.on("abort",E),f.req?x():f.on("request",x)):M&&!f._writableState&&(f.on("end",L),f.on("close",L)),f.on("end",v),f.on("finish",y),m.error!==!1&&f.on("error",T),f.on("close",E),function(){f.removeListener("complete",y),f.removeListener("abort",E),f.removeListener("request",x),f.req&&f.req.removeListener("finish",y),f.removeListener("end",L),f.removeListener("close",L),f.removeListener("finish",y),f.removeListener("end",v),f.removeListener("error",T),f.removeListener("close",E)}}var h=i("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;u.exports=b},{"../../../errors":15}],25:[function(i,u){u.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(i,u){function a(N){var y=!1;return function(){y||(y=!0,N.apply(void 0,arguments))}}function c(N){if(N)throw N}function p(N){return N.setHeader&&typeof N.abort=="function"}function b(N,y,_,v){v=a(v);var T=!1;N.on("close",function(){T=!0}),g===void 0&&(g=i("./end-of-stream")),g(N,{readable:y,writable:_},function(x){return x?v(x):(T=!0,void v())});var E=!1;return function(x){if(!T)return E?void 0:(E=!0,p(N)?N.abort():typeof N.destroy=="function"?N.destroy():void v(x||new L("pipe")))}}function h(N){N()}function f(N,y){return N.pipe(y)}function m(N){return N.length&&typeof N[N.length-1]=="function"?N.pop():c}var g,S=i("../../../errors").codes,M=S.ERR_MISSING_ARGS,L=S.ERR_STREAM_DESTROYED;u.exports=function(){for(var N=arguments.length,y=Array(N),_=0;_<N;_++)y[_]=arguments[_];var v=m(y);if(Array.isArray(y[0])&&(y=y[0]),2>y.length)throw new M("streams");var T,E=y.map(function(x,U){var k=U<y.length-1;return b(x,k,0<U,function(A){T||(T=A),A&&E.forEach(h),k||(E.forEach(h),v(T))})});return y.reduce(f)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(i,u){function a(p,b,h){return p.highWaterMark==null?b?p[h]:null:p.highWaterMark}var c=i("../../../errors").codes.ERR_INVALID_OPT_VALUE;u.exports={getHighWaterMark:function(p,b,h,f){var m=a(b,f,h);if(m!=null){if(!(isFinite(m)&&n(m)===m)||0>m){var g=f?h:"highWaterMark";throw new c(g,m)}return n(m)}return p.objectMode?16:16384}}},{"../../../errors":15}],28:[function(i,u){u.exports=i("events").EventEmitter},{events:7}],29:[function(i,u,a){a=u.exports=i("./lib/_stream_readable.js"),a.Stream=a,a.Readable=a,a.Writable=i("./lib/_stream_writable.js"),a.Duplex=i("./lib/_stream_duplex.js"),a.Transform=i("./lib/_stream_transform.js"),a.PassThrough=i("./lib/_stream_passthrough.js"),a.finished=i("./lib/internal/streams/end-of-stream.js"),a.pipeline=i("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(i,u,a){function c(f,m){for(var g in f)m[g]=f[g]}function p(f,m,g){return h(f,m,g)}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var b=i("buffer"),h=b.Buffer;h.from&&h.alloc&&h.allocUnsafe&&h.allocUnsafeSlow?u.exports=b:(c(b,a),a.Buffer=p),p.prototype=Object.create(h.prototype),c(h,p),p.from=function(f,m,g){if(typeof f=="number")throw new TypeError("Argument must not be a number");return h(f,m,g)},p.alloc=function(f,m,g){if(typeof f!="number")throw new TypeError("Argument must be a number");var S=h(f);return m===void 0?S.fill(0):typeof g=="string"?S.fill(m,g):S.fill(m),S},p.allocUnsafe=function(f){if(typeof f!="number")throw new TypeError("Argument must be a number");return h(f)},p.allocUnsafeSlow=function(f){if(typeof f!="number")throw new TypeError("Argument must be a number");return b.SlowBuffer(f)}},{buffer:3}],31:[function(i,u,a){function c(E){if(!E)return"utf8";for(var x;;)switch(E){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return E;default:if(x)return;E=(""+E).toLowerCase(),x=!0}}function p(E){var x=c(E);if(typeof x!="string"&&(v.isEncoding===T||!T(E)))throw new Error("Unknown encoding: "+E);return x||E}function b(E){this.encoding=p(E);var x;switch(this.encoding){case"utf16le":this.text=S,this.end=M,x=4;break;case"utf8":this.fillLast=g,x=4;break;case"base64":this.text=L,this.end=N,x=3;break;default:return this.write=y,void(this.end=_)}this.lastNeed=0,this.lastTotal=0,this.lastChar=v.allocUnsafe(x)}function h(E){return 127>=E?0:E>>5==6?2:E>>4==14?3:E>>3==30?4:E>>6==2?-1:-2}function f(E,x,U){var k=x.length-1;if(k<U)return 0;var A=h(x[k]);return 0<=A?(0<A&&(E.lastNeed=A-1),A):--k<U||A===-2?0:(A=h(x[k]),0<=A?(0<A&&(E.lastNeed=A-2),A):--k<U||A===-2?0:(A=h(x[k]),0<=A?(0<A&&(A===2?A=0:E.lastNeed=A-3),A):0))}function m(E,x){if((192&x[0])!=128)return E.lastNeed=0,"";if(1<E.lastNeed&&1<x.length){if((192&x[1])!=128)return E.lastNeed=1,"";if(2<E.lastNeed&&2<x.length&&(192&x[2])!=128)return E.lastNeed=2,""}}function g(E){var x=this.lastTotal-this.lastNeed,U=m(this,E);return U===void 0?this.lastNeed<=E.length?(E.copy(this.lastChar,x,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(E.copy(this.lastChar,x,0,E.length),void(this.lastNeed-=E.length)):U}function S(E,x){if((E.length-x)%2==0){var U=E.toString("utf16le",x);if(U){var k=U.charCodeAt(U.length-1);if(55296<=k&&56319>=k)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=E[E.length-2],this.lastChar[1]=E[E.length-1],U.slice(0,-1)}return U}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=E[E.length-1],E.toString("utf16le",x,E.length-1)}function M(E){var x=E&&E.length?this.write(E):"";if(this.lastNeed){var U=this.lastTotal-this.lastNeed;return x+this.lastChar.toString("utf16le",0,U)}return x}function L(E,x){var U=(E.length-x)%3;return U==0?E.toString("base64",x):(this.lastNeed=3-U,this.lastTotal=3,U==1?this.lastChar[0]=E[E.length-1]:(this.lastChar[0]=E[E.length-2],this.lastChar[1]=E[E.length-1]),E.toString("base64",x,E.length-U))}function N(E){var x=E&&E.length?this.write(E):"";return this.lastNeed?x+this.lastChar.toString("base64",0,3-this.lastNeed):x}function y(E){return E.toString(this.encoding)}function _(E){return E&&E.length?this.write(E):""}var v=i("safe-buffer").Buffer,T=v.isEncoding||function(E){switch(E=""+E,E&&E.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};a.StringDecoder=b,b.prototype.write=function(E){if(E.length===0)return"";var x,U;if(this.lastNeed){if(x=this.fillLast(E),x===void 0)return"";U=this.lastNeed,this.lastNeed=0}else U=0;return U<E.length?x?x+this.text(E,U):this.text(E,U):x||""},b.prototype.end=function(E){var x=E&&E.length?this.write(E):"";return this.lastNeed?x+"":x},b.prototype.text=function(E,x){var U=f(this,E,x);if(!this.lastNeed)return E.toString("utf8",x);this.lastTotal=U;var k=E.length-(U-this.lastNeed);return E.copy(this.lastChar,0,k),E.toString("utf8",x,k)},b.prototype.fillLast=function(E){return this.lastNeed<=E.length?(E.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(E.copy(this.lastChar,this.lastTotal-this.lastNeed,0,E.length),void(this.lastNeed-=E.length))}},{"safe-buffer":30}],32:[function(i,u){(function(a){(function(){function c(p){try{if(!a.localStorage)return!1}catch{return!1}var b=a.localStorage[p];return b!=null&&(b+"").toLowerCase()==="true"}u.exports=function(p,b){function h(){if(!f){if(c("throwDeprecation"))throw new Error(b);c("traceDeprecation")?console.trace(b):console.warn(b),f=!0}return p.apply(this,arguments)}if(c("noDeprecation"))return p;var f=!1;return h}}).call(this)}).call(this,typeof xt>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:xt)},{}],"/":[function(i,u){function a(N){return N.replace(/a=ice-options:trickle\s\n/g,"")}function c(N){console.warn(N)}/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const p=i("debug")("simple-peer"),b=i("get-browser-rtc"),h=i("randombytes"),f=i("readable-stream"),m=i("queue-microtask"),g=i("err-code"),{Buffer:S}=i("buffer"),M=65536;class L extends f.Duplex{constructor(y){if(y=Object.assign({allowHalfOpen:!1},y),super(y),this._id=h(4).toString("hex").slice(0,7),this._debug("new peer %o",y),this.channelName=y.initiator?y.channelName||h(20).toString("hex"):null,this.initiator=y.initiator||!1,this.channelConfig=y.channelConfig||L.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},L.config,y.config),this.offerOptions=y.offerOptions||{},this.answerOptions=y.answerOptions||{},this.sdpTransform=y.sdpTransform||(_=>_),this.streams=y.streams||(y.stream?[y.stream]:[]),this.trickle=y.trickle===void 0||y.trickle,this.allowHalfTrickle=y.allowHalfTrickle!==void 0&&y.allowHalfTrickle,this.iceCompleteTimeout=y.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=y.wrtc&&typeof y.wrtc=="object"?y.wrtc:b(),!this._wrtc)throw g(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(_){return void this.destroy(g(_,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=_=>{this._onIceCandidate(_)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(_=>{this.destroy(g(_,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=_=>{this._setupData(_)},this.streams&&this.streams.forEach(_=>{this.addStream(_)}),this._pc.ontrack=_=>{this._onTrack(_)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(y){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof y=="string")try{y=JSON.parse(y)}catch{y={}}this._debug("signal()"),y.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),y.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(y.transceiverRequest.kind,y.transceiverRequest.init)),y.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(y.candidate):this._pendingCandidates.push(y.candidate)),y.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(y)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(_=>{this._addIceCandidate(_)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(_=>{this.destroy(g(_,"ERR_SET_REMOTE_DESCRIPTION"))}),y.sdp||y.candidate||y.renegotiate||y.transceiverRequest||this.destroy(g(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(y){const _=new this._wrtc.RTCIceCandidate(y);this._pc.addIceCandidate(_).catch(v=>{!_.address||_.address.endsWith(".local")?c("Ignoring unsupported ICE candidate."):this.destroy(g(v,"ERR_ADD_ICE_CANDIDATE"))})}send(y){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(y)}}addTransceiver(y,_){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(y,_),this._needsNegotiation()}catch(v){this.destroy(g(v,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:y,init:_}})}}addStream(y){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),y.getTracks().forEach(_=>{this.addTrack(_,y)})}}addTrack(y,_){if(this.destroying)return;if(this.destroyed)throw g(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const v=this._senderMap.get(y)||new Map;let T=v.get(_);if(!T)T=this._pc.addTrack(y,_),v.set(_,T),this._senderMap.set(y,v),this._needsNegotiation();else throw T.removed?g(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):g(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(y,_,v){if(this.destroying)return;if(this.destroyed)throw g(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const T=this._senderMap.get(y),E=T?T.get(v):null;if(!E)throw g(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");_&&this._senderMap.set(_,T),E.replaceTrack==null?this.destroy(g(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):E.replaceTrack(_)}removeTrack(y,_){if(this.destroying)return;if(this.destroyed)throw g(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const v=this._senderMap.get(y),T=v?v.get(_):null;if(!T)throw g(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{T.removed=!0,this._pc.removeTrack(T)}catch(E){E.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(T):this.destroy(g(E,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(y){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),y.getTracks().forEach(_=>{this.removeTrack(_,y)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,m(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(y){this._destroy(y,()=>{})}_destroy(y,_){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",y&&(y.message||y)),m(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",y&&(y.message||y)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,y&&this.emit("error",y),this.emit("close"),_()}))}_setupData(y){if(!y.channel)return this.destroy(g(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=y.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=M),this.channelName=this._channel.label,this._channel.onmessage=v=>{this._onChannelMessage(v)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=v=>{const T=v.error instanceof Error?v.error:new Error(`Datachannel error: ${v.message} ${v.filename}:${v.lineno}:${v.colno}`);this.destroy(g(T,"ERR_DATA_CHANNEL"))};let _=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(_&&this._onChannelClose(),_=!0):_=!1},5e3)}_read(){}_write(y,_,v){if(this.destroyed)return v(g(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(y)}catch(T){return this.destroy(g(T,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>M?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=v):v(null)}else this._debug("write before connect"),this._chunk=y,this._cb=v}_onFinish(){if(!this.destroyed){const y=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?y():this.once("connect",y)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(y=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(y.sdp=a(y.sdp)),y.sdp=this.sdpTransform(y.sdp);const _=()=>{if(!this.destroyed){const v=this._pc.localDescription||y;this._debug("signal"),this.emit("signal",{type:v.type,sdp:v.sdp})}};this._pc.setLocalDescription(y).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?_():this.once("_iceComplete",_))}).catch(v=>{this.destroy(g(v,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(y=>{this.destroy(g(y,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(y=>{y.mid||!y.sender.track||y.requested||(y.requested=!0,this.addTransceiver(y.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(y=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(y.sdp=a(y.sdp)),y.sdp=this.sdpTransform(y.sdp);const _=()=>{if(!this.destroyed){const v=this._pc.localDescription||y;this._debug("signal"),this.emit("signal",{type:v.type,sdp:v.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(y).then(()=>{this.destroyed||(this.trickle||this._iceComplete?_():this.once("_iceComplete",_))}).catch(v=>{this.destroy(g(v,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(y=>{this.destroy(g(y,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(g(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const y=this._pc.iceConnectionState,_=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",y,_),this.emit("iceStateChange",y,_),(y==="connected"||y==="completed")&&(this._pcReady=!0,this._maybeReady()),y==="failed"&&this.destroy(g(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),y==="closed"&&this.destroy(g(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(y){const _=v=>(Object.prototype.toString.call(v.values)==="[object Array]"&&v.values.forEach(T=>{Object.assign(v,T)}),v);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(v=>{const T=[];v.forEach(E=>{T.push(_(E))}),y(null,T)},v=>y(v)):0<this._pc.getStats.length?this._pc.getStats(v=>{if(this.destroyed)return;const T=[];v.result().forEach(E=>{const x={};E.names().forEach(U=>{x[U]=E.stat(U)}),x.id=E.id,x.type=E.type,x.timestamp=E.timestamp,T.push(_(x))}),y(null,T)},v=>y(v)):y(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const y=()=>{this.destroyed||this.getStats((_,v)=>{if(this.destroyed)return;_&&(v=[]);const T={},E={},x={};let U=!1;v.forEach(A=>{(A.type==="remotecandidate"||A.type==="remote-candidate")&&(T[A.id]=A),(A.type==="localcandidate"||A.type==="local-candidate")&&(E[A.id]=A),(A.type==="candidatepair"||A.type==="candidate-pair")&&(x[A.id]=A)});const k=A=>{U=!0;let F=E[A.localCandidateId];F&&(F.ip||F.address)?(this.localAddress=F.ip||F.address,this.localPort=+F.port):F&&F.ipAddress?(this.localAddress=F.ipAddress,this.localPort=+F.portNumber):typeof A.googLocalAddress=="string"&&(F=A.googLocalAddress.split(":"),this.localAddress=F[0],this.localPort=+F[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let j=T[A.remoteCandidateId];j&&(j.ip||j.address)?(this.remoteAddress=j.ip||j.address,this.remotePort=+j.port):j&&j.ipAddress?(this.remoteAddress=j.ipAddress,this.remotePort=+j.portNumber):typeof A.googRemoteAddress=="string"&&(j=A.googRemoteAddress.split(":"),this.remoteAddress=j[0],this.remotePort=+j[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(v.forEach(A=>{A.type==="transport"&&A.selectedCandidatePairId&&k(x[A.selectedCandidatePairId]),(A.type==="googCandidatePair"&&A.googActiveConnection==="true"||(A.type==="candidatepair"||A.type==="candidate-pair")&&A.selected)&&k(A)}),!U&&(!Object.keys(x).length||Object.keys(E).length))return void setTimeout(y,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(F){return this.destroy(g(F,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const A=this._cb;this._cb=null,A(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};y()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>M)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(y=>{this._pc.removeTrack(y),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(y){this.destroyed||(y.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:y.candidate.candidate,sdpMLineIndex:y.candidate.sdpMLineIndex,sdpMid:y.candidate.sdpMid}}):!y.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),y.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(y){if(this.destroyed)return;let _=y.data;_ instanceof ArrayBuffer&&(_=S.from(_)),this.push(_)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const y=this._cb;this._cb=null,y(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(y){this.destroyed||y.streams.forEach(_=>{this._debug("on track"),this.emit("track",y.track,_),this._remoteTracks.push({track:y.track,stream:_}),this._remoteStreams.some(v=>v.id===_.id)||(this._remoteStreams.push(_),m(()=>{this._debug("on stream"),this.emit("stream",_)}))})}_debug(){const y=[].slice.call(arguments);y[0]="["+this._id+"] "+y[0],p.apply(null,y)}}L.WEBRTC_SUPPORT=!!b(),L.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},L.channelConfig={},u.exports=L},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})})(ki);var Ic=ki.exports;const Oc=Lc(Ic),Dr=0,xr=1,Ri=2,Ti=(e,t)=>{V(e,Dr);const n=_l(t);st(e,n)},Ai=(e,t,n)=>{V(e,xr),st(e,ml(t,n))},Mc=(e,t,n)=>Ai(t,n,ut(e)),Di=(e,t,n)=>{try{fl(t,ut(e),n)}catch(s){console.error("Caught error while handling a Yjs update",s)}},Nc=(e,t)=>{V(e,Ri),st(e,t)},Uc=Di,Fc=(e,t,n,s)=>{const o=H(e);switch(o){case Dr:Mc(e,t,n);break;case xr:Di(e,n,s);break;case Ri:Uc(e,n,s);break;default:throw new Error("Unknown message type")}return o},qn=3e4;class Bc extends ws{constructor(t){super(),this.doc=t,this.clientID=t.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const n=qt();this.getLocalState()!==null&&qn/2<=n-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const s=[];this.meta.forEach((o,i)=>{i!==this.clientID&&qn<=n-o.lastUpdated&&this.states.has(i)&&s.push(i)}),s.length>0&&sr(this,s,"timeout")},Mt(qn/10)),t.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(t){const n=this.clientID,s=this.meta.get(n),o=s===void 0?0:s.clock+1,i=this.states.get(n);t===null?this.states.delete(n):this.states.set(n,t),this.meta.set(n,{clock:o,lastUpdated:qt()});const u=[],a=[],c=[],p=[];t===null?p.push(n):i==null?t!=null&&u.push(n):(a.push(n),ze(i,t)||c.push(n)),(u.length>0||c.length>0||p.length>0)&&this.emit("change",[{added:u,updated:c,removed:p},"local"]),this.emit("update",[{added:u,updated:a,removed:p},"local"])}setLocalStateField(t,n){const s=this.getLocalState();s!==null&&this.setLocalState({...s,[t]:n})}getStates(){return this.states}}const sr=(e,t,n)=>{const s=[];for(let o=0;o<t.length;o++){const i=t[o];if(e.states.has(i)){if(e.states.delete(i),i===e.clientID){const u=e.meta.get(i);e.meta.set(i,{clock:u.clock+1,lastUpdated:qt()})}s.push(i)}}s.length>0&&(e.emit("change",[{added:[],updated:[],removed:s},n]),e.emit("update",[{added:[],updated:[],removed:s},n]))},Sn=(e,t,n=e.states)=>{const s=t.length,o=ht();V(o,s);for(let i=0;i<s;i++){const u=t[i],a=n.get(u)||null,c=e.meta.get(u).clock;V(o,u),V(o,c),It(o,JSON.stringify(a))}return nt(o)},jc=(e,t,n)=>{const s=jt(t),o=qt(),i=[],u=[],a=[],c=[],p=H(s);for(let b=0;b<p;b++){const h=H(s);let f=H(s);const m=JSON.parse(Vt(s)),g=e.meta.get(h),S=e.states.get(h),M=g===void 0?0:g.clock;(M<f||M===f&&m===null&&e.states.has(h))&&(m===null?h===e.clientID&&e.getLocalState()!=null?f++:e.states.delete(h):e.states.set(h,m),e.meta.set(h,{clock:f,lastUpdated:o}),g===void 0&&m!==null?i.push(h):g!==void 0&&m===null?c.push(h):m!==null&&(ze(m,S)||a.push(h),u.push(h)))}(i.length>0||a.length>0||c.length>0)&&e.emit("change",[{added:i,updated:a,removed:c},n]),(i.length>0||u.length>0||c.length>0)&&e.emit("update",[{added:i,updated:u,removed:c},n])},Pc=(e,t)=>{const n=Xn(e).buffer,s=Xn(t).buffer;return crypto.subtle.importKey("raw",n,"PBKDF2",!1,["deriveKey"]).then(o=>crypto.subtle.deriveKey({name:"PBKDF2",salt:s,iterations:1e5,hash:"SHA-256"},o,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},xi=(e,t)=>{if(!t)return fr(e);const n=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:n},t,e).then(s=>{const o=ht();return It(o,"AES-GCM"),st(o,n),st(o,new Uint8Array(s)),nt(o)})},zc=(e,t)=>{const n=ht();return Ee(n,e),xi(nt(n),t)},Li=(e,t)=>{if(!t)return fr(e);const n=jt(e);Vt(n)!=="AES-GCM"&&Eo(Nt("Unknown encryption algorithm"));const o=ut(n),i=ut(n);return crypto.subtle.decrypt({name:"AES-GCM",iv:o},t,i).then(u=>new Uint8Array(u))},Vc=(e,t)=>Li(e,t).then(n=>ke(jt(new Uint8Array(n)))),bt=el("y-webrtc"),Se=0,Ii=3,Ke=1,Lr=4,Cn=new Map,le=new Map,Oi=e=>{let t=!0;e.webrtcConns.forEach(n=>{n.synced||(t=!1)}),(!t&&e.synced||t&&!e.synced)&&(e.synced=t,e.provider.emit("synced",[{synced:t}]),bt("synced ",Et,e.name,ae," with all peers"))},Mi=(e,t,n)=>{const s=jt(t),o=ht(),i=H(s);if(e===void 0)return null;const u=e.awareness,a=e.doc;let c=!1;switch(i){case Se:{V(o,Se);const p=Fc(s,o,a,e);p===xr&&!e.synced&&n(),p===Dr&&(c=!0);break}case Ii:V(o,Ke),st(o,Sn(u,Array.from(u.getStates().keys()))),c=!0;break;case Ke:jc(u,ut(s),e);break;case Lr:{const p=ce(s)===1,b=Vt(s);if(b!==e.peerId&&(e.bcConns.has(b)&&!p||!e.bcConns.has(b)&&p)){const h=[],f=[];p?(e.bcConns.add(b),f.push(b)):(e.bcConns.delete(b),h.push(b)),e.provider.emit("peers",[{added:f,removed:h,webrtcPeers:Array.from(e.webrtcConns.keys()),bcPeers:Array.from(e.bcConns)}]),Ni(e)}break}default:return console.error("Unable to compute message"),o}return c?o:null},$c=(e,t)=>{const n=e.room;return bt("received message from ",Et,e.remotePeerId,mr," (",n.name,")",ae,Dn),Mi(n,t,()=>{e.synced=!0,bt("synced ",Et,n.name,ae," with ",Et,e.remotePeerId),Oi(n)})},Wn=(e,t)=>{bt("send message to ",Et,e.remotePeerId,ae,mr," (",e.room.name,")",Dn);try{e.peer.send(nt(t))}catch{}},qc=(e,t)=>{bt("broadcast message in ",Et,e.name,ae),e.webrtcConns.forEach(n=>{try{n.peer.send(t)}catch{}})};class ls{constructor(t,n,s,o){bt("establishing connection to ",Et,s),this.room=o,this.remotePeerId=s,this.glareToken=void 0,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new Oc({initiator:n,...o.provider.peerOpts}),this.peer.on("signal",i=>{this.glareToken===void 0&&(this.glareToken=Date.now()+Math.random()),Ir(t,o,{to:s,from:o.peerId,type:"signal",token:this.glareToken,signal:i})}),this.peer.on("connect",()=>{bt("connected to ",Et,s),this.connected=!0;const u=o.provider.doc,a=o.awareness,c=ht();V(c,Se),Ti(c,u),Wn(this,c);const p=a.getStates();if(p.size>0){const b=ht();V(b,Ke),st(b,Sn(a,Array.from(p.keys()))),Wn(this,b)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,o.webrtcConns.has(this.remotePeerId)&&(o.webrtcConns.delete(this.remotePeerId),o.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(o.webrtcConns.keys()),bcPeers:Array.from(o.bcConns)}])),Oi(o),this.peer.destroy(),bt("closed connection to ",Et,s),ir(o)}),this.peer.on("error",i=>{bt("Error in connection to ",Et,s,": ",i),ir(o)}),this.peer.on("data",i=>{const u=$c(this,i);u!==null&&Wn(this,u)})}destroy(){this.peer.destroy()}}const Xt=(e,t)=>xi(t,e.key).then(n=>e.mux(()=>Dc(e.name,n))),cs=(e,t)=>{e.bcconnected&&Xt(e,t),qc(e,t)},ir=e=>{Cn.forEach(t=>{t.connected&&(t.send({type:"subscribe",topics:[e.name]}),e.webrtcConns.size<e.provider.maxConns&&Ir(t,e,{type:"announce",from:e.peerId}))})},Ni=e=>{if(e.provider.filterBcConns){const t=ht();V(t,Lr),We(t,1),It(t,e.peerId),Xt(e,nt(t))}};class Wc{constructor(t,n,s,o){this.peerId=Es(),this.doc=t,this.awareness=n.awareness,this.provider=n,this.synced=!1,this.name=s,this.key=o,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=xc(),this.bcconnected=!1,this._bcSubscriber=i=>Li(new Uint8Array(i),o).then(u=>this.mux(()=>{const a=Mi(this,u,()=>{});a&&Xt(this,nt(a))})),this._docUpdateHandler=(i,u)=>{const a=ht();V(a,Se),Nc(a,i),cs(this,nt(a))},this._awarenessUpdateHandler=({added:i,updated:u,removed:a},c)=>{const p=i.concat(u).concat(a),b=ht();V(b,Ke),st(b,Sn(this.awareness,p)),cs(this,nt(b))},this._beforeUnloadHandler=()=>{sr(this.awareness,[t.clientID],"window unload"),le.forEach(i=>{i.disconnect()})},typeof window<"u"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),ir(this);const t=this.name;Tc(t,this._bcSubscriber),this.bcconnected=!0,Ni(this);const n=ht();V(n,Se),Ti(n,this.doc),Xt(this,nt(n));const s=ht();V(s,Se),Ai(s,this.doc),Xt(this,nt(s));const o=ht();V(o,Ii),Xt(this,nt(o));const i=ht();V(i,Ke),st(i,Sn(this.awareness,[this.doc.clientID])),Xt(this,nt(i))}disconnect(){Cn.forEach(n=>{n.connected&&n.send({type:"unsubscribe",topics:[this.name]})}),sr(this.awareness,[this.doc.clientID],"disconnect");const t=ht();V(t,Lr),We(t,0),It(t,this.peerId),Xt(this,nt(t)),Ac(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(n=>n.destroy())}destroy(){this.disconnect(),typeof window<"u"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.off("exit",this._beforeUnloadHandler)}}const Hc=(e,t,n,s)=>{if(le.has(n))throw Nt(`A Yjs Doc connected to room "${n}" already exists!`);const o=new Wc(e,t,n,s);return le.set(n,o),o},Ir=(e,t,n)=>{t.key?zc(n,t.key).then(s=>{e.send({type:"publish",topic:t.name,data:Os(s)})}):e.send({type:"publish",topic:t.name,data:n})};class Yc extends Ec{constructor(t){super(t),this.providers=new Set,this.on("connect",()=>{bt(`connected (${t})`);const n=Array.from(le.keys());this.send({type:"subscribe",topics:n}),le.forEach(s=>Ir(this,s,{type:"announce",from:s.peerId}))}),this.on("message",n=>{switch(n.type){case"publish":{const s=n.topic,o=le.get(s);if(o==null||typeof s!="string")return;const i=u=>{const a=o.webrtcConns,c=o.peerId;if(u==null||u.from===c||u.to!==void 0&&u.to!==c||o.bcConns.has(u.from))return;const p=a.has(u.from)?()=>{}:()=>o.provider.emit("peers",[{removed:[],added:[u.from],webrtcPeers:Array.from(o.webrtcConns.keys()),bcPeers:Array.from(o.bcConns)}]);switch(u.type){case"announce":a.size<o.provider.maxConns&&(vt(a,u.from,()=>new ls(this,!0,u.from,o)),p());break;case"signal":if(u.signal.type==="offer"){const b=a.get(u.from);if(b){const h=u.token,f=b.glareToken;if(f&&f>h){bt("offer rejected: ",u.from);return}b.glareToken=void 0}}if(u.signal.type==="answer"){bt("offer answered by: ",u.from);const b=a.get(u.from);b.glareToken=void 0}u.to===c&&(vt(a,u.from,()=>new ls(this,!1,u.from,o)).peer.signal(u.signal),p());break}};o.key?typeof n.data=="string"&&Vc(Ms(n.data),o.key).then(i):i(n.data)}}}),this.on("disconnect",()=>bt(`disconnect (${t})`))}}const Hn=e=>{e.emit("status",[{connected:e.connected}])};class Gc extends ys{constructor(t,n,{signaling:s=["wss://y-webrtc-eu.fly.dev"],password:o=null,awareness:i=new Bc(n),maxConns:u=20+Mt(So()*15),filterBcConns:a=!0,peerOpts:c={}}={}){super(),this.roomName=t,this.doc=n,this.filterBcConns=a,this.awareness=i,this.shouldConnect=!1,this.signalingUrls=s,this.signalingConns=[],this.maxConns=u,this.peerOpts=c,this.key=o?Pc(o,t):fr(null),this.room=null,this.key.then(p=>{this.room=Hc(n,this,t,p),this.shouldConnect?this.room.connect():this.room.disconnect(),Hn(this)}),this.connect(),this.destroy=this.destroy.bind(this),n.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(t=>{const n=vt(Cn,t,()=>new Yc(t));this.signalingConns.push(n),n.providers.add(this)}),this.room&&(this.room.connect(),Hn(this))}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(t=>{t.providers.delete(this),t.providers.size===0&&(t.destroy(),Cn.delete(t.url))}),this.room&&(this.room.disconnect(),Hn(this))}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),le.delete(this.roomName)}),super.destroy()}}const as=["#FF5733","#33A8FF","#33FF57","#FF33A8","#A833FF","#FFBD33","#33FFC1","#FF5733"],it=document.getElementById("editor"),Ve=document.getElementById("status"),Or=document.getElementById("username"),us=document.getElementById("session-id"),Jc=document.getElementById("join-btn"),Kc=document.getElementById("save-btn"),Xc=document.getElementById("session-display"),Zc=document.getElementById("current-session"),hs=document.getElementById("copy-notification"),Qc=document.getElementById("theme-toggle"),ds=document.getElementById("moon-icon"),fs=document.getElementById("sun-icon");Or.value="User"+Math.floor(Math.random()*1e3);let Lt=null,cn=[];function ta(){if(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)||window.location.search.includes("debug=true")){Lt=document.createElement("div"),Lt.id="mobile-debug-console",Lt.style.cssText=`
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 200px;
      background: rgba(0, 0, 0, 0.9);
      color: #00ff00;
      font-family: monospace;
      font-size: 10px;
      padding: 10px;
      overflow-y: auto;
      z-index: 10000;
      border-top: 2px solid #333;
      display: none;
    `;const t=document.createElement("button");t.textContent=" Debug",t.style.cssText=`
      position: fixed;
      bottom: 63px;
      right: 16px;
      z-index: 10001;
      background: #333;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 4px;
      font-size: 12px;
    `,t.onclick=()=>{const i=Lt.style.display==="block";Lt.style.display=i?"none":"block",t.textContent=i?" Debug":" Close"},document.body.appendChild(Lt),document.body.appendChild(t);const n=console.log,s=console.error,o=console.warn;console.log=function(...i){n.apply(console,i),Yn("LOG",i.join(" "))},console.error=function(...i){s.apply(console,i),Yn("ERROR",i.join(" "))},console.warn=function(...i){o.apply(console,i),Yn("WARN",i.join(" "))}}}function Yn(e,t){if(!Lt)return;const n=new Date().toLocaleTimeString(),s=e==="ERROR"?"#ff4444":e==="WARN"?"#ffaa00":"#00ff00";cn.push({type:e,message:t,timestamp:n}),cn.length>50&&cn.shift(),Lt.innerHTML=cn.map(o=>`<div style="color: ${s}; margin-bottom: 2px;">[${o.timestamp}] ${o.type}: ${o.message}</div>`).join(""),Lt.scrollTop=Lt.scrollHeight}ta();function ea(){const e=localStorage.getItem("theme");if(e)or(e);else{const t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;or(t?"dark":"light")}}function or(e){e==="dark"?(document.documentElement.setAttribute("data-theme","dark"),ds.style.display="none",fs.style.display="block"):(document.documentElement.removeAttribute("data-theme"),ds.style.display="block",fs.style.display="none")}function na(){const t=document.documentElement.getAttribute("data-theme")==="dark"?"light":"dark";or(t),localStorage.setItem("theme",t)}ea();Qc.addEventListener("click",na);const En=document.getElementById("header-toggle"),lr=document.querySelector(".header");let Be=!1;function Ui(){Be=!Be,Be?(lr.classList.add("header--hidden"),En.classList.add("header-toggle--hidden")):(lr.classList.remove("header--hidden"),En.classList.remove("header-toggle--hidden")),localStorage.setItem("headerHidden",Be)}function ra(){localStorage.getItem("headerHidden")==="true"&&(Be=!0,lr.classList.add("header--hidden"),En.classList.add("header-toggle--hidden"))}En.addEventListener("click",Ui);ra();function Fi(){return crypto===void 0||!crypto.randomUUID?"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}):crypto.randomUUID()}function sa(){return new URLSearchParams(window.location.search).get("session")||Fi()}function ia(e){const t=new URL(window.location);t.searchParams.set("session",e),window.history.pushState({},"",t)}function oa(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}let ie,$,gt,nn=sa(),Ce={},je={};function Bi(e){$&&$.destroy(),ie&&ie.destroy(),ie=new Ie,gt=ie.getText("content"),$=new Gc(`vibe_notes_${e}`,ie,{signaling:["wss://demos.yjs.dev/ws","wss://signaling.yjs.dev"],maxConns:20,filterBcConns:!0,peerOpts:{config:{iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"},{urls:"stun:stun.stunprotocol.org:3478"},{urls:"stun:stun.voiparound.com"},{urls:"stun:stun.voipbuster.com"},{urls:"stun:stun.services.mozilla.com"},{urls:"stun.ekiga.net"},{urls:"stun.ideasip.com"},{urls:"stun.rixtelecom.se"},{urls:"stun.schlund.de"},{urls:"stun.stunprotocol.org:3478"},{urls:"stun.voiparound.com"},{urls:"stun.voipbuster.com"},{urls:"stun.voipstunt.com"},{urls:"stun.voxgratia.org"},{urls:"23.21.150.121:3478"},{urls:"iphone-stun.strato-iphone.de:3478"},{urls:"numb.viagenie.ca:3478"},{urls:"s1.taraba.net:3478"},{urls:"s2.taraba.net:3478"},{urls:"stun.12connect.com:3478"},{urls:"stun.12voip.com:3478"},{urls:"stun.1und1.de:3478"},{urls:"stun.2talk.co.nz:3478"},{urls:"stun.2talk.com:3478"},{urls:"stun.3clogic.com:3478"},{urls:"stun.3cx.com:3478"},{urls:"stun.a-mm.tv:3478"},{urls:"stun.aa.net.uk:3478"},{urls:"stun.acrobits.cz:3478"},{urls:"stun.actionvoip.com:3478"},{urls:"stun.advfn.com:3478"},{urls:"stun.aeta-audio.com:3478"},{urls:"stun.aeta.com:3478"},{urls:"stun.alltel.com.au:3478"},{urls:"stun.altar.com.pl:3478"},{urls:"stun.annatel.net:3478"},{urls:"stun.antisip.com:3478"},{urls:"stun.arbuz.ru:3478"},{urls:"stun.avigora.com:3478"},{urls:"stun.avigora.fr:3478"},{urls:"stun.awa-shima.com:3478"},{urls:"stun.awt.be:3478"},{urls:"stun.b2b2c.ca:3478"},{urls:"stun.bahnhof.net:3478"},{urls:"stun.barracuda.com:3478"},{urls:"stun.bluesip.net:3478"},{urls:"stun.bmwgs.cz:3478"},{urls:"stun.botonakis.com:3478"},{urls:"stun.budgetphone.nl:3478"},{urls:"stun.budgetsip.com:3478"},{urls:"stun.cablenet-as.net:3478"},{urls:"stun.callromania.ro:3478"},{urls:"stun.callwithus.com:3478"},{urls:"stun.cbsys.net:3478"},{urls:"stun.chathelp.ru:3478"},{urls:"stun.cheapvoip.com:3478"},{urls:"stun.ciktel.com:3478"},{urls:"stun.cloopen.com:3478"},{urls:"stun.colouredlines.com.au:3478"},{urls:"stun.comfi.com:3478"},{urls:"stun.commpeak.com:3478"},{urls:"stun.comtube.com:3478"},{urls:"stun.comtube.ru:3478"},{urls:"stun.cope.es:3478"},{urls:"stun.counterpath.com:3478"},{urls:"stun.counterpath.net:3478"},{urls:"stun.cryptonit.net:3478"},{urls:"stun.darioflaccovio.it:3478"},{urls:"stun.datamanagement.it:3478"},{urls:"stun.dcalling.de:3478"},{urls:"stun.decanet.fr:3478"},{urls:"stun.demos.ru:3478"},{urls:"stun.develz.org:3478"},{urls:"stun.dingaling.ca:3478"},{urls:"stun.doublerobotics.com:3478"},{urls:"stun.drogon.net:3478"},{urls:"stun.duocom.es:3478"},{urls:"stun.dus.net:3478"},{urls:"stun.e-fon.ch:3478"},{urls:"stun.easybell.de:3478"},{urls:"stun.easycall.pl:3478"},{urls:"stun.easyvoip.com:3478"},{urls:"stun.efficace-factory.com:3478"},{urls:"stun.einsundeins.com:3478"},{urls:"stun.einsundeins.de:3478"},{urls:"stun.ekiga.net:3478"},{urls:"stun.epygi.com:3478"},{urls:"stun.etoilediese.fr:3478"},{urls:"stun.eyeball.com:3478"},{urls:"stun.faktortel.com.au:3478"},{urls:"stun.freecall.com:3478"},{urls:"stun.freeswitch.org:3478"},{urls:"stun.freevoipdeal.com:3478"},{urls:"stun.fuzemeeting.com:3478"},{urls:"stun.gmx.de:3478"},{urls:"stun.gmx.net:3478"},{urls:"stun.gradwell.com:3478"},{urls:"stun.halonet.pl:3478"},{urls:"stun.hellonanu.com:3478"},{urls:"stun.hoiio.com:3478"},{urls:"stun.hosteurope.de:3478"},{urls:"stun.ideasip.com:3478"},{urls:"stun.imesh.com:3478"},{urls:"stun.infra.net:3478"},{urls:"stun.internetcalls.com:3478"},{urls:"stun.intervoip.com:3478"},{urls:"stun.ipcomms.net:3478"},{urls:"stun.ipfire.org:3478"},{urls:"stun.ippi.fr:3478"},{urls:"stun.ipshka.com:3478"},{urls:"stun.iptel.org:3478"},{urls:"stun.irian.at:3478"},{urls:"stun.it1.hr:3478"},{urls:"stun.ivao.aero:3478"},{urls:"stun.jappix.com:3478"},{urls:"stun.jumblo.com:3478"},{urls:"stun.justvoip.com:3478"},{urls:"stun.kanet.ru:3478"},{urls:"stun.kiwilink.co.nz:3478"},{urls:"stun.kundenserver.de:3478"},{urls:"stun.l.google.com:19302"},{urls:"stun.linea7.net:3478"},{urls:"stun.linphone.org:3478"},{urls:"stun.liveo.fr:3478"},{urls:"stun.lowratevoip.com:3478"},{urls:"stun.lugosoft.com:3478"},{urls:"stun.lundimatin.fr:3478"},{urls:"stun.magnet.ie:3478"},{urls:"stun.manle.com:3478"},{urls:"stun.mgn.ru:3478"},{urls:"stun.mit.de:3478"},{urls:"stun.mitake.com.tw:3478"},{urls:"stun.miwifi.com:3478"},{urls:"stun.modulus.gr:3478"},{urls:"stun.mozcom.com:3478"},{urls:"stun.myvoiptraffic.com:3478"},{urls:"stun.mywatson.it:3478"},{urls:"stun.nas.net:3478"},{urls:"stun.neotel.co.za:3478"},{urls:"stun.netappel.com:3478"},{urls:"stun.netappel.fr:3478"},{urls:"stun.netgsm.com.tr:3478"},{urls:"stun.nfon.net:3478"},{urls:"stun.noblogs.org:3478"},{urls:"stun.noc.ams-ix.net:3478"},{urls:"stun.node4.co.uk:3478"},{urls:"stun.nonoh.net:3478"},{urls:"stun.nottingham.ac.uk:3478"},{urls:"stun.nova.is:3478"},{urls:"stun.nventure.com:3478"},{urls:"stun.on.net.mk:3478"},{urls:"stun.ooma.com:3478"},{urls:"stun.ooonet.ru:3478"},{urls:"stun.oriontelekom.rs:3478"},{urls:"stun.outland-net.de:3478"},{urls:"stun.ozekiphone.com:3478"},{urls:"stun.patlive.com:3478"},{urls:"stun.personal-voip.de:3478"},{urls:"stun.petcube.com:3478"},{urls:"stun.phone.com:3478"},{urls:"stun.phoneserve.com:3478"},{urls:"stun.pjsip.org:3478"},{urls:"stun.poivy.com:3478"},{urls:"stun.powerpbx.org:3478"},{urls:"stun.powervoip.com:3478"},{urls:"stun.ppdi.com:3478"},{urls:"stun.prizee.com:3478"},{urls:"stun.qq.com:3478"},{urls:"stun.qvod.com:3478"},{urls:"stun.rackco.com:3478"},{urls:"stun.rapidnet.de:3478"},{urls:"stun.rb-net.com:3478"},{urls:"stun.refint.net:3478"},{urls:"stun.remote-learner.net:3478"},{urls:"stun.rixtelecom.se:3478"},{urls:"stun.rockenstein.de:3478"},{urls:"stun.rolmail.net:3478"},{urls:"stun.rounds.com:3478"},{urls:"stun.rynga.com:3478"},{urls:"stun.samsungsmartcam.com:3478"},{urls:"stun.schlund.de:3478"},{urls:"stun.services.mozilla.com:3478"},{urls:"stun.sigmavoip.com:3478"},{urls:"stun.sip.us:3478"},{urls:"stun.sipdiscount.com:3478"},{urls:"stun.sipgate.net:10000"},{urls:"stun.sipgate.net:3478"},{urls:"stun.siplogin.de:3478"},{urls:"stun.sipnet.net:3478"},{urls:"stun.sipnet.ru:3478"},{urls:"stun.siportal.it:3478"},{urls:"stun.sippeer.dk:3478"},{urls:"stun.siptraffic.com:3478"},{urls:"stun.skylink.ru:3478"},{urls:"stun.sma.de:3478"},{urls:"stun.smartvoip.com:3478"},{urls:"stun.smsdiscount.com:3478"},{urls:"stun.snafu.de:3478"},{urls:"stun.softjoys.com:3478"},{urls:"stun.solcon.nl:3478"},{urls:"stun.solnet.ch:3478"},{urls:"stun.sonetel.com:3478"},{urls:"stun.sonetel.net:3478"},{urls:"stun.sovtest.ru:3478"},{urls:"stun.speedy.com.ar:3478"},{urls:"stun.spokn.com:3478"},{urls:"stun.srce.hr:3478"},{urls:"stun.ssl7.net:3478"},{urls:"stun.stunprotocol.org:3478"},{urls:"stun.symform.com:3478"},{urls:"stun.symplicity.com:3478"},{urls:"stun.sysadminman.net:3478"},{urls:"stun.t-online.de:3478"},{urls:"stun.tagan.ru:3478"},{urls:"stun.tatneft.ru:3478"},{urls:"stun.teachercreated.com:3478"},{urls:"stun.tel.lu:3478"},{urls:"stun.telbo.com:3478"},{urls:"stun.telefacil.com:3478"},{urls:"stun.tis-dialog.ru:3478"},{urls:"stun.tng.de:3478"},{urls:"stun.twt.it:3478"},{urls:"stun.u-blox.com:3478"},{urls:"stun.ucallweconn.net:3478"},{urls:"stun.ucsb.edu:3478"},{urls:"stun.ucw.cz:3478"},{urls:"stun.uls.co.za:3478"},{urls:"stun.unseen.is:3478"},{urls:"stun.usfamily.net:3478"},{urls:"stun.veoh.com:3478"},{urls:"stun.vidyo.com:3478"},{urls:"stun.vipgroup.net:3478"},{urls:"stun.virtual-call.com:3478"},{urls:"stun.viva.gr:3478"},{urls:"stun.vivox.com:3478"},{urls:"stun.vline.com:3478"},{urls:"stun.vo.lu:3478"},{urls:"stun.vodafone.ro:3478"},{urls:"stun.voicetrading.com:3478"},{urls:"stun.voip.aebc.com:3478"},{urls:"stun.voip.blackberry.com:3478"},{urls:"stun.voip.eutelia.it:3478"},{urls:"stun.voiparound.com:3478"},{urls:"stun.voipblast.com:3478"},{urls:"stun.voipbuster.com:3478"},{urls:"stun.voipbusterpro.com:3478"},{urls:"stun.voipcheap.co.uk:3478"},{urls:"stun.voipcheap.com:3478"},{urls:"stun.voipfibre.com:3478"},{urls:"stun.voipgain.com:3478"},{urls:"stun.voipgate.com:3478"},{urls:"stun.voipinfocenter.com:3478"},{urls:"stun.voipplanet.nl:3478"},{urls:"stun.voippro.com:3478"},{urls:"stun.voipraider.com:3478"},{urls:"stun.voipstunt.com:3478"},{urls:"stun.voipwise.com:3478"},{urls:"stun.voipzoom.com:3478"},{urls:"stun.vopium.com:3478"},{urls:"stun.voxgratia.org:3478"},{urls:"stun.voxox.com:3478"},{urls:"stun.voys.nl:3478"},{urls:"stun.voztele.com:3478"},{urls:"stun.vyke.com:3478"},{urls:"stun.webcalldirect.com:3478"},{urls:"stun.whoi.edu:3478"},{urls:"stun.wifirst.net:3478"},{urls:"stun.wwdl.net:3478"},{urls:"stun.xs4all.nl:3478"},{urls:"stun.xtratelecom.es:3478"},{urls:"stun.yesss.at:3478"},{urls:"stun.zadarma.com:3478"},{urls:"stun.zadv.com:3478"},{urls:"stun.zoiper.com:3478"},{urls:"stun1.faktortel.com.au:3478"},{urls:"stun1.l.google.com:19302"},{urls:"stun1.voiceeclipse.net:3478"},{urls:"stun2.l.google.com:19302"},{urls:"stun3.l.google.com:19302"},{urls:"stun4.l.google.com:19302"},{urls:"stunserver.org:3478"},{urls:"23.21.150.121:3478"},{urls:"iphone-stun.strato-iphone.de:3478"},{urls:"numb.viagenie.ca:3478"},{urls:"s1.taraba.net:3478"},{urls:"s2.taraba.net:3478"},{urls:"stun.12connect.com:3478"},{urls:"stun.12voip.com:3478"},{urls:"stun.1und1.de:3478"},{urls:"stun.2talk.co.nz:3478"},{urls:"stun.2talk.com:3478"},{urls:"stun.3clogic.com:3478"},{urls:"stun.3cx.com:3478"},{urls:"stun.a-mm.tv:3478"},{urls:"stun.aa.net.uk:3478"},{urls:"stun.acrobits.cz:3478"},{urls:"stun.actionvoip.com:3478"},{urls:"stun.advfn.com:3478"},{urls:"stun.aeta-audio.com:3478"},{urls:"stun.aeta.com:3478"},{urls:"stun.alltel.com.au:3478"},{urls:"stun.altar.com.pl:3478"},{urls:"stun.annatel.net:3478"},{urls:"stun.antisip.com:3478"},{urls:"stun.arbuz.ru:3478"},{urls:"stun.avigora.com:3478"},{urls:"stun.avigora.fr:3478"},{urls:"stun.awa-shima.com:3478"},{urls:"stun.awt.be:3478"},{urls:"stun.b2b2c.ca:3478"},{urls:"stun.bahnhof.net:3478"},{urls:"stun.barracuda.com:3478"},{urls:"stun.bluesip.net:3478"},{urls:"stun.bmwgs.cz:3478"},{urls:"stun.botonakis.com:3478"},{urls:"stun.budgetphone.nl:3478"},{urls:"stun.budgetsip.com:3478"},{urls:"stun.cablenet-as.net:3478"},{urls:"stun.callromania.ro:3478"},{urls:"stun.callwithus.com:3478"},{urls:"stun.cbsys.net:3478"},{urls:"stun.chathelp.ru:3478"},{urls:"stun.cheapvoip.com:3478"},{urls:"stun.ciktel.com:3478"},{urls:"stun.cloopen.com:3478"},{urls:"stun.colouredlines.com.au:3478"},{urls:"stun.comfi.com:3478"},{urls:"stun.commpeak.com:3478"},{urls:"stun.comtube.com:3478"},{urls:"stun.comtube.ru:3478"},{urls:"stun.cope.es:3478"},{urls:"stun.counterpath.com:3478"},{urls:"stun.counterpath.net:3478"},{urls:"stun.cryptonit.net:3478"},{urls:"stun.darioflaccovio.it:3478"},{urls:"stun.datamanagement.it:3478"},{urls:"stun.dcalling.de:3478"},{urls:"stun.decanet.fr:3478"},{urls:"stun.demos.ru:3478"},{urls:"stun.develz.org:3478"},{urls:"stun.dingaling.ca:3478"},{urls:"stun.doublerobotics.com:3478"},{urls:"stun.drogon.net:3478"},{urls:"stun.duocom.es:3478"},{urls:"stun.dus.net:3478"},{urls:"stun.e-fon.ch:3478"},{urls:"stun.easybell.de:3478"},{urls:"stun.easycall.pl:3478"},{urls:"stun.easyvoip.com:3478"},{urls:"stun.efficace-factory.com:3478"},{urls:"stun.einsundeins.com:3478"},{urls:"stun.einsundeins.de:3478"},{urls:"stun.ekiga.net:3478"},{urls:"stun.epygi.com:3478"},{urls:"stun.etoilediese.fr:3478"},{urls:"stun.eyeball.com:3478"},{urls:"stun.faktortel.com.au:3478"},{urls:"stun.freecall.com:3478"},{urls:"stun.freeswitch.org:3478"},{urls:"stun.freevoipdeal.com:3478"},{urls:"stun.fuzemeeting.com:3478"},{urls:"stun.gmx.de:3478"},{urls:"stun.gmx.net:3478"},{urls:"stun.gradwell.com:3478"},{urls:"stun.halonet.pl:3478"},{urls:"stun.hellonanu.com:3478"},{urls:"stun.hoiio.com:3478"},{urls:"stun.hosteurope.de:3478"},{urls:"stun.ideasip.com:3478"},{urls:"stun.imesh.com:3478"},{urls:"stun.infra.net:3478"},{urls:"stun.internetcalls.com:3478"},{urls:"stun.intervoip.com:3478"},{urls:"stun.ipcomms.net:3478"},{urls:"stun.ipfire.org:3478"},{urls:"stun.ippi.fr:3478"},{urls:"stun.ipshka.com:3478"},{urls:"stun.iptel.org:3478"},{urls:"stun.irian.at:3478"},{urls:"stun.it1.hr:3478"},{urls:"stun.ivao.aero:3478"},{urls:"stun.jappix.com:3478"},{urls:"stun.jumblo.com:3478"},{urls:"stun.justvoip.com:3478"},{urls:"stun.kanet.ru:3478"},{urls:"stun.kiwilink.co.nz:3478"},{urls:"stun.kundenserver.de:3478"},{urls:"stun.l.google.com:19302"},{urls:"stun.linea7.net:3478"},{urls:"stun.linphone.org:3478"},{urls:"stun.liveo.fr:3478"},{urls:"stun.lowratevoip.com:3478"},{urls:"stun.lugosoft.com:3478"},{urls:"stun.lundimatin.fr:3478"},{urls:"stun.magnet.ie:3478"},{urls:"stun.manle.com:3478"},{urls:"stun.mgn.ru:3478"},{urls:"stun.mit.de:3478"},{urls:"stun.mitake.com.tw:3478"},{urls:"stun.miwifi.com:3478"},{urls:"stun.modulus.gr:3478"},{urls:"stun.mozcom.com:3478"},{urls:"stun.myvoiptraffic.com:3478"},{urls:"stun.mywatson.it:3478"},{urls:"stun.nas.net:3478"},{urls:"stun.neotel.co.za:3478"},{urls:"stun.netappel.com:3478"},{urls:"stun.netappel.fr:3478"},{urls:"stun.netgsm.com.tr:3478"},{urls:"stun.nfon.net:3478"},{urls:"stun.noblogs.org:3478"},{urls:"stun.noc.ams-ix.net:3478"},{urls:"stun.node4.co.uk:3478"},{urls:"stun.nonoh.net:3478"},{urls:"stun.nottingham.ac.uk:3478"},{urls:"stun.nova.is:3478"},{urls:"stun.nventure.com:3478"},{urls:"stun.on.net.mk:3478"},{urls:"stun.ooma.com:3478"},{urls:"stun.ooonet.ru:3478"},{urls:"stun.oriontelekom.rs:3478"},{urls:"stun.outland-net.de:3478"},{urls:"stun.ozekiphone.com:3478"},{urls:"stun.patlive.com:3478"},{urls:"stun.personal-voip.de:3478"},{urls:"stun.petcube.com:3478"},{urls:"stun.phone.com:3478"},{urls:"stun.phoneserve.com:3478"},{urls:"stun.pjsip.org:3478"},{urls:"stun.poivy.com:3478"},{urls:"stun.powerpbx.org:3478"},{urls:"stun.powervoip.com:3478"},{urls:"stun.ppdi.com:3478"},{urls:"stun.prizee.com:3478"},{urls:"stun.qq.com:3478"},{urls:"stun.qvod.com:3478"},{urls:"stun.rackco.com:3478"},{urls:"stun.rapidnet.de:3478"},{urls:"stun.rb-net.com:3478"},{urls:"stun.refint.net:3478"},{urls:"stun.remote-learner.net:3478"},{urls:"stun.rixtelecom.se:3478"},{urls:"stun.rockenstein.de:3478"},{urls:"stun.rolmail.net:3478"},{urls:"stun.rounds.com:3478"},{urls:"stun.rynga.com:3478"},{urls:"stun.samsungsmartcam.com:3478"},{urls:"stun.schlund.de:3478"},{urls:"stun.services.mozilla.com:3478"},{urls:"stun.sigmavoip.com:3478"},{urls:"stun.sip.us:3478"},{urls:"stun.sipdiscount.com:3478"},{urls:"stun.sipgate.net:10000"},{urls:"stun.sipgate.net:3478"},{urls:"stun.siplogin.de:3478"},{urls:"stun.sipnet.net:3478"},{urls:"stun.sipnet.ru:3478"},{urls:"stun.siportal.it:3478"},{urls:"stun.sippeer.dk:3478"},{urls:"stun.siptraffic.com:3478"},{urls:"stun.skylink.ru:3478"},{urls:"stun.sma.de:3478"},{urls:"stun.smartvoip.com:3478"},{urls:"stun.smsdiscount.com:3478"},{urls:"stun.snafu.de:3478"},{urls:"stun.softjoys.com:3478"},{urls:"stun.solcon.nl:3478"},{urls:"stun.solnet.ch:3478"},{urls:"stun.sonetel.com:3478"},{urls:"stun.sonetel.net:3478"},{urls:"stun.sovtest.ru:3478"},{urls:"stun.speedy.com.ar:3478"},{urls:"stun.spokn.com:3478"},{urls:"stun.srce.hr:3478"},{urls:"stun.ssl7.net:3478"},{urls:"stun.stunprotocol.org:3478"},{urls:"stun.symform.com:3478"},{urls:"stun.symplicity.com:3478"},{urls:"stun.sysadminman.net:3478"},{urls:"stun.t-online.de:3478"},{urls:"stun.tagan.ru:3478"},{urls:"stun.tatneft.ru:3478"},{urls:"stun.teachercreated.com:3478"},{urls:"stun.tel.lu:3478"},{urls:"stun.telbo.com:3478"},{urls:"stun.telefacil.com:3478"},{urls:"stun.tis-dialog.ru:3478"},{urls:"stun.tng.de:3478"},{urls:"stun.twt.it:3478"},{urls:"stun.u-blox.com:3478"},{urls:"stun.ucallweconn.net:3478"},{urls:"stun.ucsb.edu:3478"},{urls:"stun.ucw.cz:3478"},{urls:"stun.uls.co.za:3478"},{urls:"stun.unseen.is:3478"},{urls:"stun.usfamily.net:3478"},{urls:"stun.veoh.com:3478"},{urls:"stun.vidyo.com:3478"},{urls:"stun.vipgroup.net:3478"},{urls:"stun.virtual-call.com:3478"},{urls:"stun.viva.gr:3478"},{urls:"stun.vivox.com:3478"},{urls:"stun.vline.com:3478"},{urls:"stun.vo.lu:3478"},{urls:"stun.vodafone.ro:3478"},{urls:"stun.voicetrading.com:3478"},{urls:"stun.voip.aebc.com:3478"},{urls:"stun.voip.blackberry.com:3478"},{urls:"stun.voip.eutelia.it:3478"},{urls:"stun.voiparound.com:3478"},{urls:"stun.voipblast.com:3478"},{urls:"stun.voipbuster.com:3478"},{urls:"stun.voipbusterpro.com:3478"},{urls:"stun.voipcheap.co.uk:3478"},{urls:"stun.voipcheap.com:3478"},{urls:"stun.voipfibre.com:3478"},{urls:"stun.voipgain.com:3478"},{urls:"stun.voipgate.com:3478"},{urls:"stun.voipinfocenter.com:3478"},{urls:"stun.voipplanet.nl:3478"},{urls:"stun.voippro.com:3478"},{urls:"stun.voipraider.com:3478"},{urls:"stun.voipstunt.com:3478"},{urls:"stun.voipwise.com:3478"},{urls:"stun.voipzoom.com:3478"},{urls:"stun.vopium.com:3478"},{urls:"stun.voxgratia.org:3478"},{urls:"stun.voxox.com:3478"},{urls:"stun.voys.nl:3478"},{urls:"stun.voztele.com:3478"},{urls:"stun.vyke.com:3478"},{urls:"stun.webcalldirect.com:3478"},{urls:"stun.whoi.edu:3478"},{urls:"stun.wifirst.net:3478"},{urls:"stun.wwdl.net:3478"},{urls:"stun.xs4all.nl:3478"},{urls:"stun.xtratelecom.es:3478"},{urls:"stun.yesss.at:3478"},{urls:"stun.zadarma.com:3478"},{urls:"stun.zadv.com:3478"},{urls:"stun.zoiper.com:3478"},{urls:"stun1.faktortel.com.au:3478"},{urls:"stun1.l.google.com:19302"},{urls:"stun1.voiceeclipse.net:3478"},{urls:"stun2.l.google.com:19302"},{urls:"stun3.l.google.com:19302"},{urls:"stun4.l.google.com:19302"},{urls:"stunserver.org:3478"},{urls:"turn:openrelay.metered.ca:80",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:turn01.hubl.in?transport=udp"},{urls:"turn:turn02.hubl.in?transport=tcp"},{url:"turn:numb.viagenie.ca",credential:"muazkh",username:"webrtc@live.com"},{url:"turn:192.158.29.39:3478?transport=udp",credential:"JZEOEt2V3Qb0y27GRntt2u2PAYA=",username:"28224511:1379330808"},{url:"turn:192.158.29.39:3478?transport=tcp",credential:"JZEOEt2V3Qb0y27GRntt2u2PAYA=",username:"28224511:1379330808"},{url:"turn:turn.bistri.com:80",credential:"homeo",username:"homeo"},{url:"turn:turn.anyfirewall.com:443?transport=tcp",credential:"webrtc",username:"webrtc"}],iceCandidatePoolSize:10,iceTransportPolicy:"all"}}}),console.log("=== WebRTC Debug Info ==="),console.log(`Session ID: ${e}`),console.log(`Room: vibe_notes_${e}`),console.log(`URL: ${window.location.href}`),console.log(`User Agent: ${navigator.userAgent}`),console.log(`Is Secure Context: ${window.isSecureContext}`),$.on("status",n=>{console.log(`[${new Date().toISOString()}] Provider Status:`,n),n.status==="connected"?console.log(" Connected to signaling server"):n.status==="disconnected"&&console.log(" Disconnected from signaling server")}),setTimeout(()=>{$.signalingConns&&$.signalingConns.length>0?$.signalingConns.forEach((n,s)=>{console.log(`Signaling connection ${s}:`,n.url||n),n&&typeof n.addEventListener=="function"?(n.addEventListener("open",()=>{console.log(` Signaling WebSocket opened: ${n.url}`)}),n.addEventListener("close",o=>{console.log(` Signaling WebSocket closed: ${n.url}`,o.code,o.reason)}),n.addEventListener("error",o=>{console.log(` Signaling WebSocket error: ${n.url}`,o)})):console.log(`Signaling connection ${s} is not a WebSocket:`,typeof n,n)}):console.log(" No signaling connections found")},500),$.on("peers",n=>{console.log(`[${new Date().toISOString()}] Peers Event:`,n);const s=$.awareness.getStates().size-1;console.log(`Current peer count: ${s}`)}),$.awareness.on("change",n=>{console.log(`[${new Date().toISOString()}] Awareness Change:`,n);const s=$.awareness.getStates();console.log("All connected clients:",Array.from(s.keys())),s.forEach((o,i)=>{var u;i!==$.awareness.clientID&&console.log(`Peer ${i}:`,((u=o.user)==null?void 0:u.name)||"Anonymous")})}),$.on("connection-error",n=>{console.error(`[${new Date().toISOString()}] WebRTC Connection Error:`,n)}),$.on("sync",n=>{console.log(`[${new Date().toISOString()}] Document Sync:`,n?" Synced":" Syncing...")}),setTimeout(()=>{var n,s;console.log(`Provider Client ID: ${$.awareness.clientID}`),console.log(`Connected Peers: ${$.awareness.getStates().size-1}`),console.log(`Provider roomName property: ${$.roomName}`),console.log(`Provider connected: ${$.connected}`),console.log(`Provider synced: ${$.synced}`),console.log(`Signaling connections: ${((n=$.signalingConns)==null?void 0:n.length)||0}`),console.log("Provider room object:",$.room),console.log("Provider properties:",Object.getOwnPropertyNames($)),(s=$.signalingConns)==null||s.forEach((o,i)=>{console.log(`Signaling ${i}: ${o.url||"no url"} - Ready state: ${o.readyState||"undefined"}`)})},2e3),$.on("peers",n=>{console.log("Peer connection event:",n)}),Xc.textContent=e,nn=e,ia(e);const t=Or.value.trim()||"User"+Math.floor(Math.random()*1e3);$.awareness.setLocalStateField("user",{name:t,cursor:null}),$.awareness.on("change",()=>{gs(),ca()}),$.on("status",n=>{n.status==="connected"?Ve.style.backgroundColor="rgba(0,255,0,0.2)":Ve.style.backgroundColor="rgba(255,0,0,0.2)"}),gs(),la()}function la(){let e=!1;it.textContent=gt.toString(),gt.observe(t=>{if(t.transaction.origin!==$.awareness.clientID&&!e){const n=window.getSelection(),s=n.rangeCount>0;let o=null;if(s){const i=n.getRangeAt(0);o={startContainer:i.startContainer,startOffset:i.startOffset,endContainer:i.endContainer,endOffset:i.endOffset}}if(it.innerHTML=gt.toString(),s&&o)try{setTimeout(()=>{const i=document.createRange(),u=Array.from(it.childNodes).findIndex(a=>a.textContent===o.startContainer.textContent);if(u>=0){const a=it.childNodes[u];i.setStart(a,Math.min(o.startOffset,a.textContent.length)),i.setEnd(a,Math.min(o.endOffset,a.textContent.length)),n.removeAllRanges(),n.addRange(i)}},0)}catch{}}}),it.addEventListener("input",()=>{e=!0;const t=oa(it.innerText);gt.delete(0,gt.length),gt.insert(0,t),e=!1,Fe()}),it.addEventListener("mouseup",Fe),it.addEventListener("keyup",Fe),it.addEventListener("click",Fe),setTimeout(()=>{it.focus(),Fe()},100)}function gs(){if(!$)return;const e=$.awareness.getStates().size;Ve.textContent=`Connected with ${e-1} peer${e!==2?"s":""}`,e>1?Ve.style.backgroundColor="rgba(0,255,0,0.2)":Ve.style.backgroundColor="rgba(255,165,0,0.2)"}Jc.addEventListener("click",()=>{const e=us.value.trim()||Fi();Mr(),je={},Bi(e),us.value=""});Bi(nn);Zc.addEventListener("click",()=>{const e=new URL(window.location);e.searchParams.set("session",nn);const t=e.toString();navigator.clipboard.writeText(t).then(()=>{hs.classList.add("show"),setTimeout(()=>{hs.classList.remove("show")},2e3)}).catch(n=>{console.error("Failed to copy URL: ",n)})});window.addEventListener("beforeunload",()=>{$&&$.destroy(),ie&&ie.destroy(),Mr()});function Fe(){if(!$||!$.awareness)return;const e=window.getSelection();if(!e.rangeCount)return;const t=e.getRangeAt(0);if(!it.contains(t.startContainer))return;let n;const s=document.createElement("span");if(s.innerHTML="&#8203;",t.cloneRange().insertNode(s),n=s.getBoundingClientRect(),n.height===0){const c=(s.parentNode||it).getBoundingClientRect(),p=window.getComputedStyle(it),b=parseInt(p.lineHeight)||27;n={left:c.left+24,top:c.top,width:0,height:b}}if(s.parentNode&&s.parentNode.removeChild(s),e.removeAllRanges(),e.addRange(t),t.startContainer===it&&t.startOffset===0){const a=it.getBoundingClientRect();n={left:a.left+24,top:a.top+24,width:0,height:27}}const i=it.getBoundingClientRect(),u={left:n.left-i.left,top:n.top-i.top};$.awareness.setLocalStateField("user",{name:Or.value.trim()||"User"+Math.floor(Math.random()*1e3),cursor:u})}function ca(){if(!$||!$.awareness)return;Mr();const e=$.awareness.getStates(),t=$.awareness.clientID;e.forEach((n,s)=>{s===t||!n.user||!n.user.cursor||ua(s,n.user)})}function aa(){if(!$||!$.awareness)return;const e=$.awareness.getStates(),t=$.awareness.clientID;e.forEach((n,s)=>{if(s===t||!n.user||!n.user.cursor)return;const o=Ce[s];if(o){const i=n.user.cursor,u=it.getBoundingClientRect(),a=u.left+i.left,c=u.top+i.top;o.style.left=`${a}px`,o.style.top=`${c}px`}})}function ua(e,t){if(!je[e]){const c=Object.keys(je).length%as.length;je[e]=as[c]}const n=je[e],s=t.cursor;if(!s||typeof s.left!="number"||typeof s.top!="number")return;if(!Ce[e]){const c=document.createElement("div");c.className="remote-cursor",c.style.backgroundColor=n;const p=document.createElement("div");p.className="cursor-label",p.style.backgroundColor=n,p.textContent=t.name||"Anonymous",c.appendChild(p),document.body.appendChild(c),Ce[e]=c}const o=Ce[e],i=it.getBoundingClientRect(),u=i.left+s.left,a=i.top+s.top;o.style.left=`${u}px`,o.style.top=`${a}px`,o.style.display="block"}function Mr(){Object.values(Ce).forEach(e=>{e&&e.parentNode&&e.parentNode.removeChild(e)}),Ce={}}async function ji(){var o;const e=it.innerText||it.textContent||"";if(!e.trim()){alert("No content to save!");return}const t=new Date,n=t.toISOString().slice(0,19).replace(/[T:]/g,"-"),s=`${roomName??"vibe_notes"}_${n}`;if("showSaveFilePicker"in window&&window.isSecureContext)try{const i=await window.showSaveFilePicker({suggestedName:s,excludeAcceptAllOption:!1,types:[{description:"All files",accept:{"*/*":[]}}]}),u=i.name,a=((o=u.split(".").pop())==null?void 0:o.toLowerCase())||"txt";let c=e;switch(a){case"html":case"htm":c=`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${u.replace(/\.[^/.]+$/,"")}</title>
</head>
<body>
    <pre>${e}</pre>
</body>
</html>`;break;case"json":c=JSON.stringify({title:u.replace(/\.[^/.]+$/,""),content:e,timestamp:t.toISOString(),sessionId:nn},null,2);break;default:c=e}const p=await i.createWritable();await p.write(c),await p.close(),console.log(` Notes saved as: ${u}`);return}catch(i){if(i.name==="AbortError"){console.log("User cancelled save dialog");return}console.error("Native save dialog failed:",i.message)}ha(e,s)}function ha(e,t){var p;const n=prompt("Enter filename with extension:",t);if(n===null||!n.trim())return;const s=((p=n.split(".").pop())==null?void 0:p.toLowerCase())||"txt";let o=e,i="text/plain;charset=utf-8";switch(s){case"md":case"markdown":i="text/markdown;charset=utf-8";break;case"html":case"htm":i="text/html;charset=utf-8",o=`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${n.replace(/\.[^/.]+$/,"")}</title>
</head>
<body>
    <pre>${e}</pre>
</body>
</html>`;break;case"json":i="application/json;charset=utf-8",o=JSON.stringify({title:n.replace(/\.[^/.]+$/,""),content:e,timestamp:new Date().toISOString(),sessionId:nn},null,2);break;default:i="text/plain;charset=utf-8"}const u=new Blob([o],{type:i}),a=URL.createObjectURL(u),c=document.createElement("a");c.href=a,c.download=n,c.style.display="none",document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(a),console.log(` Notes downloaded as: ${n}`)}let Gn=!1;async function Pi(){if(Gn){console.log(" Load already in progress, ignoring duplicate call");return}Gn=!0;try{if("showOpenFilePicker"in window&&window.isSecureContext){const[e]=await window.showOpenFilePicker({multiple:!1,excludeAcceptAllOption:!1,types:[{description:"Text files",accept:{"text/plain":[".txt",".md",".markdown"],"text/javascript":[".js",".mjs"],"text/typescript":[".ts"],"text/html":[".html",".htm"],"application/json":[".json"],"text/css":[".css"],"text/xml":[".xml"],"application/xml":[".xml"],"text/*":[".log",".conf",".ini",".cfg"]}}]}),t=await e.getFile(),n=await t.text();it&&gt&&gt.doc.transact(()=>{gt.delete(0,gt.length),gt.insert(0,n)}),console.log(` Loaded file: ${t.name} (${t.size} bytes)`)}else ps()}catch(e){e.name==="AbortError"?console.log("User cancelled file selection"):(console.error("Error loading file:",e),ps())}finally{Gn=!1}}function ps(){const e=document.createElement("input");e.type="file",e.accept=".txt,.md,.markdown,.js,.mjs,.ts,.html,.htm,.json,.css,.xml,.log,.conf,.ini,.cfg,text/*",e.style.display="none",e.addEventListener("change",async t=>{const n=t.target.files[0];if(n)try{const s=await n.text();it&&gt&&gt.doc.transact(()=>{gt.delete(0,gt.length),gt.insert(0,s)}),console.log(` Loaded file: ${n.name} (${n.size} bytes)`)}catch(s){console.error("Error reading file:",s),alert("Error reading file: "+s.message)}finally{document.body.removeChild(e)}}),document.body.appendChild(e),e.click()}Kc.addEventListener("click",ji);const da=document.getElementById("load-btn");da.addEventListener("click",Pi);let ms;window.addEventListener("resize",()=>{clearTimeout(ms),ms=setTimeout(()=>{aa()},100)});document.addEventListener("keydown",e=>{var t,n,s;(e.ctrlKey||e.metaKey)&&e.key==="o"&&(e.preventDefault(),Pi()),(e.ctrlKey||e.metaKey)&&e.key==="s"&&(e.preventDefault(),ji()),e.key==="F11"&&(e.preventDefault(),Ui()),e.ctrlKey&&e.shiftKey&&e.key==="D"&&(e.preventDefault(),console.log(" Manual diagnostics triggered..."),$?(console.log("Provider exists:",!!$),console.log("Provider room:",$.room),console.log("Signaling connections:",((t=$.signalingConns)==null?void 0:t.length)||0),console.log("WebRTC connections:",((s=(n=$.room)==null?void 0:n.webrtcConns)==null?void 0:s.size)||0),console.log("Awareness states:",$.awareness.getStates().size),console.log("Document synced:",$.synced)):console.log(" No provider found"))});
